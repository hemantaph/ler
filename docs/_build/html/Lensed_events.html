

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lensed event rates &mdash; ler 0.5.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/scalefix.css" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=776609e1" />
      <link rel="stylesheet" type="text/css" href="_static/dark_mode_css/general.css?v=c0a7eb24" />
      <link rel="stylesheet" type="text/css" href="_static/dark_mode_css/dark.css?v=70edf1c7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=8e576371"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "displayMath": [["$$", "$$"], ["\\[", "\\]"]], "processEnvironments": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore", "processHtmlClass": "tex2jax_process"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="_static/dark_mode_js/default_light.js?v=c2e647ce"></script>
      <script src="_static/dark_mode_js/theme_switcher.js?v=358d3910"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Lensed event sampling (Analytical formulation)" href="Lensed_equations.html" />
    <link rel="prev" title="Analytical Formulation for Gravitational Wave Event Rates" href="analytical_formulation_unlensed.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980b9" >

          
          
          <a href="index.html" class="icon icon-home">
            ler
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Summary.html">Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_overview.html">Code overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="GW_events.html">Gravitational wave event rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="analytical_formulation_unlensed.html">Analytical Formulation for Gravitational Wave Event Rates</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Lensed event rates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Annual-Rate-of-Detectable-Lensed-Gravitational-Wave-Events">Annual Rate of Detectable Lensed Gravitational Wave Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="#SNR-Operator-for-Lensed-Gravitational-Wave-Events">SNR Operator for Lensed Gravitational Wave Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Redshift-distribution-of-lensed-GW-compact-binary-coalescences-(CBC)">Redshift distribution of lensed GW compact binary coalescences (CBC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Sampling-Lens-Properties">Sampling Lens Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Sampling-of-Source-Position">Sampling of Source Position</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Calculation-of-Images-properties">Calculation of Images properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Statistical-Form-of-Detectable-Merger-Rate-of-lensed-events-(Monte-Carlo-Integration)">Statistical Form of Detectable Merger Rate of lensed events (Monte Carlo Integration)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Lensed_equations.html">Lensed event sampling (Analytical formulation)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="autoapi/ler/rates/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.rates</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="autoapi/ler/gw_source_population/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.gw_source_population</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="autoapi/ler/lens_galaxy_population/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.lens_galaxy_population</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="autoapi/ler/image_properties/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.image_properties</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="autoapi/ler/utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.utils</span></code></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/LeR_short_examples.html">LeR Short Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/GWRATES_complete_examples.html">GWRATES complete example</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/LeR_custom_functions.html">LeR with Custom Functions and Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/LeR_advanced_sampling.html">LeR Advanced Sampling — Generating Detectable Events</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980b9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ler</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Lensed event rates</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Lensed_events.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Lensed-event-rates">
<h1>Lensed event rates<a class="headerlink" href="#Lensed-event-rates" title="Link to this heading"></a></h1>
<p>This document outlines the default settings for calculating detectable lensed gravitational wave event rates (per year) in <a class="reference external" href="https://ler.hemantaph.comindex.html">LeR</a>.</p>
<p><strong>Notes:</strong></p>
<ul class="simple">
<li><p>For details on source properties and their distributions, please refer to the section titled “Gravitational Wave Event Rates.”</p></li>
<li><p>LeR’s calculation of lensed rates is loosely based on the methodology described in <a class="reference external" href="https://arxiv.org/pdf/2106.06303.pdf">WIERDA et al. 2021</a>.</p></li>
</ul>
<p><strong>Parameters in Consideration:</strong></p>
<ul class="simple">
<li><p>Source properties:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(z_s\)</span>: Source redshift.</p></li>
<li><p><span class="math notranslate nohighlight">\(\theta\)</span>: Gravitational wave source parameters. <span class="math notranslate nohighlight">\(\theta \in \{\)</span> <span class="math notranslate nohighlight">\(m_1\)</span> (mass of the heavier one), <span class="math notranslate nohighlight">\(m_2\)</span> (mass of the lighter one), <span class="math notranslate nohighlight">\(\mathcal{D}_L\)</span> (luminosity distance), <span class="math notranslate nohighlight">\(\iota\)</span> (inclination-angle), <span class="math notranslate nohighlight">\(\phi\)</span> (phase-of-coalescence), <span class="math notranslate nohighlight">\(\psi\)</span> (polarization-angle), <span class="math notranslate nohighlight">\(ra\)</span> (right-ascension), <span class="math notranslate nohighlight">\(dec\)</span> (declination) <span class="math notranslate nohighlight">\(\}\)</span>, <span class="math notranslate nohighlight">\(t\)</span> (time-of-coalescence).</p></li>
<li><p><span class="math notranslate nohighlight">\(R_o^U(z_s)\)</span>: Normalized merger-rate distribution (source-frame).</p></li>
</ul>
</li>
<li><p>Lensing related:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\text{SL}\)</span>: Strong lensing condition.</p></li>
<li><p><span class="math notranslate nohighlight">\(z_L\)</span>: Redshift of the galaxy lens.</p></li>
<li><p><span class="math notranslate nohighlight">\(R_o^L(z_s)\)</span>: Merger rate distribution with optical depth applied for lensed events.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{O}\)</span>: Detectability condition, determining whether an event is observable based on specific criteria.</p></li>
<li><p><span class="math notranslate nohighlight">\(\theta_L\)</span>: Parameters characterizing the lens galaxy. <span class="math notranslate nohighlight">\(\theta_L \in \{\)</span> <span class="math notranslate nohighlight">\(\sigma\)</span> (velocity-dispersion), <span class="math notranslate nohighlight">\(q\)</span> (axis-ratio), <span class="math notranslate nohighlight">\(\psi\)</span> (axis-rotation), <span class="math notranslate nohighlight">\(\gamma\)</span> (mass density spectral-index), <span class="math notranslate nohighlight">\([\gamma_1,\gamma_2]\)</span> (external-shear), <span class="math notranslate nohighlight">\([e_1,e_2]\)</span> (ellipticity), <span class="math notranslate nohighlight">\(\beta\)</span> (source position) <span class="math notranslate nohighlight">\(\}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\beta\)</span>: Position of the source in the source plane, relative to the lens.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mu_i\)</span>: Magnifications of the lensed images.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta t_i\)</span>: Time delays between the lensed images.</p></li>
</ul>
</li>
<li><p>Others:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\mathcal{N}^L\)</span>: Normalizing factor.</p></li>
<li><p><span class="math notranslate nohighlight">\(P\)</span>: Prior distribution.</p></li>
<li><p><span class="math notranslate nohighlight">\(\rho(z_s,\theta,\mu_i,\Delta t_i)\)</span>: Network optimal SNR of <span class="math notranslate nohighlight">\(i^{th}\)</span> lensed image.</p></li>
<li><p><span class="math notranslate nohighlight">\(\rho_{th}\)</span>: SNR threshold.</p></li>
</ul>
</li>
</ul>
<p>Default cosmology: LambdaCDM(H0=70, Om0=0.3, Ode0=0.7, Tcmb0=0.0, Neff=3.04, m_nu=None, Ob0=0.0). But, it can be changed by the user at LeR initialization.</p>
<section id="Annual-Rate-of-Detectable-Lensed-Gravitational-Wave-Events">
<h2>Annual Rate of Detectable Lensed Gravitational Wave Events<a class="headerlink" href="#Annual-Rate-of-Detectable-Lensed-Gravitational-Wave-Events" title="Link to this heading"></a></h2>
<p>The annual rate of detectable lensed gravitational wave events, denoted by <span class="math notranslate nohighlight">\(R_L\)</span>, quantifies the expected number of lensed events observable by gravitational wave detectors within a year. This rate is given by the following equation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
\begin{split}
\mathcal{R}_L &amp;= \mathcal{N}^L \int P(z_s| SL)\, \mathcal{O}_{\text{images}}(z_s,\theta,\mu_i,\Delta t_i, \rho_{th}) \\
&amp;\;\; P(\theta)\, P(\theta_L|z_l, z_s, SL)\, P(z_l|z_s, SL)\, P(\beta|z_s,z_l, \theta_L, SL) dz_s d\theta d\theta_L dz_l d\beta \\
\end{split} \tag{9}
\end{equation}\end{split}\]</div>
<p>Key aspects of this equation include:</p>
<ul class="simple">
<li><p><strong>SNR Operator,</strong> <span class="math notranslate nohighlight">\(\mathbf{\mathcal{O}_{\text{images}}(z_s,\theta,\mu_i,\Delta t_i, \rho{th})}\)</span><strong>:</strong> This function determines whether the lensed GW event is detectable based on their signal-to-noise ratios (SNRs) of the images. It is a logical operator that assesses the observability of each lensed image. Refer to the next sub-section for more details.</p></li>
<li><p><strong>Prior Distribution,</strong> <span class="math notranslate nohighlight">\(P(z_s| SL)\)</span>, <span class="math notranslate nohighlight">\(P(\theta)\)</span>, <span class="math notranslate nohighlight">\(P(\theta_L|z_l, z_s, SL)\)</span>, <span class="math notranslate nohighlight">\(P(z_l|z_s, SL)\)</span>, <span class="math notranslate nohighlight">\(P(\beta|z_s,z_l, \theta_L, SL)\)</span>:** These distributions represent the likelihood of the source redshift, source parameters, lens parameters, lens redshift, and source position, respectively. They are essential for characterizing the population of detectable lensed events.</p></li>
</ul>
<p>The calculation of <span class="math notranslate nohighlight">\(R_L\)</span> involves integration over the source redshift <span class="math notranslate nohighlight">\(z_s\)</span>, the GW source parameters <span class="math notranslate nohighlight">\(\theta\)</span>, the lens parameters <span class="math notranslate nohighlight">\(\theta_L\)</span> and lens redshift <span class="math notranslate nohighlight">\(z_l\)</span>, and the source position <span class="math notranslate nohighlight">\(\beta\)</span>. This integration accounts for the contributions from all detectable lensed events across different redshifts and parameter configurations, providing a comprehensive estimate of the annual rate of detectable lensed GW events.</p>
</section>
<section id="SNR-Operator-for-Lensed-Gravitational-Wave-Events">
<h2>SNR Operator for Lensed Gravitational Wave Events<a class="headerlink" href="#SNR-Operator-for-Lensed-Gravitational-Wave-Events" title="Link to this heading"></a></h2>
<p>The SNR operator, denoted as <span class="math notranslate nohighlight">\(\mathcal{O}\)</span>, is used to determine the detectability of lensed gravitational wave (GW) events based on their signal-to-noise ratios (SNRs). By default, the operator is configured to assess the detectability of events with two lensed images, although this can be adjusted to accommodate events with three or four images. A lensed GW event is considered detectable if at least two of its images have SNRs that exceed a predefined threshold (<span class="math notranslate nohighlight">\(\rho_{th}\)</span>),
referred to as two super-threshold events.</p>
<p>SNR operator over all images is defined as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathcal{O}_{images}(z_s,\theta,\mu_i,\Delta t_i, \rho_{th}) = \left\{
  \begin{array}{ c l }
    1 &amp; \sum_i^{images} \Theta[\rho(z_s,\theta,\mu_i,\Delta t_i)-\rho_{th}]\ge 2 \\
    0 &amp; \text{otherwise}
  \end{array}
\right.\end{split}\]</div>
<p><span class="math">\begin{equation}
\begin{split}
\end{split}\tag{4}
\end{equation}</span></p>
<p>In this definition: * <span class="math notranslate nohighlight">\(\Theta\)</span> represents the Heaviside step function, which evaluates to 1 if its argument is greater than or equal to zero, and 0 otherwise. * <span class="math notranslate nohighlight">\(\rho(z_s,\theta,\mu_i,\Delta t_i)\)</span> is the SNR of the <span class="math notranslate nohighlight">\(i_{\text{th}}\)</span> image. When a GW signal is lensed, it splits into multiple images, each with altered properties. The effective luminosity distance for the <span class="math notranslate nohighlight">\(i_{\text{th}}\)</span> image is given by <span class="math notranslate nohighlight">\(\mathcal{D}_{L,i}^{eff} = \mathcal{D}_L / \sqrt{|\mu_i|}\)</span>,
where <span class="math notranslate nohighlight">\(\mathcal{D}_L\)</span> is the original luminosity distance and <span class="math notranslate nohighlight">\(\mu_i\)</span> is the magnification of the image. Similarly, the effective geocentric time for the <span class="math notranslate nohighlight">\(i_{\text{th}}\)</span> image is <span class="math notranslate nohighlight">\(t_i^{eff} = t + \Delta t_i\)</span>, where <span class="math notranslate nohighlight">\(t\)</span> is the original time of arrival and <span class="math notranslate nohighlight">\(\Delta t_i\)</span> is the time delay of the image.</p>
<p>This SNR operator plays a crucial role in the analysis of lensed GW events, as it helps to identify events that are sufficiently strong to be detected by GW observatories.</p>
</section>
<section id="Redshift-distribution-of-lensed-GW-compact-binary-coalescences-(CBC)">
<h2>Redshift distribution of lensed GW compact binary coalescences (CBC)<a class="headerlink" href="#Redshift-distribution-of-lensed-GW-compact-binary-coalescences-(CBC)" title="Link to this heading"></a></h2>
<p>This is very similar to the un-lensed events redshift distribution <span class="math notranslate nohighlight">\(P(z_s)\)</span>, but with the optical depth applied for lensed events. Optical depth (<span class="math notranslate nohighlight">\(\tau(z-s)=P(\text{SL}|z_s)\)</span>) is the probability that a source at redshift <span class="math notranslate nohighlight">\(z_s\)</span> is strongly lensed by a galaxy. The lensed redshift distribution is given by:</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\begin{split}
P(z_s|SL) = \frac{R(z_s)}{\mathcal{N}^L} P(SL|z_s) \frac{1}{(1+z_s)} \frac{dV_c}{dz_s} \nonumber
\end{split}
\end{equation}\]</div>
<p>R(z_s) is the merger rate distribution of CBC in the source frame.</p>
<p>The normalizing factor is given by:</p>
<div class="math notranslate nohighlight">
\[\begin{equation}
\begin{split}
\mathcal{N}^L = \int_{z_{min}}^{z_{max}} R(z_s) P(SL|z_s) \frac{1}{(1+z_s)} \frac{dV_c}{dz_s} dz_s \nonumber
\end{split}
\end{equation}\]</div>
<p>Source redshifts for lensed case are sample from an astrophysical distribution, and rejection sample based on the optical depth. The plot below shows the comparision of the lensed and un-lensed merger rate distributions.</p>
<p align="center"><p><img alt="zs" class="no-scaled-link" src="_images/zs_vs.png" style="width: 80%;" /></p>
</p></section>
<section id="Sampling-Lens-Properties">
<h2>Sampling Lens Properties<a class="headerlink" href="#Sampling-Lens-Properties" title="Link to this heading"></a></h2>
<p>In <code class="docutils literal notranslate"><span class="pre">LeR</span></code>, we consider elliptical galaxy lenses with a power-law mass-density distribution and external shear, also refer to as <strong>EPL+Shear</strong> lens. The sampling methods for the lens parameters are summarized in the following tables. Note that <span class="math notranslate nohighlight">\(D_l^c\)</span> and <span class="math notranslate nohighlight">\(D_s^c\)</span> are the comoving distances to the lens and source, respectively.</p>
<p><strong>Table I: Lens Redshift and Physical Parameters</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>unit</p></th>
<th class="head"><p>sampling method</p></th>
<th class="head"><p>range</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(z_l\)</span>: Lens redshift</p></td>
<td><p>None</p></td>
<td><p>(i) <span class="math notranslate nohighlight">\(r\)</span> from <span class="math notranslate nohighlight">\(P(x)=30x^2(1-x)^2\)</span> (ii) Sacling: <span class="math notranslate nohighlight">\(D_l^c=r D_s^c\)</span> (iii) <span class="math notranslate nohighlight">\(D_l^c\rightarrow z_l\)</span>
with default cosmology</p></td>
<td><p>[0,<span class="math notranslate nohighlight">\(z_s\)</span>]</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\sigma\)</span>: velocity dispersion</p></td>
<td><p>km s^-1</p></td>
<td><p><span class="math notranslate nohighlight">\(\pi(\sigma_l, z_l)=\phi(\sigma_l, z_l)\frac{dV(z_l)}{dz_l}\)</span> refer to <a class="reference external" href="https://arxiv.org/pdf/2204.08732.pdf">Wempe et al.
2022</a></p></td>
<td><p>[0,600]</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(q\)</span>: axis-ratio</p></td>
<td><p>None</p></td>
<td><p>(i) <span class="math notranslate nohighlight">\(b\)</span> from Rayleigh distribution, <span class="math notranslate nohighlight">\(P(b)=\frac{b}{s^2} \exp(-\frac{b^2}{2s^2})\)</span> where
<span class="math notranslate nohighlight">\(s=0.38-0.09177a\)</span> and <span class="math notranslate nohighlight">\(a=\sigma/161\)</span> (ii) <span class="math notranslate nohighlight">\(q=1-b\)</span></p></td>
<td><p>[0.2,1]</p></td>
</tr>
</tbody>
</table>
<p>The cross-section (<span class="math notranslate nohighlight">\(\mathcal{S}\)</span>) of a SIE lens, along with the Einstein radius (<span class="math notranslate nohighlight">\(\theta_E\)</span>), is calculated using the following equations. <span class="math notranslate nohighlight">\(\mathcal{S}\)</span> determines the probability of a source being lensed by a galaxy, and <span class="math notranslate nohighlight">\(\theta_E\)</span> is defined as the angular radius of the ring-like image (known as the Einstein ring) formed when a distant light source, a lensing galaxy, and an observer are perfectly aligned. In the equation, <span class="math notranslate nohighlight">\(D_{Ls}\)</span> and <span class="math notranslate nohighlight">\(D_s\)</span> are the angular
diameter distances from the lens to the source and from the observer to the source, respectively, <span class="math notranslate nohighlight">\(c\)</span> is the speed of light. <span class="math notranslate nohighlight">\(\phi^{SIE}_{CUT}(q)\)</span> is derived from the expression given in <a class="reference external" href="https://iopscience.iop.org/article/10.3847/1538-4357/ac58f8">Fei Xu et al. 2022</a>.</p>
<p><span class="math">\begin{equation}
\begin{split}
\mathcal{S}(\theta_E) &= \pi \theta_E^2 \frac{\phi^{SIE}_{CUT}(q)}{\pi}  \\
\theta_E &= \frac{4\pi \sigma^2}{c^2}\frac{D_{Ls}}{D_s}
\end{split}\tag{5}
\end{equation}</span></p>
<p>Lens parameters in Table I are rejection sampled based on the strong lensing condition. A value is sampled from Uniform[0, max(<span class="math notranslate nohighlight">\(\mathcal{S}\)</span>)] and is selected if it is less than <span class="math notranslate nohighlight">\(\mathcal{S}\)</span>.</p>
<p><strong>Table II: Orientation, density and Shear Parameters</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>unit</p></th>
<th class="head"><p>sampling method</p></th>
<th class="head"><p>range</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\phi\)</span>: axis-rotation-angle</p></td>
<td><p>radian</p></td>
<td><p>Uniform</p></td>
<td><p>[0,2 <span class="math notranslate nohighlight">\(\pi\)</span>]</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\gamma\)</span>: mass density spectral-index</p></td>
<td><p>None</p></td>
<td><p>Normal dist.with mean=2, std=0.2</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\([\gamma_1,\gamma_2]\)</span>: external-shear</p></td>
<td><p>None</p></td>
<td><p>Normal dist.with mean=0, std=0.05</p></td>
<td><p>None</p></td>
</tr>
</tbody>
</table>
<p>The orientation angle (<span class="math notranslate nohighlight">\(\phi\)</span>) and axis ratio (<span class="math notranslate nohighlight">\(q\)</span>) are transformed into complex ellipticity moduli <span class="math notranslate nohighlight">\(e_1\)</span> and <span class="math notranslate nohighlight">\(e_2\)</span> as follows:</p>
<p><span class="math">\begin{equation}
\begin{split}
e_1 &= \frac{1-q}{1+q} \cos(2\phi) \\
e_2 &= \frac{1-q}{1+q} \sin(2\phi)
\end{split}\tag{6}
\end{equation}</span></p>
<p>Distribution of the lens parameters are shown in the following plots.</p>
<p align="center"><p><img alt="zs params" class="no-scaled-link" src="_images/lens_params.png" style="width: 100%;" /></p>
</p></section>
<section id="Sampling-of-Source-Position">
<h2>Sampling of Source Position<a class="headerlink" href="#Sampling-of-Source-Position" title="Link to this heading"></a></h2>
<p>The source position (<span class="math notranslate nohighlight">\(\beta\)</span>) is sampled uniformly from within and around the caustic region in the source plane. This region, which refer I will refer to as <code class="docutils literal notranslate"><span class="pre">caustic</span> <span class="pre">double</span></code>, is defined by the boundary within which a point source generates multiple images (two or more). The shape and size of this boundary depend on the lens parameters and the redshift of the source. The area in the source plane that results in the formation of multiple images is accurately determined using the
Lenstronomy software.</p>
<p>The animated figure below demonstrates how the source position and the resulting image positions vary within and around the caustic region, showcasing the process of multiple image formation by a elliptical lens. The megenta point indicates the varying position of the source within the source plane, and the orange points are the corresponding lensed image positions. The green line delineates the caustic boundary, the red line signify critical lines at the image plane, and blue shaded area is the
<code class="docutils literal notranslate"><span class="pre">caustic</span> <span class="pre">double</span></code> region. As the source drifts closer to a caustic line and beyond, the observed number of multiple images correspondingly decreases, illustrating the dynamic nature of gravitational lensing.</p>
<p align="center"><p><img alt="source position" class="no-scaled-link" src="_images/moving_source.gif" style="width: 80%;" /></p>
</p><p>Souce position in lens plane : <span class="math notranslate nohighlight">\(\beta = [x,y] = [\eta\,cos(\phi),\eta\,sin(\phi)]\)</span>. Sampling methods is given in the following table.</p>
<p><strong>Table III: Source Position Parameters</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>unit</p></th>
<th class="head"><p>sampling method</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(x\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\theta_E\)</span></p></td>
<td><p>within the double caustic</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(y\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\theta_E\)</span></p></td>
<td><p>within the double caustic</p></td>
</tr>
</tbody>
</table>
</section>
<section id="Calculation-of-Images-properties">
<h2>Calculation of Images properties<a class="headerlink" href="#Calculation-of-Images-properties" title="Link to this heading"></a></h2>
<p>The properties of the lensed images, such as the lens positions (<span class="math notranslate nohighlight">\(x_0, x_1\)</span>), magnifications (<span class="math notranslate nohighlight">\(\mu_i\)</span>), time delays (<span class="math notranslate nohighlight">\(\Delta t_i\)</span>) and morse phase (<span class="math notranslate nohighlight">\(n_i\)</span>), are calculated using the lens and source parameters. This is achieved through <code class="docutils literal notranslate"><span class="pre">lenstronomy</span></code>’s lens equation solver. As of 19/03/2024, only EPL+Shear solver is available. For, SIE model solutions set <span class="math notranslate nohighlight">\(\gamma=2\)</span>, <span class="math notranslate nohighlight">\(\phi=0\)</span>, <span class="math notranslate nohighlight">\([\gamma_1,\gamma_2]=[0,0]\)</span>, and <span class="math notranslate nohighlight">\([e_1,e_2]=[0,0]\)</span>. NFW profile will be
added in the future.</p>
<p><strong>Note:</strong> Source postion <span class="math notranslate nohighlight">\([x,y]\)</span> and image positions <span class="math notranslate nohighlight">\([x_0,x_1]\)</span> are wrt to the center of the lens galaxy (thin lens approximation). But in the sky map the source position will be defined by the sampled <span class="math notranslate nohighlight">\([ra,dec]\)</span>.</p>
<p>Below is the plot for the distribution of time delays difference between the lensed images. <span class="math notranslate nohighlight">\(\Delta n=0\deg\)</span> correspond to either [type-I, type-I] or [type-II, type-II] lensed images. <span class="math notranslate nohighlight">\(\Delta n=90\deg\)</span> correspond to [type-I, type-II] lensed images. Time delays difference between uncorrelated un-lensed events follows a poisson distribution.</p>
<p align="center"><p><img alt="zs" src="_images/timedelays.png" /></p>
</p></section>
<section id="Statistical-Form-of-Detectable-Merger-Rate-of-lensed-events-(Monte-Carlo-Integration)">
<h2>Statistical Form of Detectable Merger Rate of lensed events (Monte Carlo Integration)<a class="headerlink" href="#Statistical-Form-of-Detectable-Merger-Rate-of-lensed-events-(Monte-Carlo-Integration)" title="Link to this heading"></a></h2>
<p>The detectable merger rate of lensed events, <span class="math notranslate nohighlight">\(R_L\)</span>, can be statistically estimated using Monte Carlo integration. This can be done using either a step function or the probability of detection (<span class="math notranslate nohighlight">\(P_{\text{det}}\)</span>).</p>
<ul class="simple">
<li><p><strong>With Step Function:</strong></p></li>
</ul>
<p><span class="math">\begin{equation}
\begin{split}
R_L &= \mathcal{N}^U \left< \mathcal{O}_{images}(z_s,\theta,\mu_i,\Delta t_i, \rho_{th})\,\right>_{z_s,z_L,\theta,\theta_L \in \text{Sampled}[z_s,z_L,\theta,\theta_L]}  \\
&= \frac{\mathcal{N}^U}{N} \sum_i \mathcal{O}_{images}(z_s,\theta,\mu_i,\Delta t_i, \rho_{th})
\end{split} \tag{8}
\end{equation}</span></p>
<ul class="simple">
<li><p><strong>With :math:`P_{text{det}}`:</strong></p></li>
</ul>
<p><span class="math">\begin{equation}
\begin{split}
R_L &= \mathcal{N}^U \left< \,P_{det}^{max(\rho)_1} \,P_{det}^{max(\rho)_2} \,\right>_{z_s,z_L,\theta,\theta_L \in \text{Sampled}[z_s,z_L,\theta,\theta_L]} \\
&= \frac{\mathcal{N}^U}{N} \sum_i \,P_{det}^{max(\rho)_1} \,P_{det}^{max(\rho)_2}
\end{split} \tag{9}
\end{equation}</span></p>
<p>In both cases, the average is taken over a sample of <span class="math notranslate nohighlight">\((z_s, z_L, \theta, \theta_L)\)</span>, where <span class="math notranslate nohighlight">\(N\)</span> is the total number of samples. The SNR operator <span class="math notranslate nohighlight">\(\mathcal{O}_{images}(z_s,\theta,\mu_i,\Delta t_i, \rho_{th})\)</span> evaluates to 1 if two of the images of the lensed GW event are detectable, and 0 otherwise. The probability of detection, <span class="math notranslate nohighlight">\(P_{\text{det}}\)</span>, provides a smoother transition from detectable to non-detectable events at the SNR threshold.</p>
<p>The table below presents the merger rate values for two different detector configurations, considering spin-less systems for simplicity. The signal-to-noise ratio (SNR) operator is implemented using a step function with a threshold of 8, and the waveform approximant used is IMRPhenomD.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Detector Configuration</p></th>
<th class="head"><p>BBH (un-lensed) Merger Rate (yr-1)</p></th>
<th class="head"><p>BBH (lensed) Merger Rate (yr-1)</p></th>
<th class="head"><p>Ratio</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>[L1, H1, V1] (O4)</p></td>
<td><p>440.9</p></td>
<td><p>1.1</p></td>
<td><p>~400:1</p></td>
</tr>
<tr class="row-odd"><td><p>[A+, CE, ET] (3G)</p></td>
<td><p>91843.6</p></td>
<td><p>152.4</p></td>
<td><p>~600:1</p></td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="analytical_formulation_unlensed.html" class="btn btn-neutral float-left" title="Analytical Formulation for Gravitational Wave Event Rates" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Lensed_equations.html" class="btn btn-neutral float-right" title="Lensed event sampling (Analytical formulation)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Phurailatpam Hemantakumar.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>