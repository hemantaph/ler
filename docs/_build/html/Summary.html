

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Summary &mdash; ler 0.3.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=776609e1" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=4621528c"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Code overview" href="code_overview.html" />
    <link rel="prev" title="Installation" href="Installation2.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            ler
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Installation2.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Summary</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Sampling-Gravitational-Wave-Source-Properties:">Sampling Gravitational Wave Source Properties:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Lensing-Related:">Lensing Related:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Calculation-of-Detectable-Merger-Rates-Per-Year:">Calculation of Detectable Merger Rates Per Year:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Distribution-binary-black-hole-(BBH)-in-terms-of-redshift.">Distribution binary black hole (BBH) in terms of redshift.</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="code_overview.html">Code overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="GW_events.html">Gravitational wave event rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="GW_equations.html">Gravitational wave events sampling (Analytical formulation)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lensed_events.html">Lensed event rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="Lensed_equations.html">Lensed event sampling (Analytical formulation)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="autoapi/ler/rates/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.rates</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="autoapi/ler/gw_source_population/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.gw_source_population</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="autoapi/ler/lens_galaxy_population/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.lens_galaxy_population</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="autoapi/ler/image_properties/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.image_properties</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="autoapi/ler/utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.utils</span></code></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/rates/LeR%20complete%20examples.html">LeR complete examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/rates/GWRATES%20complete%20exmaples.html">GWRATES complete exmaples</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/rates/grb%20detection%20rate.html">Calculation of detectable Gamma ray burst (GRB) event rate associated with Binary Neutron Star (BNS) mergers.</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/rates/ler%20bns%20example.html">LeR complete examples of BNS events (O4 design sensitivity)</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/rates/rates_with_3G_detectors.html">Event Rates with 3G detectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/source%20population/merger%20rate%20density%20evolution%20with%20redshift.html">Merger rate density evolution with redshift</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/source%20population/merger%20rate%20density%20model%20comparision.html">Merger rate density model comparision</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/source%20population/merger%20rate%20density%20model%20comparision.html#Primordial-BBH-model,-Ng-et-al.-2022">Primordial BBH model, Ng et al. 2022</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/source%20population/sample%20compact%20binary%20parameters.html">Sampling parameters for a compact binary</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/source%20population/statistical%20study%20of%20changing%20mass%20model%20params.html">Statistical study of changing Mass model paramter(s)</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/source%20population/statistical%20study%20of%20cosmological%20friction.html">Statistical study of cosmological friction and its effect on the redshift vs inferred chirp-mass relation of gravitational waves</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/lens_parameters/sample%20lens%20parameters.html">Lens parameter distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/optical_depth/validation_SIE.html">Optical depth SIE model validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/optical_depth/validation_SIS.html">Validation of SIS model (Numerical vs Analytical)</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/image_properties/dt_vs_dmu.html">Study of Time delays and magnification of lensed gravitational waves.</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ler</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Summary</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Summary.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Summary">
<h1>Summary<a class="headerlink" href="#Summary" title="Link to this heading">ÔÉÅ</a></h1>
<p align="center"><p><img alt="Your Logo" class="no-scaled-link" src="_images/sl.png" style="width: 100%;" /></p>
</p><p>LeR is a Python package designed for the statistical simulation and forecasting of gravitational wave (GW) events and their rates. It is tailored to support both GW population study groups and GW lensing research groups by providing a comprehensive suite of tools for GW event analysis. The package is organized into the following main components:</p>
<section id="Sampling-Gravitational-Wave-Source-Properties:">
<h2>Sampling Gravitational Wave Source Properties:<a class="headerlink" href="#Sampling-Gravitational-Wave-Source-Properties:" title="Link to this heading">ÔÉÅ</a></h2>
<ul class="simple">
<li><p>The source‚Äôs redshift (<span class="math notranslate nohighlight">\(z_s\)</span>) sampling distribution, <span class="math notranslate nohighlight">\(R_m^U(z_s)\)</span>, is derived from the merger rate density of compact binaries, which is based on the star formation rate. The code is designed for easy integration of future updates or user-specified distributions.</p></li>
<li><p>The sampling of both intrinsic and extrinsic parameters of GW sources, represented by <span class="math notranslate nohighlight">\(\theta_i\)</span>, utilizes the prior distributions ( <span class="math notranslate nohighlight">\(P\left(\theta_i \right)\)</span> ) available within the <code class="docutils literal notranslate"><span class="pre">gwcosmo</span></code> and <code class="docutils literal notranslate"><span class="pre">bilby</span></code> Python packages. Users can manually alter any relevant parameters as needed.</p></li>
</ul>
</section>
<section id="Lensing-Related:">
<h2>Lensing Related:<a class="headerlink" href="#Lensing-Related:" title="Link to this heading">ÔÉÅ</a></h2>
<ul class="simple">
<li><p><strong>Sampling of Lens Galaxies Attributes and Source Redshifts:</strong></p>
<ul>
<li><p>For lensed cases, the source redshift (<span class="math notranslate nohighlight">\(z_s\)</span>) is sampled under the strong lensing condition (SL) based on the precomputed probability of strong lensing with source at <span class="math notranslate nohighlight">\(z_s\)</span> ( optical depth: <span class="math notranslate nohighlight">\(P\left(\text{SL}|z_s\right)\)</span> ). This probability can be recalculated for specified configurations of lens galaxies, leveraging multiprocessing and njit functionalities for efficiency.</p></li>
<li><p>The package uses the Elliptical Power Law with external shear (EPL+Shear) model for galaxy parameter (<span class="math notranslate nohighlight">\(\theta_L\)</span>) sampling, following <a class="reference external" href="https://arxiv.org/abs/2106.06303">Wierda et. al 2021</a>. Rejection sampling is applied to these samples based on whether the event is strongly lensed or not, <span class="math notranslate nohighlight">\(P\left(\text{SL}|z_s,\theta_L\right)\)</span>.</p></li>
</ul>
</li>
<li><p><strong>Generation of Image Properties:</strong></p>
<ul>
<li><p>Source position (<span class="math notranslate nohighlight">\(\beta\)</span>) is sampled from the caustic in the source plane.</p></li>
<li><p>Sampled lens properties and source position are fed into <code class="docutils literal notranslate"><span class="pre">Lenstronomy</span></code> to generate image properties. This is the slowest part of the simulation, which LeR tackles through parallelization with multiprocessing.</p></li>
<li><p>Image properties like magnification (<span class="math notranslate nohighlight">\(\mu_i\)</span>) and time delay (<span class="math notranslate nohighlight">\(\Delta t_i\)</span>) modify the original source signal strength, affecting the signal-to-noise ratio (SNR) and our ability to detect.</p></li>
</ul>
</li>
</ul>
</section>
<section id="Calculation-of-Detectable-Merger-Rates-Per-Year:">
<h2>Calculation of Detectable Merger Rates Per Year:<a class="headerlink" href="#Calculation-of-Detectable-Merger-Rates-Per-Year:" title="Link to this heading">ÔÉÅ</a></h2>
<ul class="simple">
<li><p>The calculation of rates involves integration over simulated events that meet specific detection criteria, including computing SNRs (<span class="math notranslate nohighlight">\(\rho\)</span>) for each event or its lensed images and assessing them against a predetermined threshold (<span class="math notranslate nohighlight">\(\rho_{th}\)</span>).</p></li>
<li><p>SNR calculations are optimized using <a class="reference external" href="https://github.com/hemantaph/gwsnr">gwsnr</a>, leveraging interpolation, artificial neural networks, and multiprocessing for accuracy and speed.</p></li>
<li><p>Simulated events and rate results, along with input configurations, are systematically archived for easy access and future analysis. All interpolators used in the process are preserved for future applications.</p></li>
</ul>
<p>LeR is developed to meet the needs of both the LIGO-Virgo-KAGRA Scientific Collaboration and researchers in astrophysics. It is currently used in generating detectable lensing events and GW lensing rates for current and future detectors, contributing to the ongoing effort to detect lensed GWs, (<a class="reference external" href="https://arxiv.org/abs/2306.03827">arXiv:2306.03827</a>). The package is designed with upgradability in mind to include additional statistics as required by related research.</p>
<p>Key features of LeR include efficient sampling, optimized SNR calculations, and systematic archiving of results. It leverages array operations and linear algebra from the <code class="docutils literal notranslate"><span class="pre">numpy</span></code> library, interpolation methods from <code class="docutils literal notranslate"><span class="pre">scipy</span></code>, and parallel processing capabilities from Python‚Äôs <code class="docutils literal notranslate"><span class="pre">multiprocessing</span></code> module, with performance further optimized using the <code class="docutils literal notranslate"><span class="pre">numba</span></code> library‚Äôs Just-In-Time compilation.</p>
<p>For more information and usage examples, please refer to the other sections of the documentation.</p>
<p><strong>Detectable Gravitational Wave Event Rates:</strong></p>
<p><span class="math">\begin{equation*}
R_U = \int dz_s R_m^U(z_s)\left\{\Theta[\rho(z_s,\theta)-\rho_{th}] P(\theta) d\theta \right\}
\end{equation*}</span></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(z_s\)</span>: GW source redshift, <span class="math notranslate nohighlight">\(R_m^U(z_s)\)</span>: source frame merger rate density in the co-moving volume at <span class="math notranslate nohighlight">\(z_s\)</span>, <span class="math notranslate nohighlight">\(\theta\)</span>: GW source parameters, <span class="math notranslate nohighlight">\(P\)</span>: probability distribution, <span class="math notranslate nohighlight">\(\rho\)</span>: SNR, <span class="math notranslate nohighlight">\(\rho_{th}\)</span>: SNR threshold, <span class="math notranslate nohighlight">\(\Theta\)</span>: Heaviside function to select detectable events.</p></li>
</ul>
<p><strong>Detectable Lensed Gravitational Wave Event Rates:</strong></p>
<p><span class="math">\begin{equation*}
\begin{split}
R_L = \int & dz_s R_m^L(z_s) \,\mathcal{O}_{images}(z_s,\theta,\mu_i,\Delta t_i, \rho_{th}) \, \\
& \, P(\theta) P(\theta_L|\text{SL},z_s) P(\beta|\text{SL}) d\theta d\beta d\theta_L dz_s
\end{split}
\end{equation*}</span></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R_m^L(z_s)\)</span>: strongly lensed source frame merger rate density in the co-moving volume at <span class="math notranslate nohighlight">\(z_s\)</span>, <span class="math notranslate nohighlight">\(\theta_L\)</span>: lens parameters, <span class="math notranslate nohighlight">\(\beta\)</span>: image properties, <span class="math notranslate nohighlight">\(\mu\)</span>: image magnification, <span class="math notranslate nohighlight">\(\Delta t\)</span>: image time delay, <span class="math notranslate nohighlight">\(\mathcal{O}\)</span>: logical OR operator applied across all <span class="math notranslate nohighlight">\(\Theta_i\)</span> of the images, <span class="math notranslate nohighlight">\(\text{SL}\)</span>: strong lensing condition.</p></li>
</ul>
</section>
<section id="Distribution-binary-black-hole-(BBH)-in-terms-of-redshift.">
<h2>Distribution binary black hole (BBH) in terms of redshift.<a class="headerlink" href="#Distribution-binary-black-hole-(BBH)-in-terms-of-redshift." title="Link to this heading">ÔÉÅ</a></h2>
<ul class="simple">
<li><p>The following plot generated using <code class="docutils literal notranslate"><span class="pre">LeR</span></code>. This considers O4 design sensitivity of the GW detectors.</p></li>
</ul>
<p align="center"><p><img alt="Your Logo" class="no-scaled-link" src="_images/zs_all.png" style="width: 80%;" /></p>
</p></section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Installation2.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="code_overview.html" class="btn btn-neutral float-right" title="Code overview" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Phurailatpam Hemantakumar.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>