<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ler.gw_source_population.cbc_source_parameter_distribution &mdash; ler 0.3.1 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/tabs.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=4621528c"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../../_static/copybutton.js?v=f281be69"></script>
        <script src="../../../_static/tabs.js?v=3030b3cb"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            ler
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Unlensed%20events.html">Unlensed events</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Lensed%20events.html">Lensed events</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/ler/rates/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.rates</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/ler/gw_source_population/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.gw_source_population</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/ler/lens_galaxy_population/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.lens_galaxy_population</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/ler/image_properties/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.image_properties</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/ler/utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.utils</span></code></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../rates/LeR%20complete%20examples.html">LeR complete examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rates/GWRATES%20complete%20exmaples.html">GWRATES complete exmaples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ler</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">ler.gw_source_population.cbc_source_parameter_distribution</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for ler.gw_source_population.cbc_source_parameter_distribution</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module contains the classes to generate source compact binary&#39;s intrinsic and extrinsic gravitational waves parameters.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">njit</span>

<span class="c1"># for redshift to luminosity distance conversion</span>
<span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="kn">import</span> <span class="n">LambdaCDM</span>

<span class="c1"># from gwcosmo import priors as p</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>

<span class="c1"># for generating mass distribution</span>
<span class="kn">from</span> <span class="nn">gwcosmo</span> <span class="kn">import</span> <span class="n">priors</span> <span class="k">as</span> <span class="n">p</span>

<span class="c1"># for multiprocessing</span>
<span class="c1"># Import helper routines</span>
<span class="kn">from</span> <span class="nn">..utils</span> <span class="kn">import</span> <span class="n">interpolator_from_pickle</span><span class="p">,</span> <span class="n">cubic_spline_interpolator</span>

<span class="c1"># import redshift distribution sampler</span>
<span class="kn">from</span> <span class="nn">.cbc_source_redshift_distribution</span> <span class="kn">import</span> <span class="n">CBCSourceRedshiftDistribution</span>

<span class="kn">from</span> <span class="nn">.jit_functions</span> <span class="kn">import</span> <span class="n">lognormal_distribution_2D</span><span class="p">,</span> <span class="n">inverse_transform_sampler_m1m2</span>


<div class="viewcode-block" id="CBCSourceParameterDistribution">
<a class="viewcode-back" href="../../../autoapi/ler/rates/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution">[docs]</a>
<span class="k">class</span> <span class="nc">CBCSourceParameterDistribution</span><span class="p">(</span><span class="n">CBCSourceRedshiftDistribution</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class to generate a population of compact binaries. It helps sample all the intrinsic and extrinsic parameters of compact binaries. This daughter class inherits from :class:`~ler.ler.CBCSourceRedshiftDistribution` class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    z_min : `float`</span>
<span class="sd">        Minimum redshift of the source population</span>
<span class="sd">        default: 0.001</span>
<span class="sd">    z_max : `float`</span>
<span class="sd">        Maximum redshift of the source population</span>
<span class="sd">        default: 10.</span>
<span class="sd">    event_type : `str`</span>
<span class="sd">        Type of event to generate.</span>
<span class="sd">        e.g. &#39;BBH&#39;, &#39;BNS&#39;, &#39;NSBH&#39;</span>
<span class="sd">    source_priors, source_priors_params : `dict`, `dict`</span>
<span class="sd">        Dictionary of prior sampler functions and its input parameters.</span>
<span class="sd">        Check for available priors and corresponding input parameters by running,</span>
<span class="sd">        &gt;&gt;&gt; from ler.gw_source_population import CompactBinaryPopulation</span>
<span class="sd">        &gt;&gt;&gt; cbc = CompactBinaryPopulation()</span>
<span class="sd">        &gt;&gt;&gt; cbc.available_gw_prior_list_and_its_params()</span>
<span class="sd">        # To check the current chosen priors and its parameters, run,</span>
<span class="sd">        &gt;&gt;&gt; print(&quot;default priors=&quot;,cbc.gw_param_samplers)</span>
<span class="sd">        &gt;&gt;&gt; print(&quot;default priors&#39;s parameters=&quot;,cbc.gw_param_samplers_params)</span>
<span class="sd">    cosmology : `astropy.cosmology`</span>
<span class="sd">        Cosmology to use</span>
<span class="sd">        default: None/astropy.cosmology.FlatLambdaCDM(H0=70, Om0=0.3)</span>
<span class="sd">    spin_zero : `bool`</span>
<span class="sd">        If True, spin parameters are completely ignore in the sampling.</span>
<span class="sd">        default: True</span>
<span class="sd">    spin_precession : `bool`</span>
<span class="sd">        If spin_zero=True and spin_precession=True, spin parameters are sampled for precessing binaries.</span>
<span class="sd">        if spin_zero=True and spin_precession=False, spin parameters are sampled for aligned/anti-aligned spin binaries.</span>
<span class="sd">        default: False</span>
<span class="sd">    directory : `str`</span>
<span class="sd">        Directory to store the interpolator pickle files</span>
<span class="sd">        default: &#39;./interpolator_pickle&#39;</span>
<span class="sd">    create_new_interpolator : `dict`</span>
<span class="sd">        Dictionary of boolean values and resolution to create new interpolator.</span>
<span class="sd">        default: dict(redshift_distribution=dict(create_new=False, resolution=500), z_to_luminosity_distance=dict(create_new=False, resolution=500), differential_comoving_volume=dict(create_new=False, resolution=500))</span>

<span class="sd">    Examples</span>
<span class="sd">    ----------</span>
<span class="sd">    &gt;&gt;&gt; from ler.gw_source_population import CBCSourceParameterDistribution</span>
<span class="sd">    &gt;&gt;&gt; cbc = CBCSourceParameterDistribution()</span>
<span class="sd">    &gt;&gt;&gt; params = cbc.sample_gw_parameters(size=1000)</span>
<span class="sd">    &gt;&gt;&gt; print(&quot;sampled parameters=&quot;,list(params.keys()))</span>

<span class="sd">    Instance Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    CompactBinaryPopulation has the following instance attributes:\n</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    | Atrributes                          | Type                             |</span>
<span class="sd">    +=====================================+==================================+</span>
<span class="sd">    |:attr:`~z_min`                       | `float`                          |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:attr:`~z_max`                       | `float`                          |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:attr:`~event_type`                  | `str`                            |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:attr:`~source_priors`               | `dict`                           |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:attr:`~source_priors_params`        | `dict`                           |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:attr:`~cosmo`                       | `astropy.cosmology`              |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:attr:`~spin_zero`                   | `bool`                           |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:attr:`~spin_precession`             | `bool`                           |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:attr:`~directory`                   | `str`                            |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:attr:`~create_new_interpolator`     | `dict`                           |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:attr:`~available_gw_prior_list_and_its_params`                            |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |                                     | `dict`                           |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:attr:`~gw_param_samplers`           | `dict`                           |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:attr:`~gw_param_samplers_params`    | `dict`                           |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:attr:`~sampler_names`               | `dict`                           |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>

<span class="sd">    Instance Methods</span>
<span class="sd">    ----------</span>
<span class="sd">    CompactBinaryPopulation has the following instance methods:\n</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    | Methods                             | Type                             |</span>
<span class="sd">    +=====================================+==================================+</span>
<span class="sd">    |:meth:`~source_priors_categorization`                                   |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |                                     | Function to categorize the event |</span>
<span class="sd">    |                                     | priors and its parameters        |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:meth:`~lookup_table_luminosity_distance`                               |</span>
<span class="sd">    |                                     | Function to create a lookup      |</span>
<span class="sd">    |                                     | table for converting redshift    |</span>
<span class="sd">    |                                     | to luminosity distance           |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:meth:`~sample_gw_parameters`        | Function to sample all the       |</span>
<span class="sd">    |                                     | intrinsic and extrinsic          |</span>
<span class="sd">    |                                     | parameters of compact binaries   |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:meth:`~sample_source_frame_masses`  | Function to sample source mass1  |</span>
<span class="sd">    |                                     | and mass2                        |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:meth:`~sample_geocent_time`         | Function to sample geocent time  |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:meth:`~sample_zs`                   | Function to sample source        |</span>
<span class="sd">    |                                     | redshift                         |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:meth:`~sample_ra`                   | Function to sample right         |</span>
<span class="sd">    |                                     | ascension (sky position)         |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:meth:`~sample_dec`                  | Function to sample declination   |</span>
<span class="sd">    |                                     | (sky position)                   |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:meth:`~sample_phase`                | Function to sample coalescence   |</span>
<span class="sd">    |                                     | phase                            |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:meth:`~sample_psi`                  | Function to sample polarization  |</span>
<span class="sd">    |                                     | angle                            |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:meth:`~sample_theta_jn`             | Function to sample inclination   |</span>
<span class="sd">    |                                     | angle                            |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:meth:`~sample_a1`                   | Function to sample spin1         |</span>
<span class="sd">    |                                     | magnitude                        |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:meth:`~sample_a2`                   | Function to sample spin2         |</span>
<span class="sd">    |                                     | magnitude                        |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:meth:`~sample_tilt_1`               | Function to sample tilt1 angle   |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:meth:`~sample_tilt_2`               | Function to sample tilt2 angle   |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:meth:`~sample_phi_12`               | Function to sample phi12 angle   |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:meth:`~sample_phi_jl`               | Function to sample phi_jl angle  |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:meth:`~binary_masses_BBH_popI_II_powerlaw_gaussian`                    |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |                                     | Function to sample source mass1  |</span>
<span class="sd">    |                                     | and mass2 with PowerLaw+PEAK     |</span>
<span class="sd">    |                                     | model                            |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:meth:`~binary_masses_BBH_popIII_lognormal`                             |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |                                     | Function to sample source mass1  |</span>
<span class="sd">    |                                     | and mass2 with popIII orgin from |</span>
<span class="sd">    |                                     | lognormal distribution. Refer to |</span>
<span class="sd">    |                                     | Ng et al. 2022. Eqn. 1 and 4     |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:meth:`~binary_masses_BBH_primordial_lognormal`                         |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |                                     | Function to sample source mass1  |</span>
<span class="sd">    |                                     | and mass2 with primordial orgin  |</span>
<span class="sd">    |                                     | from lognormal distribution.     |</span>
<span class="sd">    |                                     | Refer to Ng et al. 2022. Eqn. 1  |</span>
<span class="sd">    |                                     | and 4                            |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:meth:`~binary_masses_BNS_gwcosmo`                                      |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |                                     | Function to sample source mass1  |</span>
<span class="sd">    |                                     | and mass2 from powerlaw          |</span>
<span class="sd">    |                                     | distribution.                    |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:meth:`~binary_masses_BNS_bimodal`   | Function to sample source mass1  |</span>
<span class="sd">    |                                     | and mass2 from bimodal           |</span>
<span class="sd">    |                                     | distribution. Refer to           |</span>
<span class="sd">    |                                     | Will M. Farr et al. 2020 Eqn. 6  |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:meth:`~constant_values_n_size`      | Function to return array of      |</span>
<span class="sd">    |                                     | constant values of size n        |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    |:meth:`~sampler_uniform`             | Function to sample from uniform  |</span>
<span class="sd">    |                                     | distribution                     |</span>
<span class="sd">    +-------------------------------------+----------------------------------+</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Attributes</span>
<div class="viewcode-block" id="CBCSourceParameterDistribution.z_min">
<a class="viewcode-back" href="../../../autoapi/ler/gw_source_population/cbc_source_parameter_distribution/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.z_min">[docs]</a>
    <span class="n">z_min</span> <span class="o">=</span> <span class="kc">None</span></div>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;``float`` \n</span>
<span class="sd">    Minimum redshift of the source population</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="CBCSourceParameterDistribution.z_max">
<a class="viewcode-back" href="../../../autoapi/ler/gw_source_population/cbc_source_parameter_distribution/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.z_max">[docs]</a>
    <span class="n">z_max</span> <span class="o">=</span> <span class="kc">None</span></div>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;``float`` \n</span>
<span class="sd">    Maximum redshift of the source population</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="CBCSourceParameterDistribution.event_type">
<a class="viewcode-back" href="../../../autoapi/ler/gw_source_population/cbc_source_parameter_distribution/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.event_type">[docs]</a>
    <span class="n">event_type</span> <span class="o">=</span> <span class="kc">None</span></div>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;``str`` \n</span>
<span class="sd">    Type of event to generate. \n</span>
<span class="sd">    e.g. &#39;BBH&#39;, &#39;BNS&#39;, &#39;NSBH&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="CBCSourceParameterDistribution.source_priors">
<a class="viewcode-back" href="../../../autoapi/ler/gw_source_population/cbc_source_parameter_distribution/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.source_priors">[docs]</a>
    <span class="n">source_priors</span> <span class="o">=</span> <span class="kc">None</span></div>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;``dict`` \n</span>
<span class="sd">    Dictionary of prior sampler functions.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="CBCSourceParameterDistribution.source_priors_params">
<a class="viewcode-back" href="../../../autoapi/ler/gw_source_population/cbc_source_parameter_distribution/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.source_priors_params">[docs]</a>
    <span class="n">source_priors_params</span> <span class="o">=</span> <span class="kc">None</span></div>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;``dict`` \n</span>
<span class="sd">    Dictionary of prior sampler functions&#39; input parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="CBCSourceParameterDistribution.cosmo">
<a class="viewcode-back" href="../../../autoapi/ler/gw_source_population/cbc_source_parameter_distribution/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.cosmo">[docs]</a>
    <span class="n">cosmo</span> <span class="o">=</span> <span class="n">LambdaCDM</span><span class="p">(</span><span class="n">H0</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">Om0</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">Ode0</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span></div>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;``astropy.cosmology`` \n</span>
<span class="sd">    Cosmology to use.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="CBCSourceParameterDistribution.spin_zero">
<a class="viewcode-back" href="../../../autoapi/ler/gw_source_population/cbc_source_parameter_distribution/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.spin_zero">[docs]</a>
    <span class="n">spin_zero</span> <span class="o">=</span> <span class="kc">None</span></div>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;``bool`` \n</span>
<span class="sd">    If True, spin prior is set to zero.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">z_min</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">z_max</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
        <span class="n">event_type</span><span class="o">=</span><span class="s2">&quot;BBH&quot;</span><span class="p">,</span>
        <span class="n">source_priors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">source_priors_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">cosmology</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">spin_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">spin_precession</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">directory</span><span class="o">=</span><span class="s2">&quot;./interpolator_pickle&quot;</span><span class="p">,</span>
        <span class="n">create_new_interpolator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1"># set attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z_min</span> <span class="o">=</span> <span class="n">z_min</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z_max</span> <span class="o">=</span> <span class="n">z_max</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cosmo</span> <span class="o">=</span> <span class="n">cosmology</span> <span class="k">if</span> <span class="n">cosmology</span> <span class="k">else</span> <span class="n">LambdaCDM</span><span class="p">(</span><span class="n">H0</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">Om0</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">Ode0</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
        <span class="c1"># note that self.cosmo is initialized in the super class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spin_zero</span> <span class="o">=</span> <span class="n">spin_zero</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spin_precession</span> <span class="o">=</span> <span class="n">spin_precession</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">=</span> <span class="n">directory</span>
        <span class="c1"># initialize the interpolator&#39;s parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_new_interpolator</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">redshift_distribution</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">create_new</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span>
            <span class="n">z_to_luminosity_distance</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">create_new</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span>
            <span class="n">differential_comoving_volume</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">create_new</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">create_new_interpolator</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_new_interpolator</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">create_new_interpolator</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">create_new_interpolator</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_new_interpolator</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">redshift_distribution</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">create_new</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span>
                <span class="n">z_to_luminosity_distance</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">create_new</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span>
                <span class="n">differential_comoving_volume</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">create_new</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="c1"># dealing with prior functions and categorization</span>
        <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers_params</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sampler_names</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_priors_categorization</span><span class="p">(</span>
            <span class="n">event_type</span><span class="p">,</span> <span class="n">source_priors</span><span class="p">,</span> <span class="n">source_priors_params</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers</span><span class="p">[</span><span class="s2">&quot;zs&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;sample_source_redshift&quot;</span><span class="p">:</span>
            <span class="c1"># initialize the SourceGalaxyPopulationModel mother class</span>
            <span class="c1"># for redshift distribution</span>
            <span class="c1"># instance attribute sample_source_redshift is initialized here</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
                <span class="n">z_min</span><span class="o">=</span><span class="n">z_min</span><span class="p">,</span>
                <span class="n">z_max</span><span class="o">=</span><span class="n">z_max</span><span class="p">,</span>
                <span class="n">event_type</span><span class="o">=</span><span class="n">event_type</span><span class="p">,</span>
                <span class="n">merger_rate_density</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers</span><span class="p">[</span><span class="s2">&quot;merger_rate_density&quot;</span><span class="p">],</span>
                <span class="n">merger_rate_density_param</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers_params</span><span class="p">[</span>
                    <span class="s2">&quot;merger_rate_density&quot;</span>
                <span class="p">],</span>
                <span class="n">cosmology</span><span class="o">=</span><span class="n">cosmology</span><span class="p">,</span>
                <span class="n">directory</span><span class="o">=</span><span class="n">directory</span><span class="p">,</span>
                <span class="n">create_new_interpolator</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">create_new_interpolator</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if you already have the redshift distribution function, you can pass it in.</span>
            <span class="c1"># super class will not be initialized anymore,</span>
            <span class="c1"># get z_to_luminosity_distance</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lookup_table_luminosity_distance</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="n">directory</span><span class="p">)</span>

        <span class="c1"># initializing samplers</span>
        <span class="c1"># it goes through the setter functions and assign the sampler functions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_source_frame_masses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers</span><span class="p">[</span><span class="s2">&quot;source_frame_masses&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_geocent_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers</span><span class="p">[</span><span class="s2">&quot;geocent_time&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_zs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers</span><span class="p">[</span><span class="s2">&quot;zs&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_ra</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers</span><span class="p">[</span><span class="s2">&quot;ra&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_dec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers</span><span class="p">[</span><span class="s2">&quot;dec&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_phase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers</span><span class="p">[</span><span class="s2">&quot;phase&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_psi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers</span><span class="p">[</span><span class="s2">&quot;psi&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_theta_jn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers</span><span class="p">[</span><span class="s2">&quot;theta_jn&quot;</span><span class="p">]</span>
        <span class="c1"># initialize the spin prior attribute</span>
        <span class="c1"># remove spin prior if spin_zero is True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">spin_zero</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sample_a_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers</span><span class="p">[</span><span class="s2">&quot;a_1&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sample_a_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers</span><span class="p">[</span><span class="s2">&quot;a_2&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">spin_precession</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sample_tilt_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers</span><span class="p">[</span><span class="s2">&quot;tilt_1&quot;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sample_tilt_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers</span><span class="p">[</span><span class="s2">&quot;tilt_2&quot;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sample_phi_12</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers</span><span class="p">[</span><span class="s2">&quot;phi_12&quot;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sample_phi_jl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers</span><span class="p">[</span><span class="s2">&quot;phi_jl&quot;</span><span class="p">]</span>

<div class="viewcode-block" id="CBCSourceParameterDistribution.lookup_table_luminosity_distance">
<a class="viewcode-back" href="../../../autoapi/ler/rates/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.lookup_table_luminosity_distance">[docs]</a>
    <span class="k">def</span> <span class="nf">lookup_table_luminosity_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="n">directory</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to create a lookup table for the differential comoving volume</span>
<span class="sd">        and luminosity distance wrt redshift.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z_min : `float`</span>
<span class="sd">            Minimum redshift of the source population</span>
<span class="sd">        z_max : `float`</span>
<span class="sd">            Maximum redshift of the source population</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">        z_to_luminosity_distance : `scipy.interpolate.interpolate`</span>
<span class="sd">            Function to convert redshift to luminosity distance</span>
<span class="sd">        differential_comoving_volume : `scipy.interpolate.interpolate`</span>
<span class="sd">            Function to calculate the differential comoving volume</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># initialing cosmological functions for fast calculation through interpolation</span>
        <span class="n">resolution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_n_i</span><span class="p">[</span><span class="s2">&quot;z_to_luminosity_distance&quot;</span><span class="p">][</span><span class="s2">&quot;resolution&quot;</span><span class="p">]</span>
        <span class="n">create_new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_n_i</span><span class="p">[</span><span class="s2">&quot;z_to_luminosity_distance&quot;</span><span class="p">][</span><span class="s2">&quot;create_new&quot;</span><span class="p">]</span>
        <span class="n">spline1</span> <span class="o">=</span> <span class="n">interpolator_from_pickle</span><span class="p">(</span>
            <span class="n">param_dict_given</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">z_min</span><span class="o">=</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="o">=</span><span class="n">z_max</span><span class="p">,</span> <span class="n">cosmology</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cosmo</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span>
            <span class="p">),</span>
            <span class="n">directory</span><span class="o">=</span><span class="n">directory</span><span class="p">,</span>
            <span class="n">sub_directory</span><span class="o">=</span><span class="s2">&quot;z_to_luminosity_distance&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;z_to_luminosity_distance&quot;</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="n">resolution</span><span class="p">),</span>
            <span class="n">pdf_func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">z_</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cosmo</span><span class="o">.</span><span class="n">luminosity_distance</span><span class="p">(</span><span class="n">z_</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="n">conditioned_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">dimension</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">category</span><span class="o">=</span><span class="s2">&quot;function&quot;</span><span class="p">,</span>
            <span class="n">create_new</span><span class="o">=</span><span class="n">create_new</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z_to_luminosity_distance</span> <span class="o">=</span> <span class="n">njit</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">z_</span><span class="p">:</span> <span class="n">cubic_spline_interpolator</span><span class="p">(</span><span class="n">z_</span><span class="p">,</span> <span class="n">spline1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">spline1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z_to_luminosity_distance</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        Function to convert redshift to luminosity distance.</span>
<span class="s2">        </span>
<span class="s2">        Parameters</span>
<span class="s2">        ----------</span>
<span class="s2">        zs : `numpy.ndarray`</span>
<span class="s2">            1D array of floats</span>
<span class="s2">            Source redshifts</span>

<span class="s2">        Returns</span>
<span class="s2">        ----------</span>
<span class="s2">        luminosity_distance : `numpy.ndarray`</span>
<span class="s2">            1D array of floats</span>
<span class="s2">            luminosity distance</span>
<span class="s2">        &quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="CBCSourceParameterDistribution.sample_gw_parameters">
<a class="viewcode-back" href="../../../autoapi/ler/rates/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.sample_gw_parameters">[docs]</a>
    <span class="k">def</span> <span class="nf">sample_gw_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to sample BBH/BNS/NSBH intrinsic and extrinsics parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        gw_parameters : `dict`</span>
<span class="sd">            Dictionary of sampled parameters</span>
<span class="sd">            gw_parameters.keys() = [&#39;mass_1&#39;, &#39;mass_2&#39;, &#39;mass_1_source&#39;, &#39;mass_2_source&#39;, &#39;zs&#39;, &#39;luminosity_distance&#39;, &#39;theta_jn&#39;, &#39;psi&#39;, &#39;phase&#39;, &#39;geocent_time&#39;, &#39;ra&#39;, &#39;dec&#39;, &#39;a_1&#39;, &#39;a_2&#39;, &#39;tilt_1&#39;, &#39;tilt_2&#39;, &#39;phi_12&#39;, &#39;phi_jl&#39;]</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------</span>
<span class="sd">        &gt;&gt;&gt; from ler.gw_source_population import CBCSourceParameterDistribution</span>
<span class="sd">        &gt;&gt;&gt; cbc = CBCSourceParameterDistribution()</span>
<span class="sd">        &gt;&gt;&gt; params = cbc.sample_gw_parameters(size=1000)</span>
<span class="sd">        &gt;&gt;&gt; print(&quot;sampled parameters=&quot;,list(params.keys()))</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># check for input parameters</span>
        <span class="k">if</span> <span class="n">param</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">param</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">param_keys</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">param_keys</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

        <span class="c1"># sample parameters</span>
        <span class="n">param_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">del</span> <span class="n">param_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># remove merger_rate_density</span>
        <span class="c1"># make sure the order is correct</span>
        <span class="n">sampler_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sampler_names</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="n">gw_parameters</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># initialize dictionary to store parameters</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">sampler</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">param_names</span><span class="p">,</span> <span class="n">sampler_names</span><span class="p">):</span>
            <span class="c1"># print(name)</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">param_keys</span><span class="p">:</span>
                <span class="c1"># Sample the parameter using the specified sampler function</span>
                <span class="n">gw_parameters</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sampler</span><span class="p">)(</span><span class="n">size</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Use the provided value from kwargs</span>
                <span class="n">gw_parameters</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

        <span class="c1"># calculate luminosity distance</span>
        <span class="n">zs</span> <span class="o">=</span> <span class="n">gw_parameters</span><span class="p">[</span><span class="s2">&quot;zs&quot;</span><span class="p">]</span>
        <span class="n">gw_parameters</span><span class="p">[</span><span class="s2">&quot;luminosity_distance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_to_luminosity_distance</span><span class="p">(</span><span class="n">zs</span><span class="p">)</span>  <span class="c1"># Mpc</span>
        
        <span class="c1"># mass1 and mass2</span>
        <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span> <span class="o">=</span> <span class="n">gw_parameters</span><span class="p">[</span><span class="s2">&quot;source_frame_masses&quot;</span><span class="p">]</span>  <span class="c1"># Msun</span>
        <span class="c1"># exchange m1 and m2 if m1 &lt; m2 in the fastest way</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">m1</span> <span class="o">&lt;</span> <span class="n">m2</span>
        <span class="n">m1</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">m2</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">m2</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">m1</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">gw_parameters</span><span class="p">[</span><span class="s2">&quot;mass_1_source&quot;</span><span class="p">],</span> <span class="n">gw_parameters</span><span class="p">[</span><span class="s2">&quot;mass_2_source&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span>
        <span class="n">gw_parameters</span><span class="p">[</span><span class="s2">&quot;mass_1&quot;</span><span class="p">],</span> <span class="n">gw_parameters</span><span class="p">[</span><span class="s2">&quot;mass_2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m1</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">zs</span><span class="p">),</span> <span class="n">m2</span> <span class="o">*</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">+</span> <span class="n">zs</span>
        <span class="p">)</span>  <span class="c1"># Msun</span>
        <span class="k">del</span> <span class="n">gw_parameters</span><span class="p">[</span><span class="s2">&quot;source_frame_masses&quot;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">gw_parameters</span></div>


<div class="viewcode-block" id="CBCSourceParameterDistribution.binary_masses_BBH_popI_II_powerlaw_gaussian">
<a class="viewcode-back" href="../../../autoapi/ler/rates/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.binary_masses_BBH_popI_II_powerlaw_gaussian">[docs]</a>
    <span class="k">def</span> <span class="nf">binary_masses_BBH_popI_II_powerlaw_gaussian</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">size</span><span class="p">,</span>
        <span class="n">mminbh</span><span class="o">=</span><span class="mf">4.98</span><span class="p">,</span>
        <span class="n">mmaxbh</span><span class="o">=</span><span class="mf">112.5</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">3.78</span><span class="p">,</span>
        <span class="n">mu_g</span><span class="o">=</span><span class="mf">32.27</span><span class="p">,</span>
        <span class="n">sigma_g</span><span class="o">=</span><span class="mf">3.88</span><span class="p">,</span>
        <span class="n">lambda_peak</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span>
        <span class="n">delta_m</span><span class="o">=</span><span class="mf">4.8</span><span class="p">,</span>
        <span class="n">beta</span><span class="o">=</span><span class="mf">0.81</span><span class="p">,</span>
        <span class="n">get_attribute</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to sample source mass1 and mass2 with PowerLaw+PEAK model</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>
<span class="sd">        mminbh : `float`</span>
<span class="sd">            Minimum mass of the black hole (Msun)</span>
<span class="sd">            default: 4.98</span>
<span class="sd">        mmaxbh : `float`</span>
<span class="sd">            Maximum mass of the black hole (Msun)</span>
<span class="sd">            default: 86.22</span>
<span class="sd">        alpha : `float`</span>
<span class="sd">            Spectral index for the powerlaw of the primary mass distribution</span>
<span class="sd">            default: 2.63</span>
<span class="sd">        mu_g : `float`</span>
<span class="sd">            Mean of the Gaussian component in the primary mass distribution</span>
<span class="sd">            default: 33.07</span>
<span class="sd">        sigma_g : `float`</span>
<span class="sd">            Width of the Gaussian component in the primary mass distribution</span>
<span class="sd">            default: 5.69</span>
<span class="sd">        lambda_peak : `float`</span>
<span class="sd">            Fraction of the model in the Gaussian component</span>
<span class="sd">            default: 0.10</span>
<span class="sd">        delta_m : `float`</span>
<span class="sd">            Range of mass tapering on the lower end of the mass distribution</span>
<span class="sd">            default: 4.82</span>
<span class="sd">        beta : `float`</span>
<span class="sd">            Spectral index for the powerlaw of the mass ratio distribution</span>
<span class="sd">        param : `dict`</span>
<span class="sd">            Allows to pass in above parameters as dict.</span>
<span class="sd">            e.g. param = dict(mminbh=4.98, mmaxbh=86.22, alpha=2.63, mu_g=33.07, sigma_g=5.69, lambda_peak=0.10, delta_m=4.82, beta=1.26)</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        mass_1_source : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of mass1 in source frame (Msun)</span>
<span class="sd">        mass_2_source : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of mass2 in source frame (Msun)</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------</span>
<span class="sd">        &gt;&gt;&gt; from ler.gw_source_population import CBCSourceParameterDistribution</span>
<span class="sd">        &gt;&gt;&gt; cbc = CBCSourceParameterDistribution()</span>
<span class="sd">        &gt;&gt;&gt; m1_src, m2_src = cbc.binary_masses_BBH_popI_II_powerlaw_gaussian(size=1000)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">param</span><span class="p">:</span>
            <span class="n">mminbh</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;mminbh&quot;</span><span class="p">]</span>
            <span class="n">mmaxbh</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;mmaxbh&quot;</span><span class="p">]</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">]</span>
            <span class="n">mu_g</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;mu_g&quot;</span><span class="p">]</span>
            <span class="n">sigma_g</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;sigma_g&quot;</span><span class="p">]</span>
            <span class="n">lambda_peak</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;lambda_peak&quot;</span><span class="p">]</span>
            <span class="n">delta_m</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;delta_m&quot;</span><span class="p">]</span>
            <span class="n">beta</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;beta&quot;</span><span class="p">]</span>

        <span class="c1"># check if the cdf exist</span>

        <span class="c1"># mass function</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">BBH_powerlaw_gaussian</span><span class="p">(</span>
            <span class="n">mminbh</span><span class="o">=</span><span class="n">mminbh</span><span class="p">,</span>
            <span class="n">mmaxbh</span><span class="o">=</span><span class="n">mmaxbh</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">mu_g</span><span class="o">=</span><span class="n">mu_g</span><span class="p">,</span>
            <span class="n">sigma_g</span><span class="o">=</span><span class="n">sigma_g</span><span class="p">,</span>
            <span class="n">lambda_peak</span><span class="o">=</span><span class="n">lambda_peak</span><span class="p">,</span>
            <span class="n">delta_m</span><span class="o">=</span><span class="n">delta_m</span><span class="p">,</span>
            <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">get_attribute</span><span class="p">:</span>
            <span class="n">sampler_function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">size_</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">Nsample</span><span class="o">=</span><span class="n">size_</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">sampler_function</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># sample mass1 and mass2</span>
            <span class="n">mass_1_source</span><span class="p">,</span> <span class="n">mass_2_source</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">Nsample</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

            <span class="k">return</span> <span class="p">(</span><span class="n">mass_1_source</span><span class="p">,</span> <span class="n">mass_2_source</span><span class="p">)</span></div>


<div class="viewcode-block" id="CBCSourceParameterDistribution.binary_masses_BBH_popIII_lognormal">
<a class="viewcode-back" href="../../../autoapi/ler/rates/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.binary_masses_BBH_popIII_lognormal">[docs]</a>
    <span class="k">def</span> <span class="nf">binary_masses_BBH_popIII_lognormal</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">size</span><span class="p">,</span>
        <span class="n">m_min</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>
        <span class="n">m_max</span><span class="o">=</span><span class="mf">150.0</span><span class="p">,</span>
        <span class="n">Mc</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span>
        <span class="n">sigma</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
        <span class="n">chunk_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
        <span class="n">get_attribute</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to sample source mass1 and mass2 with pop III origin. Refer to Eqn. 1 and 4 of Ng et al. 2022</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>
<span class="sd">        m_min : `float`</span>
<span class="sd">            Minimum mass of the black hole (popIII) (Msun)</span>
<span class="sd">            default: 10.</span>
<span class="sd">        m_max : `float`</span>
<span class="sd">            Maximum mass of the black hole (popIII) (Msun)</span>
<span class="sd">            default: 100.</span>
<span class="sd">        Mc    : `float`</span>
<span class="sd">            Mass scale; the distribution is centered around Mc</span>
<span class="sd">            default: 30.0</span>
<span class="sd">        sigma : `float`</span>
<span class="sd">            Width of the distribution</span>
<span class="sd">            default: 0.3</span>
<span class="sd">        param : `dict`</span>
<span class="sd">            Allows to pass in above parameters as dict.</span>
<span class="sd">            e.g. param = dict(m_min=10., m_max=100., Mc=30.0, sigma=0.3)</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        mass_1_source : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of mass1 in source frame (Msun)</span>
<span class="sd">        mass_2_source : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of mass2 in source frame (Msun)</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------</span>
<span class="sd">        &gt;&gt;&gt; from ler.gw_source_population import CBCSourceParameterDistribution</span>
<span class="sd">        &gt;&gt;&gt; cbc = CBCSourceParameterDistribution()</span>
<span class="sd">        &gt;&gt;&gt; m1_src, m2_src = cbc.binary_masses_BBH_popIII_lognormal(size=1000)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">param</span><span class="p">:</span>
            <span class="n">m_min</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;m_min&quot;</span><span class="p">]</span>
            <span class="n">m_max</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;m_max&quot;</span><span class="p">]</span>
            <span class="n">Mc</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;Mc&quot;</span><span class="p">]</span>
            <span class="n">sigma</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;sigma&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">get_attribute</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">njit</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">size_</span><span class="p">:</span> <span class="n">lognormal_distribution_2D</span><span class="p">(</span>
                    <span class="n">size_</span><span class="p">,</span>
                    <span class="n">m_min</span><span class="o">=</span><span class="n">m_min</span><span class="p">,</span>
                    <span class="n">m_max</span><span class="o">=</span><span class="n">m_max</span><span class="p">,</span>
                    <span class="n">Mc</span><span class="o">=</span><span class="n">Mc</span><span class="p">,</span>
                    <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
                    <span class="n">chunk_size</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">lognormal_distribution_2D</span><span class="p">(</span>
                <span class="n">size</span><span class="p">,</span>
                <span class="n">m_min</span><span class="o">=</span><span class="n">m_min</span><span class="p">,</span>
                <span class="n">m_max</span><span class="o">=</span><span class="n">m_max</span><span class="p">,</span>
                <span class="n">Mc</span><span class="o">=</span><span class="n">Mc</span><span class="p">,</span>
                <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
                <span class="n">chunk_size</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">,</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="CBCSourceParameterDistribution.binary_masses_BBH_primordial_lognormal">
<a class="viewcode-back" href="../../../autoapi/ler/rates/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.binary_masses_BBH_primordial_lognormal">[docs]</a>
    <span class="k">def</span> <span class="nf">binary_masses_BBH_primordial_lognormal</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">size</span><span class="p">,</span>
        <span class="n">m_min</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">m_max</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span>
        <span class="n">Mc</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span>
        <span class="n">sigma</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
        <span class="n">chunk_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
        <span class="n">get_attribute</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to sample source mass1 and mass2 with primordial origin. Refer to Eqn. 1 and 4 of Ng et al. 2022</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>
<span class="sd">        m_min : `float`</span>
<span class="sd">            Minimum mass of the black hole (primordial) (Msun)</span>
<span class="sd">            default: 10.</span>
<span class="sd">        m_max : `float`</span>
<span class="sd">            Maximum mass of the black hole (primordial) (Msun)</span>
<span class="sd">            default: 100.</span>
<span class="sd">        Mc, sigma : `float`</span>
<span class="sd">            Fitting parameters</span>
<span class="sd">            default: Mc=30.0, sigma=0.3</span>
<span class="sd">        param : `dict`</span>
<span class="sd">            Allows to pass in above parameters as dict.</span>
<span class="sd">            e.g. param = dict(m_min=10., m_max=100., Mc=30.0, sigma=0.3)</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        mass_1_source : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of mass1 in source frame (Msun)</span>
<span class="sd">        mass_2_source : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of mass2 in source frame (Msun)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">param</span><span class="p">:</span>
            <span class="n">m_min</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;m_min&quot;</span><span class="p">]</span>
            <span class="n">m_max</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;m_max&quot;</span><span class="p">]</span>
            <span class="n">Mc</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;Mc&quot;</span><span class="p">]</span>
            <span class="n">sigma</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;sigma&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">get_attribute</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">njit</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">size_</span><span class="p">:</span> <span class="n">lognormal_distribution_2D</span><span class="p">(</span>
                    <span class="n">size_</span><span class="p">,</span>
                    <span class="n">m_min</span><span class="o">=</span><span class="n">m_min</span><span class="p">,</span>
                    <span class="n">m_max</span><span class="o">=</span><span class="n">m_max</span><span class="p">,</span>
                    <span class="n">Mc</span><span class="o">=</span><span class="n">Mc</span><span class="p">,</span>
                    <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
                    <span class="n">chunk_size</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">lognormal_distribution_2D</span><span class="p">(</span>
                <span class="n">size</span><span class="p">,</span>
                <span class="n">m_min</span><span class="o">=</span><span class="n">m_min</span><span class="p">,</span>
                <span class="n">m_max</span><span class="o">=</span><span class="n">m_max</span><span class="p">,</span>
                <span class="n">Mc</span><span class="o">=</span><span class="n">Mc</span><span class="p">,</span>
                <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
                <span class="n">chunk_size</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">,</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="CBCSourceParameterDistribution.binary_masses_BNS_gwcosmo">
<a class="viewcode-back" href="../../../autoapi/ler/rates/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.binary_masses_BNS_gwcosmo">[docs]</a>
    <span class="k">def</span> <span class="nf">binary_masses_BNS_gwcosmo</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">mminns</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">mmaxns</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">alphans</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">get_attribute</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to calculate source mass1 and mass2 of BNS from powerlaw distribution (gwcosmo)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>
<span class="sd">        mminns : `float`</span>
<span class="sd">            Minimum mass of the BNS (Msun)</span>
<span class="sd">            default: 1.0</span>
<span class="sd">        mmaxns : `float`</span>
<span class="sd">            Maximum mass of the BNS (Msun)</span>
<span class="sd">            default: 3.0</span>
<span class="sd">        alphans : `float`</span>
<span class="sd">            Power law index</span>
<span class="sd">            default: 0.0</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        mass_1_source : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of mass1 in source frame (Msun)</span>
<span class="sd">        mass_2_source : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of mass2 in source frame (Msun)</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------</span>
<span class="sd">        &gt;&gt;&gt; from ler.gw_source_population import CBCSourceParameterDistribution</span>
<span class="sd">        &gt;&gt;&gt; cbc = CBCSourceParameterDistribution()</span>
<span class="sd">        &gt;&gt;&gt; m1_src, m2_src = cbc.binary_masses_BNS_gwcosmo(size=1000)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">param</span><span class="p">:</span>
            <span class="n">mminns</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;mminns&quot;</span><span class="p">]</span>
            <span class="n">mmaxns</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;mmaxns&quot;</span><span class="p">]</span>
            <span class="n">alphans</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;alphans&quot;</span><span class="p">]</span>

        <span class="c1"># mass function for BNS</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">BNS</span><span class="p">(</span><span class="n">mminns</span><span class="o">=</span><span class="n">mminns</span><span class="p">,</span> <span class="n">mmaxns</span><span class="o">=</span><span class="n">mmaxns</span><span class="p">,</span> <span class="n">alphans</span><span class="o">=</span><span class="n">alphans</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">get_attribute</span><span class="p">:</span>
            <span class="n">sampler_function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">size_</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">Nsample</span><span class="o">=</span><span class="n">size_</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">sampler_function</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># sampling</span>
            <span class="n">mass_1_source</span><span class="p">,</span> <span class="n">mass_2_source</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">Nsample</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

            <span class="k">return</span> <span class="p">(</span><span class="n">mass_1_source</span><span class="p">,</span> <span class="n">mass_2_source</span><span class="p">)</span></div>


<div class="viewcode-block" id="CBCSourceParameterDistribution.binary_masses_BNS_bimodal">
<a class="viewcode-back" href="../../../autoapi/ler/rates/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.binary_masses_BNS_bimodal">[docs]</a>
    <span class="k">def</span> <span class="nf">binary_masses_BNS_bimodal</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">size</span><span class="p">,</span>
        <span class="n">w</span><span class="o">=</span><span class="mf">0.643</span><span class="p">,</span>
        <span class="n">muL</span><span class="o">=</span><span class="mf">1.352</span><span class="p">,</span>
        <span class="n">sigmaL</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span>
        <span class="n">muR</span><span class="o">=</span><span class="mf">1.88</span><span class="p">,</span>
        <span class="n">sigmaR</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
        <span class="n">mmin</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">mmax</span><span class="o">=</span><span class="mf">2.3</span><span class="p">,</span>
        <span class="n">resolution</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
        <span class="n">create_new</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">get_attribute</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">param</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to sample source mass1 and mass2 from bimodal distribution. Refer to Will M. Farr et al. 2020 Eqn. 6</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>
<span class="sd">        w : `float`</span>
<span class="sd">            Weight of the left peak</span>
<span class="sd">            default: 0.643</span>
<span class="sd">        muL : `float`</span>
<span class="sd">            Mean of the left peak</span>
<span class="sd">            default: 1.352</span>
<span class="sd">        sigmaL : `float`</span>
<span class="sd">            Width of the left peak</span>
<span class="sd">            default: 0.08</span>
<span class="sd">        muR : `float`</span>
<span class="sd">            Mean of the right peak</span>
<span class="sd">            default: 1.88</span>
<span class="sd">        sigmaR : `float`</span>
<span class="sd">            Width of the right peak</span>
<span class="sd">            default: 0.3</span>
<span class="sd">        mmin : `float`</span>
<span class="sd">            Minimum mass of the BNS</span>
<span class="sd">            default: 1.0</span>
<span class="sd">        mmax : `float`</span>
<span class="sd">            Maximum mass of the BNS</span>
<span class="sd">            default: 2.3</span>
<span class="sd">        resolution : `int`</span>
<span class="sd">            Number of points to sample</span>
<span class="sd">            default: 500</span>
<span class="sd">        create_new : `bool`</span>
<span class="sd">            If True, create new interpolator</span>
<span class="sd">            default: False</span>
<span class="sd">        get_attribute : `bool`</span>
<span class="sd">            If True, return a sampler function with size as the only input where parameters are fixed to the given values.</span>
<span class="sd">        param : `dict`</span>
<span class="sd">            Allows to pass in above parameters as dict.</span>
<span class="sd">            e.g. param = dict(w=0.643, muL=1.352, sigmaL=0.08, muR=1.88, sigmaR=0.3, mmin=1.0, mmax=2.3, resolution=500)</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        mass_1_source : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of mass1 in source frame (Msun)</span>
<span class="sd">        mass_2_source : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of mass2 in source frame (Msun)</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------</span>
<span class="sd">        &gt;&gt;&gt; from ler.gw_source_population import CBCSourceParameterDistribution</span>
<span class="sd">        &gt;&gt;&gt; cbc = CBCSourceParameterDistribution()</span>
<span class="sd">        &gt;&gt;&gt; m1_src, m2_src = cbc.binary_masses_BNS_bimodal(size=1000)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">param</span><span class="p">:</span>
            <span class="n">w</span><span class="p">,</span> <span class="n">muL</span><span class="p">,</span> <span class="n">sigmaL</span><span class="p">,</span> <span class="n">muR</span><span class="p">,</span> <span class="n">sigmaR</span><span class="p">,</span> <span class="n">mmin</span><span class="p">,</span> <span class="n">mmax</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">param</span><span class="p">[</span><span class="s2">&quot;w&quot;</span><span class="p">],</span>
                <span class="n">param</span><span class="p">[</span><span class="s2">&quot;muL&quot;</span><span class="p">],</span>
                <span class="n">param</span><span class="p">[</span><span class="s2">&quot;sigmaL&quot;</span><span class="p">],</span>
                <span class="n">param</span><span class="p">[</span><span class="s2">&quot;muR&quot;</span><span class="p">],</span>
                <span class="n">param</span><span class="p">[</span><span class="s2">&quot;sigmaR&quot;</span><span class="p">],</span>
                <span class="n">param</span><span class="p">[</span><span class="s2">&quot;mmin&quot;</span><span class="p">],</span>
                <span class="n">param</span><span class="p">[</span><span class="s2">&quot;mmax&quot;</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="c1"># left and right peak</span>
        <span class="n">pdf_unnormL</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">m</span> <span class="o">-</span> <span class="n">muL</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigmaL</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">normL</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">pdf_unnormL</span><span class="p">,</span> <span class="n">mmin</span><span class="p">,</span> <span class="n">mmax</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># normalization constant</span>
        <span class="n">pdf_unnormR</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">m</span> <span class="o">-</span> <span class="n">muR</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigmaR</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">normR</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">pdf_unnormR</span><span class="p">,</span> <span class="n">mmin</span><span class="p">,</span> <span class="n">mmax</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># normalization constant</span>
        <span class="c1"># total pdf</span>
        <span class="n">pdf</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">w</span> <span class="o">*</span> <span class="n">pdf_unnormL</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">/</span> <span class="n">normL</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="n">pdf_unnormR</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">/</span> <span class="n">normR</span>

        <span class="c1"># find inverse cdf</span>
        <span class="n">inv_cdf</span> <span class="o">=</span> <span class="n">interpolator_from_pickle</span><span class="p">(</span>
            <span class="n">param_dict_given</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">w</span><span class="o">=</span><span class="mf">0.643</span><span class="p">,</span>
                <span class="n">muL</span><span class="o">=</span><span class="mf">1.352</span><span class="p">,</span>
                <span class="n">sigmaL</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span>
                <span class="n">muR</span><span class="o">=</span><span class="mf">1.88</span><span class="p">,</span>
                <span class="n">sigmaR</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                <span class="n">mmin</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">mmax</span><span class="o">=</span><span class="mf">2.3</span><span class="p">,</span>
                <span class="n">resolution</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">directory</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span><span class="p">,</span>
            <span class="n">sub_directory</span><span class="o">=</span><span class="s2">&quot;binary_masses_BNS_bimodal&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;binary_masses_BNS_bimodal&quot;</span><span class="p">,</span>
            <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">mmin</span><span class="p">,</span> <span class="n">mmax</span><span class="p">,</span> <span class="n">resolution</span><span class="p">),</span>
            <span class="n">pdf_func</span><span class="o">=</span><span class="n">pdf</span><span class="p">,</span>
            <span class="n">conditioned_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">dimension</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">category</span><span class="o">=</span><span class="s2">&quot;inv_cdf&quot;</span><span class="p">,</span>
            <span class="n">create_new</span><span class="o">=</span><span class="n">create_new</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># sample from inverse cdf</span>
        <span class="k">if</span> <span class="n">get_attribute</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">njit</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">size_</span><span class="p">:</span> <span class="n">inverse_transform_sampler_m1m2</span><span class="p">(</span>
                    <span class="n">size_</span><span class="p">,</span> <span class="n">inv_cdf</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inv_cdf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">inverse_transform_sampler_m1m2</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">inv_cdf</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">inv_cdf</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span></div>


<div class="viewcode-block" id="CBCSourceParameterDistribution.constant_values_n_size">
<a class="viewcode-back" href="../../../autoapi/ler/rates/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.constant_values_n_size">[docs]</a>
    <span class="k">def</span> <span class="nf">constant_values_n_size</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">get_attribute</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to sample constant values of size n.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>
<span class="sd">        value : `float`</span>
<span class="sd">            Constant value</span>
<span class="sd">            default: 0.0</span>
<span class="sd">        get_attribute : `bool`</span>
<span class="sd">            If True, return the njitted sampler function with size as the only input where parameters are fixed to the given values.</span>
<span class="sd">        param : `dict`</span>
<span class="sd">            Allows to pass in above parameters as dict.</span>
<span class="sd">            e.g. param = dict(value=0.0)</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        values : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of constant values</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------</span>
<span class="sd">        &gt;&gt;&gt; from ler.gw_source_population import CBCSourceParameterDistribution</span>
<span class="sd">        &gt;&gt;&gt; cbc = CBCSourceParameterDistribution()</span>
<span class="sd">        &gt;&gt;&gt; value = cbc.constant_values_n_size(size=1000)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">param</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">get_attribute</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">njit</span><span class="p">(</span><span class="k">lambda</span> <span class="n">size_</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">size_</span><span class="p">)</span> <span class="o">*</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="o">*</span> <span class="n">value</span></div>


<div class="viewcode-block" id="CBCSourceParameterDistribution.sampler_uniform">
<a class="viewcode-back" href="../../../autoapi/ler/rates/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.sampler_uniform">[docs]</a>
    <span class="k">def</span> <span class="nf">sampler_uniform</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">min_</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">get_attribute</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to sample values from uniform distribution.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>
<span class="sd">        start_time : `float`</span>
<span class="sd">            Start time of the uniform distribution</span>
<span class="sd">            default: 1238166018</span>
<span class="sd">        end_time : `float`</span>
<span class="sd">            End time of the uniform distribution</span>
<span class="sd">            default: 1238166018 + 31536000</span>
<span class="sd">        get_attribute : `bool`</span>
<span class="sd">            If True, return the njitted sampler function with size as the only input where parameters are fixed to the given values.</span>
<span class="sd">        param : `dict`</span>
<span class="sd">            Allows to pass in above parameters as dict.</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        values : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of uniformly distributed values in the range of [min_, max_]</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------</span>
<span class="sd">        &gt;&gt;&gt; from ler.gw_source_population import CBCSourceParameterDistribution</span>
<span class="sd">        &gt;&gt;&gt; cbc = CBCSourceParameterDistribution()</span>
<span class="sd">        &gt;&gt;&gt; value = cbc.sampler_uniform(size=1000)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">param</span><span class="p">:</span>
            <span class="n">min_</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;min_&quot;</span><span class="p">]</span>
            <span class="n">max_</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;max_&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">get_attribute</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">njit</span><span class="p">(</span><span class="k">lambda</span> <span class="n">size_</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">min_</span><span class="p">,</span> <span class="n">max_</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size_</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">min_</span><span class="p">,</span> <span class="n">max_</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span></div>


<div class="viewcode-block" id="CBCSourceParameterDistribution.sampler_cosine">
<a class="viewcode-back" href="../../../autoapi/ler/rates/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.sampler_cosine">[docs]</a>
    <span class="k">def</span> <span class="nf">sampler_cosine</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">get_attribute</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to sample from sine distribution at the limit of [-np.pi/2, np.pi/2]</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>
<span class="sd">        get_attribute : `bool`</span>
<span class="sd">            If True, return the njitted sampler function with size as the only input where parameters are fixed to the given values.</span>
<span class="sd">        param : None</span>
<span class="sd">            This parameter is not used. It is only here to make the function signature consistent with other samplers.</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        sine : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of values in the range of [-np.pi/2, np.pi/2]</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">get_attribute</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">njit</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">size_</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size_</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span></div>


<div class="viewcode-block" id="CBCSourceParameterDistribution.sampler_sine">
<a class="viewcode-back" href="../../../autoapi/ler/rates/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.sampler_sine">[docs]</a>
    <span class="k">def</span> <span class="nf">sampler_sine</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">get_attribute</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to sample from sine distribution at the limit of [0, np.pi]</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>
<span class="sd">        get_attribute : `bool`</span>
<span class="sd">            If True, return the njitted sampler function with size as the only input where parameters are fixed to the given values.</span>
<span class="sd">        param : None</span>
<span class="sd">            This parameter is not used. It is only here to make the function signature consistent with other samplers.</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        sine : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of values in the range of [0, np.pi]</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">get_attribute</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">njit</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">size_</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size_</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span></div>


    <span class="nd">@property</span>
<div class="viewcode-block" id="CBCSourceParameterDistribution.available_gw_prior_list_and_its_params">
<a class="viewcode-back" href="../../../autoapi/ler/gw_source_population/cbc_source_parameter_distribution/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.available_gw_prior_list_and_its_params">[docs]</a>
    <span class="k">def</span> <span class="nf">available_gw_prior_list_and_its_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dictionary with list all the available priors and it&#39;s corresponding parameters. This is an immutable instance attribute.</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------</span>
<span class="sd">        &gt;&gt;&gt; from ler.gw_source_population import CompactBinaryPopulation</span>
<span class="sd">        &gt;&gt;&gt; cbc = CompactBinaryPopulation()</span>
<span class="sd">        &gt;&gt;&gt; priors = cbc.available_gw_prior_list_and_its_params</span>
<span class="sd">        &gt;&gt;&gt; priors.keys()  # type of priors</span>
<span class="sd">        dict_keys([&#39;merger_rate_density&#39;, &#39;source_frame_masses&#39;, &#39;spin&#39;, &#39;geocent_time&#39;, &#39;ra&#39;, &#39;phase&#39;, &#39;psi&#39;, &#39;theta_jn&#39;])</span>
<span class="sd">        &gt;&gt;&gt; priors[&#39;source_frame_masses&#39;].keys()  # type of source_frame_masses priors</span>
<span class="sd">        dict_keys([&#39;binary_masses_BBH_popI_II_powerlaw_gaussian&#39;, &#39;binary_masses_BBH_popIII_lognormal&#39;, &#39;binary_masses_BBH_primordial_lognormal&#39;, &#39;binary_masses_BNS_gwcosmo&#39;, &#39;binary_masses_BNS_bimodal&#39;])</span>
<span class="sd">        &gt;&gt;&gt; priors[&#39;source_frame_masses&#39;][&#39;binary_masses_BBH_popI_II_powerlaw_gaussian&#39;].keys()  # parameters of binary_masses_BBH_popI_II_powerlaw_gaussian</span>
<span class="sd">        dict_keys([&#39;mminbh&#39;, &#39;mmaxbh&#39;, &#39;alpha&#39;, &#39;mu_g&#39;, &#39;sigma_g&#39;, &#39;lambda_peak&#39;, &#39;delta_m&#39;, &#39;beta&#39;])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_available_gw_prior_list_and_its_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">merger_rate_density</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">merger_rate_density_model_list</span><span class="p">,</span>
            <span class="n">source_frame_masses</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">binary_masses_BBH_popI_II_powerlaw_gaussian</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">mminbh</span><span class="o">=</span><span class="mf">4.98</span><span class="p">,</span>
                    <span class="n">mmaxbh</span><span class="o">=</span><span class="mf">112.5</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="mf">3.78</span><span class="p">,</span>
                    <span class="n">mu_g</span><span class="o">=</span><span class="mf">32.27</span><span class="p">,</span>
                    <span class="n">sigma_g</span><span class="o">=</span><span class="mf">3.88</span><span class="p">,</span>
                    <span class="n">lambda_peak</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span>
                    <span class="n">delta_m</span><span class="o">=</span><span class="mf">4.8</span><span class="p">,</span>
                    <span class="n">beta</span><span class="o">=</span><span class="mf">0.81</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">binary_masses_BBH_popIII_lognormal</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">Mc</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">1.1</span><span class="p">),</span>
                <span class="n">binary_masses_BBH_primordial_lognormal</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">Mc</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">1.1</span>
                <span class="p">),</span>
                <span class="n">binary_masses_BNS_gwcosmo</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">mminns</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">mmaxns</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">alphans</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
                <span class="n">binary_masses_BNS_bimodal</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">w</span><span class="o">=</span><span class="mf">0.643</span><span class="p">,</span>
                    <span class="n">muL</span><span class="o">=</span><span class="mf">1.352</span><span class="p">,</span>
                    <span class="n">sigmaL</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span>
                    <span class="n">muR</span><span class="o">=</span><span class="mf">1.88</span><span class="p">,</span>
                    <span class="n">sigmaR</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                    <span class="n">mmin</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                    <span class="n">mmax</span><span class="o">=</span><span class="mf">2.3</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">),</span>
            <span class="n">zs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">sample_source_redshift</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">zs</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
            <span class="p">),</span>
            <span class="n">spin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">constant_values_n_size</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
                <span class="n">binary_spin_BBH_bilby</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">binary_spin_BNS_bilby</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="n">geocent_time</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                <span class="n">geocent_time_uniform</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">start_time</span><span class="o">=</span><span class="mi">1238166018</span><span class="p">,</span> <span class="n">end_time</span><span class="o">=</span><span class="mi">1238166018</span> <span class="o">+</span> <span class="mi">31536000</span>
                <span class="p">)</span>
            <span class="p">),</span>
            <span class="n">ra</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">ra_uniform_bilby</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
            <span class="n">phase</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">phase_uniform_bilby</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
            <span class="n">psi</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">psi_uniform_bilby</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
            <span class="n">theta_jn</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">theta_jn_uniform_bilby</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_available_gw_prior_list_and_its_params</span></div>


<div class="viewcode-block" id="CBCSourceParameterDistribution.source_priors_categorization">
<a class="viewcode-back" href="../../../autoapi/ler/rates/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.source_priors_categorization">[docs]</a>
    <span class="k">def</span> <span class="nf">source_priors_categorization</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">event_type</span><span class="p">,</span> <span class="n">source_priors</span><span class="p">,</span> <span class="n">event_prior_params</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to categorize the event priors and its parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        event_type : `str`</span>
<span class="sd">            Type of event to generate.</span>
<span class="sd">            e.g. &#39;BBH&#39;, &#39;BNS&#39;, &#39;BBH_popIII&#39;, &#39;BBH_primordial&#39;, &#39;NSBH&#39;</span>
<span class="sd">        source_priors : `dict`</span>
<span class="sd">            Dictionary of prior sampler functions for each parameter</span>
<span class="sd">        event_prior_params : `dict`</span>
<span class="sd">            Dictionary of sampler parameters for each GW parameter</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        source_priors_ : `dict`</span>
<span class="sd">            Dictionary of prior sampler functions for each parameter</span>
<span class="sd">        event_prior_params_ : `dict`</span>
<span class="sd">            Dictionary of sampler parameters for each parameter</span>
<span class="sd">        sampler_names_ : `dict`</span>
<span class="sd">            Dictionary of sampler names with description</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------</span>
<span class="sd">        &gt;&gt;&gt; from ler.gw_source_population import CBCSourceParameterDistribution</span>
<span class="sd">        &gt;&gt;&gt; cbc = CBCSourceParameterDistribution()</span>
<span class="sd">        &gt;&gt;&gt; source_priors, event_prior_params, sampler_names = cbc.source_priors_categorization(event_type=&#39;BBH&#39;, source_priors=None, event_prior_params=None)</span>
<span class="sd">        &gt;&gt;&gt; print(source_priors.keys())</span>
<span class="sd">        &gt;&gt;&gt; print(event_prior_params.keys())</span>
<span class="sd">        &gt;&gt;&gt; print(sampler_names.keys())</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># for BBH</span>
        <span class="k">if</span> <span class="n">event_type</span> <span class="o">==</span> <span class="s2">&quot;BBH&quot;</span><span class="p">:</span>
            <span class="n">merger_rate_density_prior</span> <span class="o">=</span> <span class="s2">&quot;merger_rate_density_bbh_popI_II_oguri2018&quot;</span>
            <span class="n">merger_rate_density_prior_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">R0</span><span class="o">=</span><span class="mf">23.9</span> <span class="o">*</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">b2</span><span class="o">=</span><span class="mf">1.6</span><span class="p">,</span> <span class="n">b3</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">b4</span><span class="o">=</span><span class="mi">30</span>
            <span class="p">)</span>
            <span class="n">source_frame_masses_prior</span> <span class="o">=</span> <span class="s2">&quot;binary_masses_BBH_popI_II_powerlaw_gaussian&quot;</span>
            <span class="n">source_frame_masses_prior_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">mminbh</span><span class="o">=</span><span class="mf">4.98</span><span class="p">,</span>
                <span class="n">mmaxbh</span><span class="o">=</span><span class="mf">112.5</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">3.78</span><span class="p">,</span>
                <span class="n">mu_g</span><span class="o">=</span><span class="mf">32.27</span><span class="p">,</span>
                <span class="n">sigma_g</span><span class="o">=</span><span class="mf">3.88</span><span class="p">,</span>
                <span class="n">lambda_peak</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span>
                <span class="n">delta_m</span><span class="o">=</span><span class="mf">4.8</span><span class="p">,</span>
                <span class="n">beta</span><span class="o">=</span><span class="mf">0.81</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">a_max</span> <span class="o">=</span> <span class="mf">0.8</span>

        <span class="k">elif</span> <span class="n">event_type</span> <span class="o">==</span> <span class="s2">&quot;BNS&quot;</span><span class="p">:</span>
            <span class="n">merger_rate_density_prior</span> <span class="o">=</span> <span class="s2">&quot;merger_rate_density_bbh_popI_II_oguri2018&quot;</span>
            <span class="n">merger_rate_density_prior_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">R0</span><span class="o">=</span><span class="mf">105.5</span> <span class="o">*</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">b2</span><span class="o">=</span><span class="mf">1.6</span><span class="p">,</span> <span class="n">b3</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">b4</span><span class="o">=</span><span class="mi">30</span>
            <span class="p">)</span>
            <span class="n">source_frame_masses_prior</span> <span class="o">=</span> <span class="s2">&quot;binary_masses_BNS_bimodal&quot;</span>
            <span class="n">source_frame_masses_prior_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">w</span><span class="o">=</span><span class="mf">0.643</span><span class="p">,</span>
                <span class="n">muL</span><span class="o">=</span><span class="mf">1.352</span><span class="p">,</span>
                <span class="n">sigmaL</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span>
                <span class="n">muR</span><span class="o">=</span><span class="mf">1.88</span><span class="p">,</span>
                <span class="n">sigmaR</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                <span class="n">mmin</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">mmax</span><span class="o">=</span><span class="mf">2.3</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">a_max</span> <span class="o">=</span> <span class="mf">0.05</span>

        <span class="k">elif</span> <span class="n">event_type</span> <span class="o">==</span> <span class="s2">&quot;NSBH&quot;</span><span class="p">:</span>
            <span class="n">merger_rate_density_prior</span> <span class="o">=</span> <span class="s2">&quot;merger_rate_density_bbh_popI_II_oguri2018&quot;</span>
            <span class="n">merger_rate_density_prior_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">R0</span><span class="o">=</span><span class="mf">27.0</span> <span class="o">*</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">b2</span><span class="o">=</span><span class="mf">1.6</span><span class="p">,</span> <span class="n">b3</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">b4</span><span class="o">=</span><span class="mi">30</span>
            <span class="p">)</span>
            <span class="n">source_frame_masses_prior</span> <span class="o">=</span> <span class="s2">&quot;binary_masses_NSBH_broken_powerlaw&quot;</span>
            <span class="n">source_frame_masses_prior_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">mminbh</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span>
                <span class="n">mmaxbh</span><span class="o">=</span><span class="mi">125</span><span class="p">,</span>
                <span class="n">alpha_1</span><span class="o">=</span><span class="mf">6.75</span><span class="p">,</span>
                <span class="n">alpha_2</span><span class="o">=</span><span class="mf">6.75</span><span class="p">,</span>
                <span class="n">b</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                <span class="n">delta_m</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                <span class="n">mminns</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                <span class="n">mmaxns</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span>
                <span class="n">alphans</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">a_max</span> <span class="o">=</span> <span class="mf">0.8</span>

        <span class="k">elif</span> <span class="n">event_type</span> <span class="o">==</span> <span class="s2">&quot;BBH_popIII&quot;</span><span class="p">:</span>
            <span class="n">merger_rate_density_prior</span> <span class="o">=</span> <span class="s2">&quot;merger_rate_density_bbh_popIII_ken2022&quot;</span>
            <span class="n">merger_rate_density_prior_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">n0</span><span class="o">=</span><span class="mf">19.2</span> <span class="o">*</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">aIII</span><span class="o">=</span><span class="mf">0.66</span><span class="p">,</span> <span class="n">bIII</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">zIII</span><span class="o">=</span><span class="mf">11.6</span>
            <span class="p">)</span>
            <span class="n">source_frame_masses_prior</span> <span class="o">=</span> <span class="s2">&quot;binary_masses_BBH_popIII_lognormal&quot;</span>
            <span class="n">source_frame_masses_prior_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">m_min</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">m_max</span><span class="o">=</span><span class="mf">150.0</span><span class="p">,</span> <span class="n">Mc</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="mi">10000</span>
            <span class="p">)</span>
            <span class="n">a_max</span> <span class="o">=</span> <span class="mf">0.8</span>

        <span class="k">elif</span> <span class="n">event_type</span> <span class="o">==</span> <span class="s2">&quot;BBH_primordial&quot;</span><span class="p">:</span>
            <span class="n">merger_rate_density_prior</span> <span class="o">=</span> <span class="s2">&quot;merger_rate_density_bbh_primordial_ken2022&quot;</span>
            <span class="n">merger_rate_density_prior_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">n0</span><span class="o">=</span><span class="mf">0.044</span> <span class="o">*</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mf">13.786885302009708</span>
            <span class="p">)</span>
            <span class="n">source_frame_masses_prior</span> <span class="o">=</span> <span class="s2">&quot;binary_masses_BBH_primordial_lognormal&quot;</span>
            <span class="n">source_frame_masses_prior_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">m_min</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">m_max</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span> <span class="n">Mc</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="mi">10000</span>
            <span class="p">)</span>
            <span class="n">a_max</span> <span class="o">=</span> <span class="mf">0.8</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;event_type is not recognized&quot;</span><span class="p">)</span>

        <span class="c1"># setting the priors and its parameters</span>
        <span class="n">source_priors_</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">merger_rate_density</span><span class="o">=</span><span class="n">merger_rate_density_prior</span><span class="p">,</span>
            <span class="n">source_frame_masses</span><span class="o">=</span><span class="n">source_frame_masses_prior</span><span class="p">,</span>
            <span class="n">zs</span><span class="o">=</span><span class="s2">&quot;sample_source_redshift&quot;</span><span class="p">,</span>
            <span class="n">geocent_time</span><span class="o">=</span><span class="s2">&quot;sampler_uniform&quot;</span><span class="p">,</span>
            <span class="n">ra</span><span class="o">=</span><span class="s2">&quot;sampler_uniform&quot;</span><span class="p">,</span>
            <span class="n">dec</span><span class="o">=</span><span class="s2">&quot;sampler_cosine&quot;</span><span class="p">,</span>
            <span class="n">phase</span><span class="o">=</span><span class="s2">&quot;sampler_uniform&quot;</span><span class="p">,</span>
            <span class="n">psi</span><span class="o">=</span><span class="s2">&quot;sampler_uniform&quot;</span><span class="p">,</span>
            <span class="n">theta_jn</span><span class="o">=</span><span class="s2">&quot;sampler_sine&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">event_prior_params_</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">merger_rate_density</span><span class="o">=</span><span class="n">merger_rate_density_prior_params</span><span class="p">,</span>
            <span class="n">source_frame_masses</span><span class="o">=</span><span class="n">source_frame_masses_prior_params</span><span class="p">,</span>
            <span class="n">zs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">geocent_time</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">min_</span><span class="o">=</span><span class="mi">1238166018</span><span class="p">,</span> <span class="n">max_</span><span class="o">=</span><span class="mi">1269702018</span><span class="p">),</span>
            <span class="n">ra</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">min_</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">max_</span><span class="o">=</span><span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
            <span class="n">dec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">phase</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">min_</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">max_</span><span class="o">=</span><span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
            <span class="n">psi</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">min_</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">max_</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
            <span class="n">theta_jn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># dict of sampler names with description</span>
        <span class="n">sampler_names_</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">sample_source_frame_masses</span><span class="o">=</span><span class="s2">&quot;samples mass1 and mass2 of the compact binaries&quot;</span><span class="p">,</span>
            <span class="n">sample_zs</span><span class="o">=</span><span class="s2">&quot;samples source redshifts&quot;</span><span class="p">,</span>
            <span class="n">sample_geocent_time</span><span class="o">=</span><span class="s2">&quot;samples geocent_time&quot;</span><span class="p">,</span>
            <span class="n">sample_ra</span><span class="o">=</span><span class="s2">&quot;samples right ascension of sky position&quot;</span><span class="p">,</span>
            <span class="n">sample_dec</span><span class="o">=</span><span class="s2">&quot;samples declination of sky position&quot;</span><span class="p">,</span>
            <span class="n">sample_phase</span><span class="o">=</span><span class="s2">&quot;samples coalescence phase&quot;</span><span class="p">,</span>
            <span class="n">sample_psi</span><span class="o">=</span><span class="s2">&quot;samples polarization angle&quot;</span><span class="p">,</span>
            <span class="n">sample_theta_jn</span><span class="o">=</span><span class="s2">&quot;samples inclination angle&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># spin</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin_zero</span><span class="p">:</span>
            <span class="n">source_priors_</span><span class="p">[</span><span class="s2">&quot;a_1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sampler_uniform&quot;</span>
            <span class="n">event_prior_params_</span><span class="p">[</span><span class="s2">&quot;a_1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">min_</span><span class="o">=-</span><span class="n">a_max</span><span class="p">,</span> <span class="n">max_</span><span class="o">=</span><span class="n">a_max</span><span class="p">)</span>
            <span class="n">sampler_names_</span><span class="p">[</span>
                <span class="s2">&quot;sample_a_1&quot;</span>
            <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;samples spin magnitude of the compact binaries (body1)&quot;</span>
            <span class="n">source_priors_</span><span class="p">[</span><span class="s2">&quot;a_2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sampler_uniform&quot;</span>
            <span class="n">event_prior_params_</span><span class="p">[</span><span class="s2">&quot;a_2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">min_</span><span class="o">=-</span><span class="n">a_max</span><span class="p">,</span> <span class="n">max_</span><span class="o">=</span><span class="n">a_max</span><span class="p">)</span>
            <span class="n">sampler_names_</span><span class="p">[</span>
                <span class="s2">&quot;sample_a_2&quot;</span>
            <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;samples spin magnitude of the compact binaries (body2)&quot;</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spin_precession</span><span class="p">:</span>
                <span class="n">source_priors_</span><span class="p">[</span><span class="s2">&quot;a_1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sampler_uniform&quot;</span>
                <span class="n">event_prior_params_</span><span class="p">[</span><span class="s2">&quot;a_1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">min_</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">max_</span><span class="o">=</span><span class="n">a_max</span><span class="p">)</span>
                <span class="n">source_priors_</span><span class="p">[</span><span class="s2">&quot;a_2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sampler_uniform&quot;</span>
                <span class="n">event_prior_params_</span><span class="p">[</span><span class="s2">&quot;a_2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">min_</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">max_</span><span class="o">=</span><span class="n">a_max</span><span class="p">)</span>
                <span class="n">source_priors_</span><span class="p">[</span><span class="s2">&quot;tilt_1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sampler_sine&quot;</span>
                <span class="n">event_prior_params_</span><span class="p">[</span><span class="s2">&quot;tilt_1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">sampler_names_</span><span class="p">[</span>
                    <span class="s2">&quot;sample_tilt_1&quot;</span>
                <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;samples tilt angle of the compact binaries (body1)&quot;</span>

                <span class="n">source_priors_</span><span class="p">[</span><span class="s2">&quot;tilt_2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sampler_sine&quot;</span>
                <span class="n">event_prior_params_</span><span class="p">[</span><span class="s2">&quot;tilt_2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">sampler_names_</span><span class="p">[</span>
                    <span class="s2">&quot;sample_tilt_2&quot;</span>
                <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;samples tilt angle of the compact binaries (body2)&quot;</span>

                <span class="n">source_priors_</span><span class="p">[</span><span class="s2">&quot;phi_12&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sampler_uniform&quot;</span>
                <span class="n">event_prior_params_</span><span class="p">[</span><span class="s2">&quot;phi_12&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">min_</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
                <span class="n">sampler_names_</span><span class="p">[</span>
                    <span class="s2">&quot;sample_phi_12&quot;</span>
                <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;samples azimuthal angle between the two spins&quot;</span>
                <span class="n">source_priors_</span><span class="p">[</span><span class="s2">&quot;phi_jl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sampler_uniform&quot;</span>
                <span class="n">event_prior_params_</span><span class="p">[</span><span class="s2">&quot;phi_jl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">min_</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
                <span class="n">sampler_names_</span><span class="p">[</span>
                    <span class="s2">&quot;sample_phi_jl&quot;</span>
                <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;samples azimuthal angle between the total angular momentum and the orbital angular momentum&quot;</span>

        <span class="c1"># update the priors if input is given</span>
        <span class="k">if</span> <span class="n">source_priors</span><span class="p">:</span>
            <span class="n">source_priors_</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">source_priors</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">event_prior_params</span><span class="p">:</span>
            <span class="n">event_prior_params_</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">event_prior_params</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">source_priors_</span><span class="p">,</span> <span class="n">event_prior_params_</span><span class="p">,</span> <span class="n">sampler_names_</span><span class="p">)</span></div>


    <span class="nd">@property</span>
<div class="viewcode-block" id="CBCSourceParameterDistribution.sample_zs">
<a class="viewcode-back" href="../../../autoapi/ler/gw_source_population/cbc_source_parameter_distribution/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.sample_zs">[docs]</a>
    <span class="k">def</span> <span class="nf">sample_zs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to sample redshifts with the initialized prior.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        zs : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of redshifts</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_zs</span></div>


    <span class="nd">@sample_zs</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">sample_zs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_sample_zs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers_params</span><span class="p">[</span><span class="s2">&quot;zs&quot;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_sample_zs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">)(</span>
                    <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_attribute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">args</span>
                <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_zs</span> <span class="o">=</span> <span class="n">prior</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="CBCSourceParameterDistribution.sample_source_frame_masses">
<a class="viewcode-back" href="../../../autoapi/ler/gw_source_population/cbc_source_parameter_distribution/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.sample_source_frame_masses">[docs]</a>
    <span class="k">def</span> <span class="nf">sample_source_frame_masses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to sample source frame masses (mass1_source, mass2_source) with the initialized prior.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        mass_1_source : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of mass1 in source frame</span>
<span class="sd">        mass_2_source : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of mass2 in source frame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_source_frame_masses</span></div>


    <span class="nd">@sample_source_frame_masses</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">sample_source_frame_masses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers_params</span><span class="p">[</span><span class="s2">&quot;source_frame_masses&quot;</span><span class="p">]</span>
    
        <span class="c1"># Check if &#39;prior&#39; is a callable attribute of self</span>
        <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers_params</span><span class="p">[</span><span class="s2">&quot;source_frame_masses&quot;</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># If prior is a method of the class</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_source_frame_masses</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">)(</span>
                <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_attribute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">args</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c1"># If prior is a standalone function</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_sample_source_frame_masses</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">size</span><span class="p">:</span> <span class="n">prior</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">args</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;given source_frame_masses function should follow the signature of the default ones&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="CBCSourceParameterDistribution.sample_geocent_time">
<a class="viewcode-back" href="../../../autoapi/ler/gw_source_population/cbc_source_parameter_distribution/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.sample_geocent_time">[docs]</a>
    <span class="k">def</span> <span class="nf">sample_geocent_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to sample geocent time with the initialized prior.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        geocent_time : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of geocent_time or time of coalescence</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_geocent_time</span></div>


    <span class="nd">@sample_geocent_time</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">sample_geocent_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers_params</span><span class="p">[</span><span class="s2">&quot;geocent_time&quot;</span><span class="p">]</span>
            <span class="c1"># follwing should return a sampler function with only one argument (size)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_geocent_time</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">)(</span>
                <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_attribute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">args</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_geocent_time</span> <span class="o">=</span> <span class="n">prior</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="CBCSourceParameterDistribution.sample_ra">
<a class="viewcode-back" href="../../../autoapi/ler/gw_source_population/cbc_source_parameter_distribution/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.sample_ra">[docs]</a>
    <span class="k">def</span> <span class="nf">sample_ra</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to sample right ascension of sky position with the initialized prior.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        ra : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of right ascension of sky position</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_ra</span></div>


    <span class="nd">@sample_ra</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">sample_ra</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers_params</span><span class="p">[</span><span class="s2">&quot;ra&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_ra</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">)(</span>
                <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_attribute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">args</span>
            <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_ra</span> <span class="o">=</span> <span class="n">prior</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="CBCSourceParameterDistribution.sample_dec">
<a class="viewcode-back" href="../../../autoapi/ler/gw_source_population/cbc_source_parameter_distribution/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.sample_dec">[docs]</a>
    <span class="k">def</span> <span class="nf">sample_dec</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to sample declination of sky position with the initialized prior.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        dec : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of declination of sky position</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_dec</span></div>


    <span class="nd">@sample_dec</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">sample_dec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers_params</span><span class="p">[</span><span class="s2">&quot;dec&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_dec</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">)(</span>
                <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_attribute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">args</span>
            <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_dec</span> <span class="o">=</span> <span class="n">prior</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="CBCSourceParameterDistribution.sample_phase">
<a class="viewcode-back" href="../../../autoapi/ler/gw_source_population/cbc_source_parameter_distribution/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.sample_phase">[docs]</a>
    <span class="k">def</span> <span class="nf">sample_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to sample coalescence phase with the initialized prior.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        phase : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of coalescence phase</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_phase</span></div>


    <span class="nd">@sample_phase</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">sample_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers_params</span><span class="p">[</span><span class="s2">&quot;phase&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_phase</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">)(</span>
                <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_attribute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">args</span>
            <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_phase</span> <span class="o">=</span> <span class="n">prior</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="CBCSourceParameterDistribution.sample_psi">
<a class="viewcode-back" href="../../../autoapi/ler/gw_source_population/cbc_source_parameter_distribution/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.sample_psi">[docs]</a>
    <span class="k">def</span> <span class="nf">sample_psi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to sample polarization angle with the initialized prior.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        psi : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of polarization angle</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_psi</span></div>


    <span class="nd">@sample_psi</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">sample_psi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers_params</span><span class="p">[</span><span class="s2">&quot;psi&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_psi</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">)(</span>
                <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_attribute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">args</span>
            <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_psi</span> <span class="o">=</span> <span class="n">prior</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="CBCSourceParameterDistribution.sample_theta_jn">
<a class="viewcode-back" href="../../../autoapi/ler/gw_source_population/cbc_source_parameter_distribution/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.sample_theta_jn">[docs]</a>
    <span class="k">def</span> <span class="nf">sample_theta_jn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to sample theta_jn with the initialized prior.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        theta_jn : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of theta_jn</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_theta_jn</span></div>


    <span class="nd">@sample_theta_jn</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">sample_theta_jn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers_params</span><span class="p">[</span><span class="s2">&quot;theta_jn&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_theta_jn</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">)(</span>
                <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_attribute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">args</span>
            <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_theta_jn</span> <span class="o">=</span> <span class="n">prior</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="CBCSourceParameterDistribution.sample_a_1">
<a class="viewcode-back" href="../../../autoapi/ler/gw_source_population/cbc_source_parameter_distribution/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.sample_a_1">[docs]</a>
    <span class="k">def</span> <span class="nf">sample_a_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to sample spin magnitude of the compact binaries (body1) with the initialized prior.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        a_1 : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of spin magnitude of the compact binaries (body1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_a_1</span></div>


    <span class="nd">@sample_a_1</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">sample_a_1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers_params</span><span class="p">[</span><span class="s2">&quot;a_1&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_a_1</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">)(</span>
                <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_attribute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">args</span>
            <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_a_1</span> <span class="o">=</span> <span class="n">prior</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="CBCSourceParameterDistribution.sample_a_2">
<a class="viewcode-back" href="../../../autoapi/ler/gw_source_population/cbc_source_parameter_distribution/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.sample_a_2">[docs]</a>
    <span class="k">def</span> <span class="nf">sample_a_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to sample spin magnitude of the compact binaries (body2) with the initialized prior.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        a_2 : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of spin magnitude of the compact binaries (body2)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_a_2</span></div>


    <span class="nd">@sample_a_2</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">sample_a_2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers_params</span><span class="p">[</span><span class="s2">&quot;a_2&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_a_2</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">)(</span>
                <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_attribute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">args</span>
            <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_a_2</span> <span class="o">=</span> <span class="n">prior</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="CBCSourceParameterDistribution.sample_tilt_1">
<a class="viewcode-back" href="../../../autoapi/ler/gw_source_population/cbc_source_parameter_distribution/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.sample_tilt_1">[docs]</a>
    <span class="k">def</span> <span class="nf">sample_tilt_1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to sample tilt angle of the compact binaries (body1) with the initialized prior.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        tilt_1 : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of tilt angle of the compact binaries (body1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_tilt_1</span></div>


    <span class="nd">@sample_tilt_1</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">sample_tilt_1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers_params</span><span class="p">[</span><span class="s2">&quot;tilt_1&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_tilt_1</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">)(</span>
                <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_attribute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">args</span>
            <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_tilt_1</span> <span class="o">=</span> <span class="n">prior</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="CBCSourceParameterDistribution.sample_tilt_2">
<a class="viewcode-back" href="../../../autoapi/ler/gw_source_population/cbc_source_parameter_distribution/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.sample_tilt_2">[docs]</a>
    <span class="k">def</span> <span class="nf">sample_tilt_2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to sample tilt angle of the compact binaries (body2) with the initialized prior.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        tilt_2 : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of tilt angle of the compact binaries (body2)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_tilt_2</span></div>


    <span class="nd">@sample_tilt_2</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">sample_tilt_2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers_params</span><span class="p">[</span><span class="s2">&quot;tilt_2&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_tilt_2</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">)(</span>
                <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_attribute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">args</span>
            <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_tilt_2</span> <span class="o">=</span> <span class="n">prior</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="CBCSourceParameterDistribution.sample_phi_12">
<a class="viewcode-back" href="../../../autoapi/ler/gw_source_population/cbc_source_parameter_distribution/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.sample_phi_12">[docs]</a>
    <span class="k">def</span> <span class="nf">sample_phi_12</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to sample azimuthal angle between the two spins with the initialized prior.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        phi_12 : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of azimuthal angle between the two spins</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_phi_12</span></div>


    <span class="nd">@sample_phi_12</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">sample_phi_12</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers_params</span><span class="p">[</span><span class="s2">&quot;phi_12&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_phi_12</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">)(</span>
                <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_attribute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">args</span>
            <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_phi_12</span> <span class="o">=</span> <span class="n">prior</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="CBCSourceParameterDistribution.sample_phi_jl">
<a class="viewcode-back" href="../../../autoapi/ler/gw_source_population/cbc_source_parameter_distribution/index.html#ler.gw_source_population.cbc_source_parameter_distribution.CBCSourceParameterDistribution.sample_phi_jl">[docs]</a>
    <span class="k">def</span> <span class="nf">sample_phi_jl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to sample azimuthal angle between the total angular momentum and the orbital angular momentum with the initialized prior.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : `int`</span>
<span class="sd">            Number of samples to draw</span>

<span class="sd">        Returns</span>
<span class="sd">        ----------</span>
<span class="sd">        phi_jl : `numpy.ndarray` (1D array of floats)</span>
<span class="sd">            Array of azimuthal angle between the total angular momentum and the orbital angular momentum</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sample_phi_jl</span></div>


    <span class="nd">@sample_phi_jl</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">sample_phi_jl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gw_param_samplers_params</span><span class="p">[</span><span class="s2">&quot;phi_jl&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_phi_jl</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior</span><span class="p">)(</span>
                <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_attribute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">args</span>
            <span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sample_phi_jl</span> <span class="o">=</span> <span class="n">prior</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Phurailatpam Hemantakumar.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>