

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ler.lens_galaxy_population.lens_galaxy_parameter_distribution &mdash; ler 0.5.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../_static/scalefix.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=776609e1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/dark_mode_css/general.css?v=c0a7eb24" />
      <link rel="stylesheet" type="text/css" href="../../../_static/dark_mode_css/dark.css?v=70edf1c7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=8e576371"></script>
      <script src="../../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="../../../_static/dark_mode_js/default_light.js?v=c2e647ce"></script>
      <script src="../../../_static/dark_mode_js/theme_switcher.js?v=358d3910"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980b9" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            ler
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Summary.html">Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../code_overview.html">Code overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../GW_events.html">Gravitational wave event rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analytical_formulation_unlensed.html">Analytical Formulation for Gravitational Wave Event Rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analytical_formulation_unlensed.html#id1">Analytical Formulation for Gravitational Wave Event Rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Lensed_events.html">Lensed event rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Lensed_equations.html">Lensed event sampling (Analytical formulation)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/ler/rates/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.rates</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/ler/gw_source_population/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.gw_source_population</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/ler/lens_galaxy_population/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.lens_galaxy_population</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/ler/image_properties/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.image_properties</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/ler/utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.utils</span></code></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/LeR_short_examples.html">LeR Short Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/GWRATES_complete_examples.html">GWRATES complete example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/LeR_custom_functions.html">LeR with Custom Functions and Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/LeR_advanced_sampling.html">LeR Advanced Sampling â€” Generating Detectable Events</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980b9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ler</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">ler.lens_galaxy_population.lens_galaxy_parameter_distribution</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for ler.lens_galaxy_population.lens_galaxy_parameter_distribution</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module for lens galaxy parameter distributions.</span>

<span class="sd">This module contains the ``LensGalaxyParameterDistribution`` class which samples</span>
<span class="sd">lens galaxy parameters and source parameters conditioned on the source being</span>
<span class="sd">strongly lensed. It handles the distribution of lens parameters such as velocity</span>
<span class="sd">dispersion, axis ratio, rotation angle, shear, and density profile slope.</span>

<span class="sd">Inheritance hierarchy:</span>

<span class="sd">- :class:`~ler.gw_source_population.CBCSourceParameterDistribution` \n</span>
<span class="sd">- :class:`~ler.image_properties.ImageProperties` \n</span>
<span class="sd">- :class:`~ler.lens_galaxy_population.OpticalDepth` \n</span>

<span class="sd">Usage:</span>
<span class="sd">    Basic workflow example:</span>

<span class="sd">    &gt;&gt;&gt; from ler.lens_galaxy_population import LensGalaxyParameterDistribution</span>
<span class="sd">    &gt;&gt;&gt; lens = LensGalaxyParameterDistribution()</span>
<span class="sd">    &gt;&gt;&gt; lensed_params = lens.sample_lens_parameters(size=1000)</span>
<span class="sd">    &gt;&gt;&gt; print(lensed_params.keys())</span>

<span class="sd">Copyright (C) 2026 Phurailatpam Hemantakumar. Distributed under MIT License.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">njit</span>

<span class="kn">from</span> <span class="nn">.optical_depth</span> <span class="kn">import</span> <span class="n">OpticalDepth</span>
<span class="kn">from</span> <span class="nn">.sampler_functions</span> <span class="kn">import</span> <span class="n">_njit_checks</span>

<span class="kn">from</span> <span class="nn">..gw_source_population</span> <span class="kn">import</span> <span class="n">CBCSourceParameterDistribution</span>
<span class="kn">from</span> <span class="nn">..image_properties</span> <span class="kn">import</span> <span class="n">ImageProperties</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="LensGalaxyParameterDistribution">
<a class="viewcode-back" href="../../../autoapi/ler/rates/index.html#ler.lens_galaxy_population.LensGalaxyParameterDistribution">[docs]</a>
<span class="k">class</span> <span class="nc">LensGalaxyParameterDistribution</span><span class="p">(</span><span class="n">CBCSourceParameterDistribution</span><span class="p">,</span> <span class="n">ImageProperties</span><span class="p">,</span> <span class="n">OpticalDepth</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sample lens galaxy parameters conditioned on strong lensing.</span>

<span class="sd">    This class handles the distribution of lens galaxy parameters such as velocity</span>
<span class="sd">    dispersion, axis ratio, axis rotation angle, shear, and density profile slope.</span>
<span class="sd">    It samples source parameters conditioned on the source being strongly lensed</span>
<span class="sd">    using cross-section based rejection or importance sampling.</span>

<span class="sd">    Key Features: \n</span>
<span class="sd">    - Samples lens parameters using EPL+shear galaxy model \n</span>
<span class="sd">    - Supports rejection and importance sampling based on cross-section \n</span>
<span class="sd">    - Computes optical depth weighted source redshift distributions \n</span>
<span class="sd">    - Integrates with GW source population and image property calculations \n</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npool : ``int``</span>
<span class="sd">        Number of processors to use for parallel sampling. \n</span>
<span class="sd">        default: 4</span>
<span class="sd">    z_min : ``float``</span>
<span class="sd">        Minimum redshift for source and lens populations. \n</span>
<span class="sd">        default: 0.0</span>
<span class="sd">    z_max : ``float``</span>
<span class="sd">        Maximum redshift for source and lens populations. \n</span>
<span class="sd">        default: 10.0</span>
<span class="sd">    cosmology : ``astropy.cosmology`` or ``None``</span>
<span class="sd">        Cosmology object for distance calculations. \n</span>
<span class="sd">        default: None (uses FlatLambdaCDM with H0=70, Om0=0.3)</span>
<span class="sd">    event_type : ``str``</span>
<span class="sd">        Type of compact binary coalescence event. \n</span>
<span class="sd">        Options: \n</span>
<span class="sd">        - &#39;BBH&#39;: Binary black hole \n</span>
<span class="sd">        - &#39;BNS&#39;: Binary neutron star \n</span>
<span class="sd">        - &#39;NSBH&#39;: Neutron star-black hole \n</span>
<span class="sd">        default: &#39;BBH&#39;</span>
<span class="sd">    lens_type : ``str``</span>
<span class="sd">        Type of lens galaxy model to use. \n</span>
<span class="sd">        default: &#39;epl_shear_galaxy&#39;</span>
<span class="sd">    lens_functions : ``dict`` or ``None``</span>
<span class="sd">        Dictionary specifying lens-related functions. \n</span>
<span class="sd">        default: None (uses defaults from OpticalDepth)</span>
<span class="sd">    lens_functions_params : ``dict`` or ``None``</span>
<span class="sd">        Parameters for lens functions. \n</span>
<span class="sd">        default: None</span>
<span class="sd">    lens_param_samplers : ``dict`` or ``None``</span>
<span class="sd">        Dictionary specifying lens parameter sampling functions. \n</span>
<span class="sd">        default: None (uses defaults from OpticalDepth)</span>
<span class="sd">    lens_param_samplers_params : ``dict`` or ``None``</span>
<span class="sd">        Parameters for lens parameter samplers. \n</span>
<span class="sd">        default: None</span>
<span class="sd">    directory : ``str``</span>
<span class="sd">        Directory for storing interpolator files. \n</span>
<span class="sd">        default: &#39;./interpolator_json&#39;</span>
<span class="sd">    create_new_interpolator : ``bool``</span>
<span class="sd">        If True, recreates interpolators even if files exist. \n</span>
<span class="sd">        default: False</span>
<span class="sd">    buffer_size : ``int``</span>
<span class="sd">        Buffer size for batch sampling of lens parameters. \n</span>
<span class="sd">        default: 1000</span>
<span class="sd">    **kwargs : ``dict``</span>
<span class="sd">        Additional keyword arguments passed to parent classes: \n</span>
<span class="sd">        :class:`~ler.gw_source_population.CBCSourceParameterDistribution`, \n</span>
<span class="sd">        :class:`~ler.image_properties.ImageProperties`, \n</span>
<span class="sd">        :class:`~ler.lens_galaxy_population.OpticalDepth`.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Basic usage:</span>

<span class="sd">    &gt;&gt;&gt; from ler.lens_galaxy_population import LensGalaxyParameterDistribution</span>
<span class="sd">    &gt;&gt;&gt; lens = LensGalaxyParameterDistribution()</span>
<span class="sd">    &gt;&gt;&gt; lensed_params = lens.sample_lens_parameters(size=1000)</span>
<span class="sd">    &gt;&gt;&gt; print(lensed_params.keys())</span>


<span class="sd">    Instance Methods</span>
<span class="sd">    ----------</span>
<span class="sd">    LensGalaxyParameterDistribution has the following methods: \n</span>
<span class="sd">    +-----------------------------------------------------+------------------------------------------------+</span>
<span class="sd">    | Method                                              | Description                                    |</span>
<span class="sd">    +=====================================================+================================================+</span>
<span class="sd">    | :meth:`~sample_lens_parameters`                     | Sample lens and source parameters              |</span>
<span class="sd">    +-----------------------------------------------------+------------------------------------------------+</span>
<span class="sd">    | :meth:`~sample_all_routine_epl_shear_intrinsic`    | Sample EPL+shear lens parameters from intrinsic |</span>
<span class="sd">    |                                                     | distributions                                  |</span>
<span class="sd">    +-----------------------------------------------------+------------------------------------------------+</span>
<span class="sd">    | :meth:`~sample_all_routine_epl_shear_sl`            | Sample EPL+shear lens parameters with strong   |</span>
<span class="sd">    |                                                     | lensing condition                              |</span>
<span class="sd">    +-----------------------------------------------------+------------------------------------------------+</span>
<span class="sd">    | :meth:`~strongly_lensed_source_redshifts`           | Sample source redshifts with lensing condition |</span>
<span class="sd">    +-----------------------------------------------------+------------------------------------------------+</span>

<span class="sd">    Instance Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    LensGalaxyParameterDistribution has the following attributes: \n</span>
<span class="sd">    +------------------------------------------------+----------------------+-------+------------------------------------------------+</span>
<span class="sd">    | Attribute                                      | Type                 | Unit  | Description                                    |</span>
<span class="sd">    +================================================+======================+=======+================================================+</span>
<span class="sd">    | :attr:`~npool`                                 | ``int``              |       | Number of processors for parallel computation  |</span>
<span class="sd">    +------------------------------------------------+----------------------+-------+------------------------------------------------+</span>
<span class="sd">    | :attr:`~z_min`                                 | ``float``            |       | Minimum redshift                               |</span>
<span class="sd">    +------------------------------------------------+----------------------+-------+------------------------------------------------+</span>
<span class="sd">    | :attr:`~z_max`                                 | ``float``            |       | Maximum redshift                               |</span>
<span class="sd">    +------------------------------------------------+----------------------+-------+------------------------------------------------+</span>
<span class="sd">    | :attr:`~cosmo`                                 | ``astropy.cosmology``|       | Cosmology object for calculations              |</span>
<span class="sd">    +------------------------------------------------+----------------------+-------+------------------------------------------------+</span>
<span class="sd">    | :attr:`~event_type`                            | ``str``              |       | Type of CBC event (BBH, BNS, NSBH)             |</span>
<span class="sd">    +------------------------------------------------+----------------------+-------+------------------------------------------------+</span>
<span class="sd">    | :attr:`~directory`                             | ``str``              |       | Path to interpolator storage directory         |</span>
<span class="sd">    +------------------------------------------------+----------------------+-------+------------------------------------------------+</span>
<span class="sd">    | :attr:`~lens_param_samplers`                   | ``dict``             |       | Dictionary of lens parameter sampler names     |</span>
<span class="sd">    +------------------------------------------------+----------------------+-------+------------------------------------------------+</span>
<span class="sd">    | :attr:`~lens_param_samplers_params`            | ``dict``             |       | Parameters for lens parameter samplers         |</span>
<span class="sd">    +------------------------------------------------+----------------------+-------+------------------------------------------------+</span>
<span class="sd">    | :attr:`~lens_functions`                        | ``dict``             |       | Dictionary of lens function names              |</span>
<span class="sd">    +------------------------------------------------+----------------------+-------+------------------------------------------------+</span>
<span class="sd">    | :attr:`~normalization_pdf_z_lensed`            | ``float``            |       | Normalization constant for lensed source z pdf |</span>
<span class="sd">    +------------------------------------------------+----------------------+-------+------------------------------------------------+</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">npool</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
        <span class="n">z_min</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">z_max</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
        <span class="n">cosmology</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">event_type</span><span class="o">=</span><span class="s2">&quot;BBH&quot;</span><span class="p">,</span>
        <span class="n">lens_type</span><span class="o">=</span><span class="s2">&quot;epl_shear_galaxy&quot;</span><span class="p">,</span>
        <span class="n">lens_functions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">lens_functions_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">lens_param_samplers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">lens_param_samplers_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">directory</span><span class="o">=</span><span class="s2">&quot;./interpolator_json&quot;</span><span class="p">,</span>
        <span class="n">create_new_interpolator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">buffer_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Initializing LensGalaxyParameterDistribution class...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<div class="viewcode-block" id="LensGalaxyParameterDistribution.event_type">
<a class="viewcode-back" href="../../../autoapi/ler/lens_galaxy_population/lens_galaxy_parameter_distribution/index.html#ler.lens_galaxy_population.LensGalaxyParameterDistribution.event_type">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">event_type</span> <span class="o">=</span> <span class="n">event_type</span></div>


        <span class="c1"># Initialize parent classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_class_initialization_lens</span><span class="p">(</span>
            <span class="n">npool</span><span class="p">,</span>
            <span class="n">z_min</span><span class="p">,</span>
            <span class="n">z_max</span><span class="p">,</span>
            <span class="n">cosmology</span><span class="p">,</span>
            <span class="n">lens_type</span><span class="p">,</span>
            <span class="n">lens_functions</span><span class="p">,</span>
            <span class="n">lens_functions_params</span><span class="p">,</span>
            <span class="n">lens_param_samplers</span><span class="p">,</span>
            <span class="n">lens_param_samplers_params</span><span class="p">,</span>
            <span class="n">directory</span><span class="p">,</span>
            <span class="n">create_new_interpolator</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Function to sample source redshifts conditioned on strong lensing</span>
<div class="viewcode-block" id="LensGalaxyParameterDistribution.sample_source_redshift_sl">
<a class="viewcode-back" href="../../../autoapi/ler/lens_galaxy_population/lens_galaxy_parameter_distribution/index.html#ler.lens_galaxy_population.LensGalaxyParameterDistribution.sample_source_redshift_sl">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_source_redshift_sl</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lens_param_samplers</span><span class="p">[</span><span class="s2">&quot;source_redshift_sl&quot;</span><span class="p">])</span></div>


        <span class="c1"># Function to sample lens parameters</span>
<div class="viewcode-block" id="LensGalaxyParameterDistribution.sample_lens_parameters_routine">
<a class="viewcode-back" href="../../../autoapi/ler/lens_galaxy_population/lens_galaxy_parameter_distribution/index.html#ler.lens_galaxy_population.LensGalaxyParameterDistribution.sample_lens_parameters_routine">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_lens_parameters_routine</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lens_functions</span><span class="p">[</span><span class="s2">&quot;param_sampler_type&quot;</span><span class="p">])</span></div>


        <span class="c1"># Function to select lens parameters conditioned on strong lensing</span>
<div class="viewcode-block" id="LensGalaxyParameterDistribution.cross_section_based_sampler">
<a class="viewcode-back" href="../../../autoapi/ler/lens_galaxy_population/lens_galaxy_parameter_distribution/index.html#ler.lens_galaxy_population.LensGalaxyParameterDistribution.cross_section_based_sampler">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">cross_section_based_sampler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initialization_cross_section_sampler</span><span class="p">()</span></div>


        <span class="c1"># Compute normalization constant for lensed event pdf</span>
        <span class="k">def</span> <span class="nf">pdf_unnormalized_</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">merger_rate_density_detector_frame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">z</span><span class="p">]))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">optical_depth</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">z</span><span class="p">]))</span>

        <span class="k">def</span> <span class="nf">pdf_unnormalized</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">pdf_unnormalized_</span><span class="p">(</span><span class="n">z</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">normalization_pdf_z_lensed</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">quad</span><span class="p">(</span>
            <span class="n">pdf_unnormalized</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">z_min</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">z_max</span>
        <span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_initialization_cross_section_sampler</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the cross-section based lens parameter sampler.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        cross_section_based_sampler : ``callable``</span>
<span class="sd">            Function that samples lens parameters weighted by cross-section.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get random variable samplers from initialized objects</span>
        <span class="n">sigma_rvs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_dispersion</span><span class="o">.</span><span class="n">rvs</span>
        <span class="n">q_rvs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis_ratio</span><span class="o">.</span><span class="n">rvs</span>
        <span class="n">phi_rvs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis_rotation_angle</span><span class="o">.</span><span class="n">rvs</span>
        <span class="n">gamma_rvs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density_profile_slope</span><span class="o">.</span><span class="n">rvs</span>
        <span class="n">shear_rvs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_shear</span><span class="o">.</span><span class="n">rvs</span>
        <span class="n">sigma_pdf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_dispersion</span><span class="o">.</span><span class="n">pdf</span>
        <span class="n">number_density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_dispersion</span><span class="o">.</span><span class="n">function</span>
        <span class="n">cross_section_function</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross_section</span>


        <span class="k">if</span> <span class="n">cross_section_function</span><span class="o">.</span><span class="vm">__code__</span><span class="o">.</span><span class="n">co_argcount</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span> <span class="c1"># sie or sis cross-section</span>
            <span class="n">gamma_rvs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density_profile_slope_sl</span><span class="o">.</span><span class="n">rvs</span>
            <span class="n">shear_rvs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_shear_sl</span><span class="o">.</span><span class="n">rvs</span>
            <span class="c1"># not yet implemented</span>
            <span class="c1"># q_rvs = self.axis_ratio_sl.rvs</span>
            <span class="c1"># phi_rvs = self.axis_rotation_angle_sl.rvs</span>
            
        <span class="n">use_njit_sampler</span><span class="p">,</span> <span class="n">dict_</span> <span class="o">=</span> <span class="n">_njit_checks</span><span class="p">(</span><span class="n">sigma_rvs</span><span class="p">,</span> <span class="n">q_rvs</span><span class="p">,</span> <span class="n">phi_rvs</span><span class="p">,</span> <span class="n">gamma_rvs</span><span class="p">,</span> <span class="n">shear_rvs</span><span class="p">,</span> <span class="n">sigma_pdf</span><span class="p">,</span> <span class="n">number_density</span><span class="p">,</span> <span class="n">cross_section_function</span><span class="p">)</span>

        <span class="n">sigma_rvs</span> <span class="o">=</span> <span class="n">dict_</span><span class="p">[</span><span class="s1">&#39;sigma_rvs&#39;</span><span class="p">]</span>
        <span class="n">sigma_pdf</span> <span class="o">=</span> <span class="n">dict_</span><span class="p">[</span><span class="s1">&#39;sigma_pdf&#39;</span><span class="p">]</span>
        <span class="n">q_rvs</span> <span class="o">=</span> <span class="n">dict_</span><span class="p">[</span><span class="s1">&#39;q_rvs&#39;</span><span class="p">]</span>
        <span class="n">phi_rvs</span> <span class="o">=</span> <span class="n">dict_</span><span class="p">[</span><span class="s1">&#39;phi_rvs&#39;</span><span class="p">]</span>
        <span class="n">gamma_rvs</span> <span class="o">=</span> <span class="n">dict_</span><span class="p">[</span><span class="s1">&#39;gamma_rvs&#39;</span><span class="p">]</span>
        <span class="n">shear_rvs</span> <span class="o">=</span> <span class="n">dict_</span><span class="p">[</span><span class="s1">&#39;shear_rvs&#39;</span><span class="p">]</span>
        <span class="n">cross_section_function</span> <span class="o">=</span> <span class="n">dict_</span><span class="p">[</span><span class="s1">&#39;cross_section_function&#39;</span><span class="p">]</span>

        <span class="n">sigma_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lens_param_samplers_params</span><span class="p">[</span><span class="s2">&quot;velocity_dispersion&quot;</span><span class="p">][</span><span class="s2">&quot;sigma_max&quot;</span><span class="p">]</span>

        <span class="c1"># Choose sampling method based on configuration</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lens_functions</span><span class="p">[</span><span class="s2">&quot;cross_section_based_sampler&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;rejection_sampling_with_cross_section&quot;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">.sampler_functions</span> <span class="kn">import</span> <span class="n">create_rejection_sampler</span>
            <span class="n">safety_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lens_functions_params</span><span class="p">[</span><span class="s2">&quot;cross_section_based_sampler&quot;</span><span class="p">][</span><span class="s2">&quot;safety_factor&quot;</span><span class="p">]</span>

            <span class="n">cross_section_based_sampler</span> <span class="o">=</span> <span class="n">create_rejection_sampler</span><span class="p">(</span>
                <span class="n">sigma_max</span><span class="o">=</span><span class="n">sigma_max</span><span class="p">,</span>
                <span class="n">sigma_rvs</span><span class="o">=</span><span class="n">sigma_rvs</span><span class="p">,</span>
                <span class="n">q_rvs</span><span class="o">=</span><span class="n">q_rvs</span><span class="p">,</span>
                <span class="n">phi_rvs</span><span class="o">=</span><span class="n">phi_rvs</span><span class="p">,</span>
                <span class="n">gamma_rvs</span><span class="o">=</span><span class="n">gamma_rvs</span><span class="p">,</span>
                <span class="n">shear_rvs</span><span class="o">=</span><span class="n">shear_rvs</span><span class="p">,</span>
                <span class="n">cross_section</span><span class="o">=</span><span class="n">cross_section_function</span><span class="p">,</span>
                <span class="n">safety_factor</span><span class="o">=</span><span class="n">safety_factor</span><span class="p">,</span>
                <span class="n">use_njit_sampler</span><span class="o">=</span><span class="n">use_njit_sampler</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">lens_functions</span><span class="p">[</span><span class="s2">&quot;cross_section_based_sampler&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;importance_sampling_with_cross_section&quot;</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">.sampler_functions</span> <span class="kn">import</span> <span class="n">create_importance_sampler</span>
            <span class="n">sigma_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lens_param_samplers_params</span><span class="p">[</span><span class="s2">&quot;velocity_dispersion&quot;</span><span class="p">][</span><span class="s2">&quot;sigma_min&quot;</span><span class="p">]</span>
            <span class="n">n_prop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lens_functions_params</span><span class="p">[</span><span class="s2">&quot;cross_section_based_sampler&quot;</span><span class="p">][</span><span class="s2">&quot;n_prop&quot;</span><span class="p">]</span>
            <span class="n">cross_section_based_sampler</span> <span class="o">=</span> <span class="n">create_importance_sampler</span><span class="p">(</span>
                <span class="n">sigma_min</span><span class="o">=</span><span class="n">sigma_min</span><span class="p">,</span>
                <span class="n">sigma_max</span><span class="o">=</span><span class="n">sigma_max</span><span class="p">,</span>
                <span class="n">q_rvs</span><span class="o">=</span><span class="n">q_rvs</span><span class="p">,</span>
                <span class="n">phi_rvs</span><span class="o">=</span><span class="n">phi_rvs</span><span class="p">,</span>
                <span class="n">gamma_rvs</span><span class="o">=</span><span class="n">gamma_rvs</span><span class="p">,</span>
                <span class="n">shear_rvs</span><span class="o">=</span><span class="n">shear_rvs</span><span class="p">,</span>
                <span class="n">sigma_pdf</span><span class="o">=</span><span class="n">sigma_pdf</span><span class="p">,</span>
                <span class="n">cross_section</span><span class="o">=</span><span class="n">cross_section_function</span><span class="p">,</span>
                <span class="n">n_prop</span><span class="o">=</span><span class="n">n_prop</span><span class="p">,</span>
                <span class="n">use_njit_sampler</span><span class="o">=</span><span class="n">use_njit_sampler</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid cross_section_based_sampler&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">cross_section_based_sampler</span>

    <span class="k">def</span> <span class="nf">_class_initialization_lens</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">npool</span><span class="p">,</span>
        <span class="n">z_min</span><span class="p">,</span>
        <span class="n">z_max</span><span class="p">,</span>
        <span class="n">cosmology</span><span class="p">,</span>
        <span class="n">lens_type</span><span class="p">,</span>
        <span class="n">lens_functions</span><span class="p">,</span>
        <span class="n">lens_functions_params</span><span class="p">,</span>
        <span class="n">lens_param_samplers</span><span class="p">,</span>
        <span class="n">lens_param_samplers_params</span><span class="p">,</span>
        <span class="n">directory</span><span class="p">,</span>
        <span class="n">create_new_interpolator</span><span class="p">,</span>
        <span class="n">params</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize parent classes for lens galaxy parameter distribution.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        npool : ``int``</span>
<span class="sd">            Number of processors for parallel sampling.</span>
<span class="sd">        z_min : ``float``</span>
<span class="sd">            Minimum redshift.</span>
<span class="sd">        z_max : ``float``</span>
<span class="sd">            Maximum redshift.</span>
<span class="sd">        cosmology : ``astropy.cosmology`` or ``None``</span>
<span class="sd">            Cosmology object.</span>
<span class="sd">        lens_type : ``str``</span>
<span class="sd">            Type of lens galaxy model.</span>
<span class="sd">        lens_functions : ``dict`` or ``None``</span>
<span class="sd">            Dictionary of lens function names.</span>
<span class="sd">        lens_functions_params : ``dict`` or ``None``</span>
<span class="sd">            Parameters for lens functions.</span>
<span class="sd">        lens_param_samplers : ``dict`` or ``None``</span>
<span class="sd">            Dictionary of lens parameter sampler names.</span>
<span class="sd">        lens_param_samplers_params : ``dict`` or ``None``</span>
<span class="sd">            Parameters for lens parameter samplers.</span>
<span class="sd">        directory : ``str``</span>
<span class="sd">            Directory for interpolator storage.</span>
<span class="sd">        create_new_interpolator : ``bool``</span>
<span class="sd">            Whether to recreate interpolators.</span>
<span class="sd">        params : ``dict``</span>
<span class="sd">            Additional parameters for parent classes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialize OpticalDepth class</span>
        <span class="n">OpticalDepth</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">npool</span><span class="o">=</span><span class="n">npool</span><span class="p">,</span>
            <span class="n">z_min</span><span class="o">=</span><span class="n">z_min</span><span class="p">,</span>
            <span class="n">z_max</span><span class="o">=</span><span class="n">z_max</span><span class="p">,</span>
            <span class="n">cosmology</span><span class="o">=</span><span class="n">cosmology</span><span class="p">,</span>
            <span class="n">lens_type</span><span class="o">=</span><span class="n">lens_type</span><span class="p">,</span>
            <span class="n">lens_functions</span><span class="o">=</span><span class="n">lens_functions</span><span class="p">,</span>
            <span class="n">lens_functions_params</span><span class="o">=</span><span class="n">lens_functions_params</span><span class="p">,</span>
            <span class="n">lens_param_samplers</span><span class="o">=</span><span class="n">lens_param_samplers</span><span class="p">,</span>
            <span class="n">lens_param_samplers_params</span><span class="o">=</span><span class="n">lens_param_samplers_params</span><span class="p">,</span>
            <span class="n">directory</span><span class="o">=</span><span class="n">directory</span><span class="p">,</span>
            <span class="n">create_new_interpolator</span><span class="o">=</span><span class="n">create_new_interpolator</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Initialize CBCSourceParameterDistribution class</span>
        <span class="n">input_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">source_priors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">source_priors_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">spin_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">spin_precession</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">input_params</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

        <span class="n">CBCSourceParameterDistribution</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">z_min</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z_min</span><span class="p">,</span>
            <span class="n">z_max</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">z_max</span><span class="p">,</span>
            <span class="n">event_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">event_type</span><span class="p">,</span>
            <span class="n">source_priors</span><span class="o">=</span><span class="n">input_params</span><span class="p">[</span><span class="s2">&quot;source_priors&quot;</span><span class="p">],</span>
            <span class="n">source_priors_params</span><span class="o">=</span><span class="n">input_params</span><span class="p">[</span><span class="s2">&quot;source_priors_params&quot;</span><span class="p">],</span>
            <span class="n">spin_zero</span><span class="o">=</span><span class="n">input_params</span><span class="p">[</span><span class="s2">&quot;spin_zero&quot;</span><span class="p">],</span>
            <span class="n">cosmology</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cosmo</span><span class="p">,</span>
            <span class="n">spin_precession</span><span class="o">=</span><span class="n">input_params</span><span class="p">[</span><span class="s2">&quot;spin_precession&quot;</span><span class="p">],</span>
            <span class="n">directory</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span><span class="p">,</span>
            <span class="n">create_new_interpolator</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">create_new_interpolator</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Initialize ImageProperties class</span>
        <span class="n">input_params_image</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">n_min_images</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">n_max_images</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
            <span class="n">time_window</span><span class="o">=</span><span class="mi">365</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">lens_model_list</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;EPL_NUMBA&quot;</span><span class="p">,</span> <span class="s2">&quot;SHEAR&quot;</span><span class="p">],</span>
            <span class="n">effective_params_in_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">input_params_image</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

        <span class="n">ImageProperties</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">npool</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">npool</span><span class="p">,</span>
            <span class="n">n_min_images</span><span class="o">=</span><span class="n">input_params_image</span><span class="p">[</span><span class="s2">&quot;n_min_images&quot;</span><span class="p">],</span>
            <span class="n">n_max_images</span><span class="o">=</span><span class="n">input_params_image</span><span class="p">[</span><span class="s2">&quot;n_max_images&quot;</span><span class="p">],</span>
            <span class="n">lens_model_list</span><span class="o">=</span><span class="n">input_params_image</span><span class="p">[</span><span class="s2">&quot;lens_model_list&quot;</span><span class="p">],</span>
            <span class="n">cosmology</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cosmo</span><span class="p">,</span>
            <span class="n">time_window</span><span class="o">=</span><span class="n">input_params_image</span><span class="p">[</span><span class="s2">&quot;time_window&quot;</span><span class="p">],</span>
            <span class="n">spin_zero</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">spin_zero</span><span class="p">,</span>
            <span class="n">spin_precession</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">spin_precession</span><span class="p">,</span>
            <span class="n">effective_params_in_output</span><span class="o">=</span><span class="n">input_params_image</span><span class="p">[</span><span class="s2">&quot;effective_params_in_output&quot;</span><span class="p">],</span>
        <span class="p">)</span>

<div class="viewcode-block" id="LensGalaxyParameterDistribution.sample_lens_parameters">
<a class="viewcode-back" href="../../../autoapi/ler/rates/index.html#ler.lens_galaxy_population.LensGalaxyParameterDistribution.sample_lens_parameters">[docs]</a>
    <span class="k">def</span> <span class="nf">sample_lens_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sample lens galaxy and source parameters conditioned on strong lensing.</span>

<span class="sd">        This method samples both lens galaxy parameters (velocity dispersion, axis</span>
<span class="sd">        ratio, shear, etc.) and gravitational wave source parameters, with the</span>
<span class="sd">        source redshift distribution weighted by strong lensing optical depth.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : ``int``</span>
<span class="sd">            Number of lens-source parameter sets to sample. \n</span>
<span class="sd">            default: 1000</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        lens_parameters : ``dict``</span>
<span class="sd">            Dictionary containing sampled lens and source parameters. \n</span>
<span class="sd">            The included parameters and their units are as follows (for default settings):\n</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | Parameter                    | Units     | Description                                           |</span>
<span class="sd">            +==============================+===========+=======================================================+</span>
<span class="sd">            | zl                           |           | redshift of the lens                                  |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | zs                           |           | redshift of the source                                |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | sigma                        | km s^-1   | velocity dispersion                                   |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | q                            |           | axis ratio                                            |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | theta_E                      | radian    | Einstein radius                                       |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | phi                          | rad       | axis rotation angle. counter-clockwise from the       |</span>
<span class="sd">            |                              |           | positive x-axis (RA-like axis) to the major axis of   |</span>
<span class="sd">            |                              |           | the projected mass distribution.                      |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | gamma                        |           | density profile slope of EPL galaxy                   |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | gamma1                       |           | external shear component in the x-direction           |</span>
<span class="sd">            |                              |           | (RA-like axis)                                        |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | gamma2                       |           | external shear component in the y-direction           |</span>
<span class="sd">            |                              |           | (Dec-like axis)                                       |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | geocent_time                 | s         | geocent time                                          |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | ra                           | rad       | right ascension                                       |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | dec                          | rad       | declination                                           |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | phase                        | rad       | phase of GW at reference freq                         |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | psi                          | rad       | polarization angle                                    |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | theta_jn                     | rad       | inclination angle                                     |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | a_1                          |           | spin of the primary compact binary                    |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | a_2                          |           | spin of the secondary compact binary                  |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | luminosity_distance          | Mpc       | luminosity distance of the source                      |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | mass_1_source                | Msun      | mass of the primary compact binary (source frame)     |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | mass_2_source                | Msun      | mass of the secondary compact binary (source frame)   |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | mass_1                       | Msun      | mass of the primary compact binary (detector frame)   |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | mass_2                       | Msun      | mass of the secondary compact binary (detector frame) |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            </span>
<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from ler.lens_galaxy_population import LensGalaxyParameterDistribution</span>
<span class="sd">        &gt;&gt;&gt; lens = LensGalaxyParameterDistribution()</span>
<span class="sd">        &gt;&gt;&gt; params = lens.sample_lens_parameters(size=1000)</span>
<span class="sd">        &gt;&gt;&gt; print(params.keys())</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sampling lens parameters with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lens_functions</span><span class="p">[</span><span class="s1">&#39;param_sampler_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

        <span class="c1"># Sample lens parameters with strong lensing condition</span>
        <span class="n">lens_parameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_lens_parameters_routine</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>

        <span class="c1"># Sample GW source parameters (zs already sampled)</span>
        <span class="n">param</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">zs</span><span class="o">=</span><span class="n">lens_parameters</span><span class="p">[</span><span class="s2">&quot;zs&quot;</span><span class="p">])</span>
        <span class="n">gw_param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_gw_parameters</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">param</span><span class="p">)</span>

        <span class="c1"># Combine lens and source parameters</span>
        <span class="n">lens_parameters</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">gw_param</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">lens_parameters</span></div>


<div class="viewcode-block" id="LensGalaxyParameterDistribution.sample_all_routine_epl_shear_sl">
<a class="viewcode-back" href="../../../autoapi/ler/rates/index.html#ler.lens_galaxy_population.LensGalaxyParameterDistribution.sample_all_routine_epl_shear_sl">[docs]</a>
    <span class="k">def</span> <span class="nf">sample_all_routine_epl_shear_sl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sample EPL+shear galaxy lens parameters with strong lensing condition.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : ``int``</span>
<span class="sd">            Number of lens parameters to sample. \n</span>
<span class="sd">            default: 1000</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        lens_parameters : ``dict``</span>
<span class="sd">            Dictionary of sampled lens parameters. \n</span>
<span class="sd">            The included parameters and their units are as follows (for default settings):\n</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | Parameter                    | Units     | Description                                           |</span>
<span class="sd">            +==============================+===========+=======================================================+</span>
<span class="sd">            | zl                           |           | redshift of the lens                                  |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | zs                           |           | redshift of the source                                |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | sigma                        | km s^-1   | velocity dispersion                                   |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | q                            |           | axis ratio                                            |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | theta_E                      | radian    | Einstein radius                                       |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | phi                          | rad       | axis rotation angle. counter-clockwise from the       |</span>
<span class="sd">            |                              |           | positive x-axis (RA-like axis) to the major axis of   |</span>
<span class="sd">            |                              |           | the projected mass distribution.                      |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | gamma                        |           | density profile slope of EPL galaxy                   |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | gamma1                       |           | external shear component in the x-direction           |</span>
<span class="sd">            |                              |           | (RA-like axis)                                        |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | gamma2                       |           | external shear component in the y-direction           |</span>
<span class="sd">            |                              |           | (Dec-like axis)                                       |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Sample source redshift with strong lensing weighting</span>
        <span class="n">zs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_source_redshift_sl</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

        <span class="c1"># Sample lens redshift conditioned on source redshift</span>
        <span class="n">zl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lens_redshift</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">zs</span><span class="p">)</span>

        <span class="c1"># Sample other lens parameters using cross-section based sampler</span>
        <span class="n">sigma</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">gamma1</span><span class="p">,</span> <span class="n">gamma2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cross_section_based_sampler</span><span class="p">(</span><span class="n">zs</span><span class="p">,</span> <span class="n">zl</span><span class="p">)</span>

        <span class="n">lens_parameters</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;zl&quot;</span><span class="p">:</span> <span class="n">zl</span><span class="p">,</span>
            <span class="s2">&quot;zs&quot;</span><span class="p">:</span> <span class="n">zs</span><span class="p">,</span>
            <span class="s2">&quot;sigma&quot;</span><span class="p">:</span> <span class="n">sigma</span><span class="p">,</span>
            <span class="s2">&quot;theta_E&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_einstein_radii</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">zl</span><span class="p">,</span> <span class="n">zs</span><span class="p">),</span>
            <span class="s2">&quot;q&quot;</span><span class="p">:</span> <span class="n">q</span><span class="p">,</span>
            <span class="s2">&quot;phi&quot;</span><span class="p">:</span> <span class="n">phi</span><span class="p">,</span>
            <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="n">gamma</span><span class="p">,</span>
            <span class="s2">&quot;gamma1&quot;</span><span class="p">:</span> <span class="n">gamma1</span><span class="p">,</span>
            <span class="s2">&quot;gamma2&quot;</span><span class="p">:</span> <span class="n">gamma2</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">lens_parameters</span></div>


<div class="viewcode-block" id="LensGalaxyParameterDistribution.strongly_lensed_source_redshifts">
<a class="viewcode-back" href="../../../autoapi/ler/rates/index.html#ler.lens_galaxy_population.LensGalaxyParameterDistribution.strongly_lensed_source_redshifts">[docs]</a>
    <span class="k">def</span> <span class="nf">strongly_lensed_source_redshifts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sample source redshifts conditioned on strong lensing.</span>

<span class="sd">        Uses rejection sampling to generate source redshifts from the CBC source</span>
<span class="sd">        population weighted by the optical depth, which increases with redshift.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : ``int``</span>
<span class="sd">            Number of redshifts to sample. \n</span>
<span class="sd">            default: 1000</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        redshifts : ``numpy.ndarray``</span>
<span class="sd">            Array of source redshifts conditioned on strong lensing.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from ler.lens_galaxy_population import LensGalaxyParameterDistribution</span>
<span class="sd">        &gt;&gt;&gt; lens = LensGalaxyParameterDistribution()</span>
<span class="sd">        &gt;&gt;&gt; zs = lens.strongly_lensed_source_redshifts(size=1000)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;Mean source redshift: {zs.mean():.2f}&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">z_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_max</span>

        <span class="k">def</span> <span class="nf">zs_function</span><span class="p">(</span><span class="n">zs_sl</span><span class="p">):</span>
            <span class="c1"># Sample from source population</span>
            <span class="n">zs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zs</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

            <span class="c1"># Apply optical depth weighting</span>
            <span class="n">tau</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optical_depth</span><span class="p">(</span><span class="n">zs</span><span class="p">)</span>
            <span class="n">tau_max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optical_depth</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">z_max</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>

            <span class="c1"># Rejection sampling</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tau_max</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">zs</span><span class="p">))</span>
            <span class="n">zs_sl</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="n">zs</span><span class="p">[</span><span class="n">r</span> <span class="o">&lt;</span> <span class="n">tau</span><span class="p">])</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zs_sl</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">size</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">zs_sl</span><span class="p">[:</span><span class="n">size</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">zs_function</span><span class="p">(</span><span class="n">zs_sl</span><span class="p">)</span>

        <span class="n">zs_sl</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zs_function</span><span class="p">(</span><span class="n">zs_sl</span><span class="p">))</span></div>


<div class="viewcode-block" id="LensGalaxyParameterDistribution.sample_all_routine_epl_shear_intrinsic">
<a class="viewcode-back" href="../../../autoapi/ler/rates/index.html#ler.lens_galaxy_population.LensGalaxyParameterDistribution.sample_all_routine_epl_shear_intrinsic">[docs]</a>
    <span class="k">def</span> <span class="nf">sample_all_routine_epl_shear_intrinsic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sample EPL+shear galaxy lens parameters from intrinsic distributions.</span>

<span class="sd">        Samples lens parameters from their intrinsic distributions without</span>
<span class="sd">        applying strong lensing cross-section weighting.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : ``int``</span>
<span class="sd">            Number of lens parameters to sample. \n</span>
<span class="sd">            default: 1000</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        lens_parameters : ``dict``</span>
<span class="sd">            Dictionary of sampled lens parameters. \n</span>
<span class="sd">            The included parameters and their units are as follows (for default settings):\n</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | Parameter                    | Units     | Description                                           |</span>
<span class="sd">            +==============================+===========+=======================================================+</span>
<span class="sd">            | zl                           |           | redshift of the lens                                  |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | zs                           |           | redshift of the source                                |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | sigma                        | km s^-1   | velocity dispersion                                   |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | q                            |           | axis ratio                                            |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | theta_E                      | radian    | Einstein radius                                       |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | phi                          | rad       | axis rotation angle. counter-clockwise from the       |</span>
<span class="sd">            |                              |           | positive x-axis (RA-like axis) to the major axis of   |</span>
<span class="sd">            |                              |           | the projected mass distribution.                      |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | gamma                        |           | density profile slope of EPL galaxy                   |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | gamma1                       |           | external shear component in the x-direction           |</span>
<span class="sd">            |                              |           | (RA-like axis)                                        |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">            | gamma2                       |           | external shear component in the y-direction           |</span>
<span class="sd">            |                              |           | (Dec-like axis)                                       |</span>
<span class="sd">            +------------------------------+-----------+-------------------------------------------------------+</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Sample source redshift from intrinsic distribution</span>
        <span class="n">zs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zs</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

        <span class="c1"># Sample lens redshift</span>
        <span class="n">zl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lens_redshift_intrinsic</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z_max</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>

        <span class="c1"># Sample velocity dispersion</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_dispersion</span><span class="o">.</span><span class="n">conditioned_y_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_dispersion</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">zl</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity_dispersion</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

        <span class="c1"># Sample axis ratio</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis_ratio</span><span class="o">.</span><span class="n">conditioned_y_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis_ratio</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis_ratio</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

        <span class="c1"># Sample remaining parameters</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis_rotation_angle</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density_profile_slope</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
        <span class="n">gamma1</span><span class="p">,</span> <span class="n">gamma2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_shear</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

        <span class="n">lens_parameters</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;zl&quot;</span><span class="p">:</span> <span class="n">zl</span><span class="p">,</span>
            <span class="s2">&quot;zs&quot;</span><span class="p">:</span> <span class="n">zs</span><span class="p">,</span>
            <span class="s2">&quot;sigma&quot;</span><span class="p">:</span> <span class="n">sigma</span><span class="p">,</span>
            <span class="s2">&quot;q&quot;</span><span class="p">:</span> <span class="n">q</span><span class="p">,</span>
            <span class="s2">&quot;phi&quot;</span><span class="p">:</span> <span class="n">phi</span><span class="p">,</span>
            <span class="s2">&quot;gamma&quot;</span><span class="p">:</span> <span class="n">gamma</span><span class="p">,</span>
            <span class="s2">&quot;gamma1&quot;</span><span class="p">:</span> <span class="n">gamma1</span><span class="p">,</span>
            <span class="s2">&quot;gamma2&quot;</span><span class="p">:</span> <span class="n">gamma2</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">lens_parameters</span></div>


    <span class="c1"># -------------------------------------------------------------------------</span>
    <span class="c1"># Properties</span>
    <span class="c1"># -------------------------------------------------------------------------</span>
    <span class="nd">@property</span>
<div class="viewcode-block" id="LensGalaxyParameterDistribution.lens_param_samplers">
<a class="viewcode-back" href="../../../autoapi/ler/lens_galaxy_population/lens_galaxy_parameter_distribution/index.html#ler.lens_galaxy_population.LensGalaxyParameterDistribution.lens_param_samplers">[docs]</a>
    <span class="k">def</span> <span class="nf">lens_param_samplers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dictionary of lens parameter sampler function names.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        lens_param_samplers : ``dict``</span>
<span class="sd">            Dictionary mapping parameter names to sampler function names. \n</span>
<span class="sd">            Keys include: &#39;source_redshift_sl&#39;, &#39;lens_redshift&#39;, \n</span>
<span class="sd">            &#39;velocity_dispersion&#39;, &#39;axis_ratio&#39;, &#39;axis_rotation_angle&#39;, \n</span>
<span class="sd">            &#39;external_shear&#39;, &#39;density_profile_slope&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lens_param_samplers</span></div>


    <span class="nd">@lens_param_samplers</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">lens_param_samplers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lens_param_samplers</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="LensGalaxyParameterDistribution.lens_param_samplers_params">
<a class="viewcode-back" href="../../../autoapi/ler/lens_galaxy_population/lens_galaxy_parameter_distribution/index.html#ler.lens_galaxy_population.LensGalaxyParameterDistribution.lens_param_samplers_params">[docs]</a>
    <span class="k">def</span> <span class="nf">lens_param_samplers_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dictionary of parameters for lens parameter samplers.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        lens_param_samplers_params : ``dict``</span>
<span class="sd">            Dictionary with sampler parameters. \n</span>
<span class="sd">            Each key corresponds to a sampler in lens_param_samplers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lens_param_samplers_params</span></div>


    <span class="nd">@lens_param_samplers_params</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">lens_param_samplers_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lens_param_samplers_params</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="LensGalaxyParameterDistribution.lens_functions">
<a class="viewcode-back" href="../../../autoapi/ler/lens_galaxy_population/lens_galaxy_parameter_distribution/index.html#ler.lens_galaxy_population.LensGalaxyParameterDistribution.lens_functions">[docs]</a>
    <span class="k">def</span> <span class="nf">lens_functions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dictionary of lens-related function names.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        lens_functions : ``dict``</span>
<span class="sd">            Dictionary mapping function types to function names. \n</span>
<span class="sd">            Keys include: &#39;param_sampler_type&#39;, &#39;cross_section_based_sampler&#39;, \n</span>
<span class="sd">            &#39;optical_depth&#39;, &#39;cross_section&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lens_functions</span></div>


    <span class="nd">@lens_functions</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">lens_functions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lens_functions</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="LensGalaxyParameterDistribution.normalization_pdf_z_lensed">
<a class="viewcode-back" href="../../../autoapi/ler/lens_galaxy_population/lens_galaxy_parameter_distribution/index.html#ler.lens_galaxy_population.LensGalaxyParameterDistribution.normalization_pdf_z_lensed">[docs]</a>
    <span class="k">def</span> <span class="nf">normalization_pdf_z_lensed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Normalization constant for the lensed source redshift pdf.</span>

<span class="sd">        This constant is used to normalize the probability distribution \n</span>
<span class="sd">        of source redshifts conditioned on strong lensing. It is computed \n</span>
<span class="sd">        by integrating the merger rate density times optical depth.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        normalization_pdf_z_lensed : ``float``</span>
<span class="sd">            Normalization constant for lensed redshift distribution.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_normalization_pdf_z_lensed</span></div>


    <span class="nd">@normalization_pdf_z_lensed</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">normalization_pdf_z_lensed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_normalization_pdf_z_lensed</span> <span class="o">=</span> <span class="n">value</span></div>


</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Phurailatpam Hemantakumar.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>