

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ler.image_properties &mdash; ler 0.4.6 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../_static/scalefix.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=776609e1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/dark_mode_css/general.css?v=c0a7eb24" />
      <link rel="stylesheet" type="text/css" href="../../../_static/dark_mode_css/dark.css?v=70edf1c7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=03f3338f"></script>
      <script src="../../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="../../../_static/dark_mode_js/default_light.js?v=c2e647ce"></script>
      <script src="../../../_static/dark_mode_js/theme_switcher.js?v=358d3910"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="ler.image_properties.image_properties" href="image_properties/index.html" />
    <link rel="prev" title="ler.lens_galaxy_population.sampler_functions" href="../lens_galaxy_population/sampler_functions/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980b9" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            ler
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Summary.html">Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../code_overview.html">Code overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../GW_events.html">Gravitational wave event rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../GW_equations.html">Gravitational wave events sampling (Analytical formulation)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Lensed_events.html">Lensed event rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Lensed_equations.html">Lensed event sampling (Analytical formulation)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../rates/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.rates</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../gw_source_population/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.gw_source_population</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../lens_galaxy_population/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.lens_galaxy_population</span></code></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.image_properties</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="image_properties/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.image_properties.image_properties</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="multiprocessing_routine/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.image_properties.multiprocessing_routine</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#package-contents">Package Contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#classes">Classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#functions">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#attributes">Attributes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ler.image_properties.cosmo"><code class="docutils literal notranslate"><span class="pre">cosmo</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ler.image_properties.solve_lens_equation"><code class="docutils literal notranslate"><span class="pre">solve_lens_equation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ler.image_properties.phi_q2_ellipticity"><code class="docutils literal notranslate"><span class="pre">phi_q2_ellipticity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ler.image_properties.ImageProperties"><code class="docutils literal notranslate"><span class="pre">ImageProperties</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ler.image_properties.MAX_RETRIES"><code class="docutils literal notranslate"><span class="pre">MAX_RETRIES</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ler.image_properties.MIN_MAGNIFICATION"><code class="docutils literal notranslate"><span class="pre">MIN_MAGNIFICATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">solve_lens_equation()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.utils</span></code></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/LeR_short_examples.html">LeR Short Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/GWRATES_complete_examples.html">GWRATES complete example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/LeR_custom_functions.html">LeR with Custom Functions and Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/LeR_advanced_sampling.html">LeR Advanced Sampling — Generating Detectable Events</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980b9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ler</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.image_properties</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/autoapi/ler/image_properties/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-ler.image_properties">
<span id="ler-image-properties"></span><h1><a class="reference internal" href="#module-ler.image_properties" title="ler.image_properties"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.image_properties</span></code></a><a class="headerlink" href="#module-ler.image_properties" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="image_properties/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.image_properties.image_properties</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="multiprocessing_routine/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.image_properties.multiprocessing_routine</span></code></a></li>
</ul>
</div>
</section>
<section id="package-contents">
<h2>Package Contents<a class="headerlink" href="#package-contents" title="Link to this heading"></a></h2>
<section id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Link to this heading"></a></h3>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.image_properties.ImageProperties" title="ler.image_properties.ImageProperties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ImageProperties</span></code></a></p></td>
<td><p>Class to compute image properties of strongly lensed gravitational wave events.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Link to this heading"></a></h3>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#id0" title="ler.image_properties.solve_lens_equation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_lens_equation</span></code></a>(lens_parameters)</p></td>
<td><p>Solve the lens equation to find image properties.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.image_properties.phi_q2_ellipticity" title="ler.image_properties.phi_q2_ellipticity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">phi_q2_ellipticity</span></code></a>(phi, q)</p></td>
<td><p>Convert position angle and axis ratio to ellipticity components.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id0" title="ler.image_properties.solve_lens_equation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_lens_equation</span></code></a>(lens_parameters)</p></td>
<td><p>Solve the lens equation to find image properties.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="attributes">
<h3>Attributes<a class="headerlink" href="#attributes" title="Link to this heading"></a></h3>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.image_properties.cosmo" title="ler.image_properties.cosmo"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cosmo</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.image_properties.MAX_RETRIES" title="ler.image_properties.MAX_RETRIES"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MAX_RETRIES</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.image_properties.MIN_MAGNIFICATION" title="ler.image_properties.MIN_MAGNIFICATION"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MIN_MAGNIFICATION</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<dl class="py data">
<dt class="sig sig-object py" id="ler.image_properties.cosmo">
<span class="sig-prename descclassname"><span class="pre">ler.image_properties.</span></span><span class="sig-name descname"><span class="pre">cosmo</span></span><a class="reference internal" href="../../../_modules/ler/image_properties/image_properties.html#cosmo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.image_properties.cosmo" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ler.image_properties.solve_lens_equation">
<span class="sig-prename descclassname"><span class="pre">ler.image_properties.</span></span><span class="sig-name descname"><span class="pre">solve_lens_equation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lens_parameters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/image_properties/multiprocessing_routine.html#solve_lens_equation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.image_properties.solve_lens_equation" title="Link to this definition"></a></dt>
<dd><p>Solve the lens equation to find image properties.</p>
<p>Uses the analytical solver from lenstronomy to find image positions,
magnifications, time delays, and hessian properties for strongly
lensed sources. Source positions are sampled from within the caustic
region to ensure multiple imaging.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>lens_parameters</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of lens configuration parameters with the following structure:</p>
<ul class="simple">
<li><p>[0]: n_min_images - minimum number of images required</p></li>
<li><p>[1]: e1 - ellipticity component 1</p></li>
<li><p>[2]: e2 - ellipticity component 2</p></li>
<li><p>[3]: gamma - power-law slope of mass density</p></li>
<li><p>[4]: gamma1 - external shear component 1</p></li>
<li><p>[5]: gamma2 - external shear component 2</p></li>
<li><p>[6]: zl - lens redshift</p></li>
<li><p>[7]: zs - source redshift</p></li>
<li><p>[8]: einstein_radius - Einstein radius (units: arcsec)</p></li>
<li><p>[9]: iteration - iteration index for tracking</p></li>
<li><p>[10:]: lens_model_list - lens model names (e.g., ‘EPL_NUMBA’, ‘SHEAR’)</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>x_source</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Source x-position (units: arcsec).</p>
</dd>
<dt><strong>y_source</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Source y-position (units: arcsec).</p>
</dd>
<dt><strong>x0_image_position</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Image x-positions (units: arcsec).</p>
</dd>
<dt><strong>x1_image_position</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Image y-positions (units: arcsec).</p>
</dd>
<dt><strong>magnifications</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Magnification factors for each image.</p>
</dd>
<dt><strong>time_delays</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Time delays for each image (units: seconds).</p>
</dd>
<dt><strong>nImages</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of images formed.</p>
</dd>
<dt><strong>determinant</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Determinant of the lensing Jacobian for each image.</p>
</dd>
<dt><strong>trace</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Trace of the lensing Jacobian for each image.</p>
</dd>
<dt><strong>iteration</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Iteration index passed through for tracking.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler.image_properties.multiprocessing_routine</span> <span class="kn">import</span> <span class="n">solve_lens_equation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Pool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lens_parameters1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.024</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.016</span><span class="p">,</span> <span class="mf">1.89</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.94</span><span class="p">,</span> <span class="mf">2.5e-06</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;EPL_NUMBA&#39;</span><span class="p">,</span> <span class="s1">&#39;SHEAR&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lens_parameters2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.040</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.014</span><span class="p">,</span> <span class="mf">2.00</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">1.09</span><span class="p">,</span> <span class="mf">2.55</span><span class="p">,</span> <span class="mf">1.0e-06</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;EPL_NUMBA&#39;</span><span class="p">,</span> <span class="s1">&#39;SHEAR&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_arguments</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">lens_parameters1</span><span class="p">,</span> <span class="n">lens_parameters2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">result</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">solve_lens_equation</span><span class="p">,</span> <span class="n">input_arguments</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of images: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ler.image_properties.phi_q2_ellipticity">
<span class="sig-prename descclassname"><span class="pre">ler.image_properties.</span></span><span class="sig-name descname"><span class="pre">phi_q2_ellipticity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/lens_galaxy_population/lens_functions.html#phi_q2_ellipticity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.image_properties.phi_q2_ellipticity" title="Link to this definition"></a></dt>
<dd><p>Convert position angle and axis ratio to ellipticity components.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>phi</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Position angle of the major axis (radians).</p>
</dd>
<dt><strong>q</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Axis ratio (0 &lt; q &lt;= 1).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>e1</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>First ellipticity component.</p>
</dd>
<dt><strong>e2</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Second ellipticity component.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ler.image_properties.ImageProperties">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ler.image_properties.</span></span><span class="sig-name descname"><span class="pre">ImageProperties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">npool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_min_images</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_max_images</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lens_model_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['EPL_NUMBA',</span> <span class="pre">'SHEAR']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmology</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">365</span> <span class="pre">*</span> <span class="pre">24</span> <span class="pre">*</span> <span class="pre">3600</span> <span class="pre">*</span> <span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_precession</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/image_properties/image_properties.html#ImageProperties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.image_properties.ImageProperties" title="Link to this definition"></a></dt>
<dd><p>Class to compute image properties of strongly lensed gravitational wave events.</p>
<p>This class solves the lens equation to find image positions, magnifications,
time delays, and image types (morse phase) for strongly lensed sources. It uses
multiprocessing for efficient computation of large samples.</p>
<p>Key Features:</p>
<ul class="simple">
<li><p>Solves lens equations using multiprocessing for efficiency</p></li>
<li><p>Computes image positions, magnifications, and time delays</p></li>
<li><p>Classifies image types using morse phase</p></li>
<li><p>Calculates detection probabilities for lensed images</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>npool</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of processes for multiprocessing.</p>
<p>default: 4</p>
</dd>
<dt><strong>n_min_images</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Minimum number of images required for a valid lensing event.</p>
<p>default: 2</p>
</dd>
<dt><strong>n_max_images</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Maximum number of images to consider per event.</p>
<p>default: 4</p>
</dd>
<dt><strong>time_window</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Time window for lensed events (units: seconds).</p>
<p>default: 365*24*3600*20 (20 years)</p>
</dd>
<dt><strong>lens_model_list</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">list</span></code></span></dt><dd><p>List of lens models to use.</p>
<p>default: [‘EPL_NUMBA’, ‘SHEAR’]</p>
</dd>
<dt><strong>cosmology</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">astropy.cosmology</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Cosmology for distance calculations.</p>
<p>If None, uses default LambdaCDM.</p>
<p>default: LambdaCDM(H0=70, Om0=0.3, Ode0=0.7, Tcmb0=0.0, Neff=3.04, m_nu=None, Ob0=0.0)</p>
</dd>
<dt><strong>spin_zero</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, spin parameters are set to zero (no spin sampling).</p>
<p>default: False</p>
</dd>
<dt><strong>spin_precession</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True (and spin_zero=False), sample precessing spin parameters.</p>
<p>If False (and spin_zero=False), sample aligned/anti-aligned spins.</p>
<p>default: False</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Basic usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler.image_properties</span> <span class="kn">import</span> <span class="n">ImageProperties</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ip</span> <span class="o">=</span> <span class="n">ImageProperties</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lens_parameters</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">zs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.0</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">zl</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">gamma1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">gamma2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">phi</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">q</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">gamma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.0</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="n">theta_E</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">])</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ip</span><span class="o">.</span><span class="n">image_properties</span><span class="p">(</span><span class="n">lens_parameters</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
<section id="instance-methods">
<h4>Instance Methods<a class="headerlink" href="#instance-methods" title="Link to this heading"></a></h4>
<p>ImageProperties has the following methods:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="image_properties/index.html#module-ler.image_properties.image_properties" title="ler.image_properties.image_properties"><code class="xref py py-meth docutils literal notranslate"><span class="pre">image_properties()</span></code></a></p></td>
<td><p>Compute image properties for lensed events</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.image_properties.ImageProperties.get_lensed_snrs" title="ler.image_properties.ImageProperties.get_lensed_snrs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_lensed_snrs()</span></code></a></p></td>
<td><p>Compute detection probability for lensed images</p></td>
</tr>
</tbody>
</table>
</section>
<section id="instance-attributes">
<h4>Instance Attributes<a class="headerlink" href="#instance-attributes" title="Link to this heading"></a></h4>
<p>ImageProperties has the following attributes:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.image_properties.ImageProperties.npool" title="ler.image_properties.ImageProperties.npool"><code class="xref py py-attr docutils literal notranslate"><span class="pre">npool</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p></td>
<td></td>
<td><p>Number of multiprocessing workers</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.image_properties.ImageProperties.n_min_images" title="ler.image_properties.ImageProperties.n_min_images"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_min_images</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p></td>
<td></td>
<td><p>Minimum number of images required</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.image_properties.ImageProperties.n_max_images" title="ler.image_properties.ImageProperties.n_max_images"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_max_images</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p></td>
<td></td>
<td><p>Maximum number of images per event</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.image_properties.ImageProperties.time_window" title="ler.image_properties.ImageProperties.time_window"><code class="xref py py-attr docutils literal notranslate"><span class="pre">time_window</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td><p>s</p></td>
<td><p>Time window for lensed events</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.image_properties.ImageProperties.lens_model_list" title="ler.image_properties.ImageProperties.lens_model_list"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lens_model_list</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">list</span></code></p></td>
<td></td>
<td><p>List of lens models</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.image_properties.cosmo" title="ler.image_properties.cosmo"><code class="xref py py-attr docutils literal notranslate"><span class="pre">cosmo</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">astropy.cosmology</span></code></p></td>
<td></td>
<td><p>Cosmology for calculations</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.image_properties.ImageProperties.spin_zero" title="ler.image_properties.ImageProperties.spin_zero"><code class="xref py py-attr docutils literal notranslate"><span class="pre">spin_zero</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bool</span></code></p></td>
<td></td>
<td><p>Flag for zero spin assumption</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.image_properties.ImageProperties.spin_precession" title="ler.image_properties.ImageProperties.spin_precession"><code class="xref py py-attr docutils literal notranslate"><span class="pre">spin_precession</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bool</span></code></p></td>
<td></td>
<td><p>Flag for spin precession</p></td>
</tr>
</tbody>
</table>
<dl class="py property">
<dt class="sig sig-object py" id="ler.image_properties.ImageProperties.npool">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">npool</span></span><a class="headerlink" href="#ler.image_properties.ImageProperties.npool" title="Link to this definition"></a></dt>
<dd><p>Number of multiprocessing workers.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>npool</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of processes for multiprocessing.</p>
<p>default: 4</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.image_properties.ImageProperties.n_min_images">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_min_images</span></span><a class="headerlink" href="#ler.image_properties.ImageProperties.n_min_images" title="Link to this definition"></a></dt>
<dd><p>Minimum number of images required for a valid lensing event.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>n_min_images</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Minimum number of images required.</p>
<p>default: 2</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.image_properties.ImageProperties.n_max_images">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_max_images</span></span><a class="headerlink" href="#ler.image_properties.ImageProperties.n_max_images" title="Link to this definition"></a></dt>
<dd><p>Maximum number of images per event.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>n_max_images</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Maximum number of images to consider per event.</p>
<p>default: 4</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.image_properties.ImageProperties.lens_model_list">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lens_model_list</span></span><a class="headerlink" href="#ler.image_properties.ImageProperties.lens_model_list" title="Link to this definition"></a></dt>
<dd><p>List of lens models to use.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>lens_model_list</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">list</span></code></span></dt><dd><p>List of lens model names.</p>
<p>default: [‘EPL_NUMBA’, ‘SHEAR’]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.image_properties.ImageProperties.spin_zero">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">spin_zero</span></span><a class="headerlink" href="#ler.image_properties.ImageProperties.spin_zero" title="Link to this definition"></a></dt>
<dd><p>Flag for zero spin assumption.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>spin_zero</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>Whether to assume zero spin for compact objects.</p>
<p>If True, spin parameters are set to zero (no spin sampling).</p>
<p>If False, spin parameters are sampled.</p>
<p>default: False</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.image_properties.ImageProperties.spin_precession">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">spin_precession</span></span><a class="headerlink" href="#ler.image_properties.ImageProperties.spin_precession" title="Link to this definition"></a></dt>
<dd><p>Flag for spin precession.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>spin_precession</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>Whether to include spin precession effects.</p>
<p>If True (and spin_zero=False), sample precessing spin parameters.</p>
<p>If False (and spin_zero=False), sample aligned/anti-aligned spins.</p>
<p>default: False</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.image_properties.ImageProperties.time_window">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">time_window</span></span><a class="headerlink" href="#ler.image_properties.ImageProperties.time_window" title="Link to this definition"></a></dt>
<dd><p>Time window for lensed events.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>time_window</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Time window for lensed events (units: s).</p>
<p>default: 365*24*3600*20 (20 years)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.image_properties.ImageProperties.cosmo">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cosmo</span></span><a class="headerlink" href="#ler.image_properties.ImageProperties.cosmo" title="Link to this definition"></a></dt>
<dd><p>Astropy cosmology object for calculations.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>cosmo</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">astropy.cosmology</span></code></span></dt><dd><p>Cosmology used for distance calculations.</p>
<p>default: LambdaCDM(H0=70, Om0=0.3, Ode0=0.7, Tcmb0=0.0, Neff=3.04, m_nu=None, Ob0=0.0)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.image_properties.ImageProperties.image_properties">
<span class="sig-name descname"><span class="pre">image_properties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lens_parameters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/image_properties/image_properties.html#ImageProperties.image_properties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.image_properties.ImageProperties.image_properties" title="Link to this definition"></a></dt>
<dd><p>Compute image properties for strongly lensed events.</p>
<p>Solves the lens equation using multiprocessing to find image positions,
magnifications, time delays, and image types for each lensing event.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>lens_parameters</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary containing lens and source parameters with keys:</p>
<ul class="simple">
<li><p>‘zs’: source redshift (array)</p></li>
<li><p>‘zl’: lens redshift (array)</p></li>
<li><p>‘gamma1’: external shear component 1 (array)</p></li>
<li><p>‘gamma2’: external shear component 2 (array)</p></li>
<li><p>‘phi’: position angle of lens ellipticity (array)</p></li>
<li><p>‘q’: axis ratio of lens (array)</p></li>
<li><p>‘gamma’: power-law slope of mass density (array)</p></li>
<li><p>‘theta_E’: Einstein radius in radians (array)</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>lens_parameters</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Updated dictionary with additional image properties:</p>
<ul class="simple">
<li><p>‘x0_image_positions’: x-coordinates of images (shape: size x n_max_images)</p></li>
<li><p>‘x1_image_positions’: y-coordinates of images (shape: size x n_max_images)</p></li>
<li><p>‘magnifications’: magnification factors (shape: size x n_max_images)</p></li>
<li><p>‘time_delays’: time delays relative to first image (shape: size x n_max_images, units: s)</p></li>
<li><p>‘image_type’: morse phase classification (1=minimum, 2=saddle, 3=maximum)</p></li>
<li><p>‘n_images’: number of images per event (array)</p></li>
<li><p>‘x_source’: source x-position (array)</p></li>
<li><p>‘y_source’: source y-position (array)</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.image_properties.ImageProperties.get_lensed_snrs">
<span class="sig-name descname"><span class="pre">get_lensed_snrs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lensed_param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdet_calculator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_of_detectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/image_properties/image_properties.html#ImageProperties.get_lensed_snrs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.image_properties.ImageProperties.get_lensed_snrs" title="Link to this definition"></a></dt>
<dd><p>Compute detection probability for each lensed image.</p>
<p>Calculates the effective luminosity distance, geocent time, and phase
for each image accounting for magnification and morse phase, then
computes detection probabilities using the provided calculator.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>lensed_param</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary containing lensed source and image parameters with keys:</p>
<ul class="simple">
<li><p>‘mass_1’, ‘mass_2’: detector-frame masses (array)</p></li>
<li><p>‘luminosity_distance’ or ‘effective_luminosity_distance’: distance (array)</p></li>
<li><p>‘geocent_time’ or ‘effective_geocent_time’: GPS time (array)</p></li>
<li><p>‘phase’ or ‘effective_phase’: coalescence phase (array)</p></li>
<li><p>‘theta_jn’, ‘psi’, ‘ra’, ‘dec’: orientation and position (arrays)</p></li>
<li><p>‘magnifications’: image magnifications (shape: size x n_max_images)</p></li>
<li><p>‘time_delays’: image time delays (shape: size x n_max_images)</p></li>
<li><p>‘image_type’: morse phase type (shape: size x n_max_images)</p></li>
</ul>
</dd>
<dt><strong>pdet_calculator</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">callable</span></code></span></dt><dd><p>Function that computes detection probability given GW parameters.</p>
</dd>
<dt><strong>list_of_detectors</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">list</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>List of detector names (e.g., [‘H1’, ‘L1’, ‘V1’]) for per-detector results.</p>
<p>default: None</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>result_dict</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary containing:</p>
<ul class="simple">
<li><p>‘pdet_net’: network detection probability (shape: size x n_max_images)</p></li>
<li><p>Individual detector probabilities if list_of_detectors provided</p></li>
</ul>
</dd>
<dt><strong>lensed_param</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Updated dictionary with effective parameters:</p>
<ul class="simple">
<li><p>‘effective_luminosity_distance’: magnification-corrected distance</p></li>
<li><p>‘effective_geocent_time’: time-delay-corrected GPS time</p></li>
<li><p>‘effective_phase’: morse-phase-corrected coalescence phase</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="ler.image_properties.MAX_RETRIES">
<span class="sig-prename descclassname"><span class="pre">ler.image_properties.</span></span><span class="sig-name descname"><span class="pre">MAX_RETRIES</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'100'</span></em><a class="reference internal" href="../../../_modules/ler/image_properties/multiprocessing_routine.html#MAX_RETRIES"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.image_properties.MAX_RETRIES" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="ler.image_properties.MIN_MAGNIFICATION">
<span class="sig-prename descclassname"><span class="pre">ler.image_properties.</span></span><span class="sig-name descname"><span class="pre">MIN_MAGNIFICATION</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'0.01'</span></em><a class="reference internal" href="../../../_modules/ler/image_properties/multiprocessing_routine.html#MIN_MAGNIFICATION"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.image_properties.MIN_MAGNIFICATION" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id0">
<span class="sig-prename descclassname"><span class="pre">ler.image_properties.</span></span><span class="sig-name descname"><span class="pre">solve_lens_equation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lens_parameters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/image_properties/multiprocessing_routine.html#solve_lens_equation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Solve the lens equation to find image properties.</p>
<p>Uses the analytical solver from lenstronomy to find image positions,
magnifications, time delays, and hessian properties for strongly
lensed sources. Source positions are sampled from within the caustic
region to ensure multiple imaging.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>lens_parameters</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of lens configuration parameters with the following structure:</p>
<ul class="simple">
<li><p>[0]: n_min_images - minimum number of images required</p></li>
<li><p>[1]: e1 - ellipticity component 1</p></li>
<li><p>[2]: e2 - ellipticity component 2</p></li>
<li><p>[3]: gamma - power-law slope of mass density</p></li>
<li><p>[4]: gamma1 - external shear component 1</p></li>
<li><p>[5]: gamma2 - external shear component 2</p></li>
<li><p>[6]: zl - lens redshift</p></li>
<li><p>[7]: zs - source redshift</p></li>
<li><p>[8]: einstein_radius - Einstein radius (units: arcsec)</p></li>
<li><p>[9]: iteration - iteration index for tracking</p></li>
<li><p>[10:]: lens_model_list - lens model names (e.g., ‘EPL_NUMBA’, ‘SHEAR’)</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>x_source</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Source x-position (units: arcsec).</p>
</dd>
<dt><strong>y_source</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Source y-position (units: arcsec).</p>
</dd>
<dt><strong>x0_image_position</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Image x-positions (units: arcsec).</p>
</dd>
<dt><strong>x1_image_position</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Image y-positions (units: arcsec).</p>
</dd>
<dt><strong>magnifications</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Magnification factors for each image.</p>
</dd>
<dt><strong>time_delays</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Time delays for each image (units: seconds).</p>
</dd>
<dt><strong>nImages</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of images formed.</p>
</dd>
<dt><strong>determinant</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Determinant of the lensing Jacobian for each image.</p>
</dd>
<dt><strong>trace</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Trace of the lensing Jacobian for each image.</p>
</dd>
<dt><strong>iteration</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Iteration index passed through for tracking.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler.image_properties.multiprocessing_routine</span> <span class="kn">import</span> <span class="n">solve_lens_equation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Pool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lens_parameters1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.024</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.016</span><span class="p">,</span> <span class="mf">1.89</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.94</span><span class="p">,</span> <span class="mf">2.5e-06</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;EPL_NUMBA&#39;</span><span class="p">,</span> <span class="s1">&#39;SHEAR&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lens_parameters2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.040</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.014</span><span class="p">,</span> <span class="mf">2.00</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">1.09</span><span class="p">,</span> <span class="mf">2.55</span><span class="p">,</span> <span class="mf">1.0e-06</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;EPL_NUMBA&#39;</span><span class="p">,</span> <span class="s1">&#39;SHEAR&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_arguments</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">lens_parameters1</span><span class="p">,</span> <span class="n">lens_parameters2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">result</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">solve_lens_equation</span><span class="p">,</span> <span class="n">input_arguments</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of images: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../lens_galaxy_population/sampler_functions/index.html" class="btn btn-neutral float-left" title="ler.lens_galaxy_population.sampler_functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="image_properties/index.html" class="btn btn-neutral float-right" title="ler.image_properties.image_properties" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Phurailatpam Hemantakumar.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>