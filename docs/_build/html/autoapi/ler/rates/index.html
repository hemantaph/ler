

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ler.rates &mdash; ler 0.5.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../_static/scalefix.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=776609e1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/dark_mode_css/general.css?v=c0a7eb24" />
      <link rel="stylesheet" type="text/css" href="../../../_static/dark_mode_css/dark.css?v=70edf1c7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=8e576371"></script>
      <script src="../../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="../../../_static/dark_mode_js/default_light.js?v=c2e647ce"></script>
      <script src="../../../_static/dark_mode_js/theme_switcher.js?v=358d3910"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="ler.rates.gwrates" href="gwrates/index.html" />
    <link rel="prev" title="Lensed event sampling (Analytical formulation)" href="../../../Lensed_equations.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980b9" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            ler
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Summary.html">Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../code_overview.html">Code overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../GW_events.html">Gravitational wave event rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analytical_formulation_unlensed.html">Analytical Formulation for Gravitational Wave Event Rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analytical_formulation_unlensed.html#id1">Analytical Formulation for Gravitational Wave Event Rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Lensed_events.html">Lensed event rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Lensed_equations.html">Lensed event sampling (Analytical formulation)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.rates</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="gwrates/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.rates.gwrates</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="ler/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.rates.ler</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#package-contents">Package Contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#classes">Classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#functions">Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ler.rates.LensGalaxyParameterDistribution"><code class="docutils literal notranslate"><span class="pre">LensGalaxyParameterDistribution</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ler.rates.load_json"><code class="docutils literal notranslate"><span class="pre">load_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ler.rates.append_json"><code class="docutils literal notranslate"><span class="pre">append_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ler.rates.get_param_from_json"><code class="docutils literal notranslate"><span class="pre">get_param_from_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ler.rates.batch_handler"><code class="docutils literal notranslate"><span class="pre">batch_handler()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ler.rates.remove_file"><code class="docutils literal notranslate"><span class="pre">remove_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ler.rates.LeR"><code class="docutils literal notranslate"><span class="pre">LeR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ler.rates.CBCSourceParameterDistribution"><code class="docutils literal notranslate"><span class="pre">CBCSourceParameterDistribution</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">load_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5"><code class="docutils literal notranslate"><span class="pre">append_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6"><code class="docutils literal notranslate"><span class="pre">get_param_from_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7"><code class="docutils literal notranslate"><span class="pre">batch_handler()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8"><code class="docutils literal notranslate"><span class="pre">remove_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ler.rates.GWRATES"><code class="docutils literal notranslate"><span class="pre">GWRATES</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gw_source_population/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.gw_source_population</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../lens_galaxy_population/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.lens_galaxy_population</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../image_properties/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.image_properties</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.utils</span></code></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/LeR_short_examples.html">LeR Short Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/GWRATES_complete_examples.html">GWRATES complete example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/LeR_custom_functions.html">LeR with Custom Functions and Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/LeR_advanced_sampling.html">LeR Advanced Sampling — Generating Detectable Events</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980b9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ler</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.rates</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/autoapi/ler/rates/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-ler.rates">
<span id="ler-rates"></span><h1><a class="reference internal" href="#module-ler.rates" title="ler.rates"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.rates</span></code></a><a class="headerlink" href="#module-ler.rates" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="gwrates/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.rates.gwrates</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="ler/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ler.rates.ler</span></code></a></li>
</ul>
</div>
</section>
<section id="package-contents">
<h2>Package Contents<a class="headerlink" href="#package-contents" title="Link to this heading"></a></h2>
<section id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Link to this heading"></a></h3>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.LensGalaxyParameterDistribution" title="ler.rates.LensGalaxyParameterDistribution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LensGalaxyParameterDistribution</span></code></a></p></td>
<td><p>Sample lens galaxy parameters conditioned on strong lensing.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.LeR" title="ler.rates.LeR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LeR</span></code></a></p></td>
<td><p>Class to sample lensed and unlensed GW events and calculate their detection rates.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.CBCSourceParameterDistribution" title="ler.rates.CBCSourceParameterDistribution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CBCSourceParameterDistribution</span></code></a></p></td>
<td><p>Class for sampling compact binary coalescence source parameters.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.GWRATES" title="ler.rates.GWRATES"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GWRATES</span></code></a></p></td>
<td><p>Class to sample GW events and calculate their detection rates.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Link to this heading"></a></h3>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#id0" title="ler.rates.load_json"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_json</span></code></a>(file_name)</p></td>
<td><p>Load a json file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id5" title="ler.rates.append_json"><code class="xref py py-obj docutils literal notranslate"><span class="pre">append_json</span></code></a>(file_name, new_dictionary[, ...])</p></td>
<td><p>Append (values with corresponding keys) and update a json file with a dictionary. There are four options:</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id6" title="ler.rates.get_param_from_json"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_param_from_json</span></code></a>(json_file)</p></td>
<td><p>Function to get the parameters from json file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id7" title="ler.rates.batch_handler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">batch_handler</span></code></a>(size, batch_size, sampling_routine, ...)</p></td>
<td><p>Function to run the sampling in batches.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id8" title="ler.rates.remove_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_file</span></code></a>(file_name)</p></td>
<td><p>Remove a file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id0" title="ler.rates.load_json"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_json</span></code></a>(file_name)</p></td>
<td><p>Load a json file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id5" title="ler.rates.append_json"><code class="xref py py-obj docutils literal notranslate"><span class="pre">append_json</span></code></a>(file_name, new_dictionary[, ...])</p></td>
<td><p>Append (values with corresponding keys) and update a json file with a dictionary. There are four options:</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id6" title="ler.rates.get_param_from_json"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_param_from_json</span></code></a>(json_file)</p></td>
<td><p>Function to get the parameters from json file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id7" title="ler.rates.batch_handler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">batch_handler</span></code></a>(size, batch_size, sampling_routine, ...)</p></td>
<td><p>Function to run the sampling in batches.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id8" title="ler.rates.remove_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_file</span></code></a>(file_name)</p></td>
<td><p>Remove a file.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="ler.rates.LensGalaxyParameterDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ler.rates.</span></span><span class="sig-name descname"><span class="pre">LensGalaxyParameterDistribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">npool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmology</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BBH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lens_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'epl_shear_galaxy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lens_functions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lens_functions_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lens_param_samplers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lens_param_samplers_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./interpolator_json'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_new_interpolator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/lens_galaxy_population/lens_galaxy_parameter_distribution.html#LensGalaxyParameterDistribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.LensGalaxyParameterDistribution" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../gw_source_population/index.html#ler.gw_source_population.CBCSourceParameterDistribution" title="ler.gw_source_population.CBCSourceParameterDistribution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ler.gw_source_population.CBCSourceParameterDistribution</span></code></a>, <a class="reference internal" href="../image_properties/index.html#ler.image_properties.ImageProperties" title="ler.image_properties.ImageProperties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ler.image_properties.ImageProperties</span></code></a>, <a class="reference internal" href="../lens_galaxy_population/optical_depth/index.html#ler.lens_galaxy_population.optical_depth.OpticalDepth" title="ler.lens_galaxy_population.optical_depth.OpticalDepth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ler.lens_galaxy_population.optical_depth.OpticalDepth</span></code></a></p>
<p>Sample lens galaxy parameters conditioned on strong lensing.</p>
<p>This class handles the distribution of lens galaxy parameters such as velocity
dispersion, axis ratio, axis rotation angle, shear, and density profile slope.
It samples source parameters conditioned on the source being strongly lensed
using cross-section based rejection or importance sampling.</p>
<p>Key Features:</p>
<ul class="simple">
<li><p>Samples lens parameters using EPL+shear galaxy model</p></li>
<li><p>Supports rejection and importance sampling based on cross-section</p></li>
<li><p>Computes optical depth weighted source redshift distributions</p></li>
<li><p>Integrates with GW source population and image property calculations</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>npool</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of processors to use for parallel sampling.</p>
<p>default: 4</p>
</dd>
<dt><strong>z_min</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Minimum redshift for source and lens populations.</p>
<p>default: 0.0</p>
</dd>
<dt><strong>z_max</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Maximum redshift for source and lens populations.</p>
<p>default: 10.0</p>
</dd>
<dt><strong>cosmology</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">astropy.cosmology</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Cosmology object for distance calculations.</p>
<p>default: None (uses FlatLambdaCDM with H0=70, Om0=0.3)</p>
</dd>
<dt><strong>event_type</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Type of compact binary coalescence event.</p>
<p>Options:</p>
<ul class="simple">
<li><p>‘BBH’: Binary black hole</p></li>
<li><p>‘BNS’: Binary neutron star</p></li>
<li><p>‘NSBH’: Neutron star-black hole</p></li>
</ul>
<p>default: ‘BBH’</p>
</dd>
<dt><strong>lens_type</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Type of lens galaxy model to use.</p>
<p>default: ‘epl_shear_galaxy’</p>
</dd>
<dt><strong>lens_functions</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Dictionary specifying lens-related functions.</p>
<p>default: None (uses defaults from OpticalDepth)</p>
</dd>
<dt><strong>lens_functions_params</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Parameters for lens functions.</p>
<p>default: None</p>
</dd>
<dt><strong>lens_param_samplers</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Dictionary specifying lens parameter sampling functions.</p>
<p>default: None (uses defaults from OpticalDepth)</p>
</dd>
<dt><strong>lens_param_samplers_params</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Parameters for lens parameter samplers.</p>
<p>default: None</p>
</dd>
<dt><strong>directory</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Directory for storing interpolator files.</p>
<p>default: ‘./interpolator_json’</p>
</dd>
<dt><strong>create_new_interpolator</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, recreates interpolators even if files exist.</p>
<p>default: False</p>
</dd>
<dt><strong>buffer_size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Buffer size for batch sampling of lens parameters.</p>
<p>default: 1000</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Additional keyword arguments passed to parent classes:</p>
<p><a class="reference internal" href="../gw_source_population/index.html#ler.gw_source_population.CBCSourceParameterDistribution" title="ler.gw_source_population.CBCSourceParameterDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">CBCSourceParameterDistribution</span></code></a>,</p>
<p><a class="reference internal" href="../image_properties/index.html#ler.image_properties.ImageProperties" title="ler.image_properties.ImageProperties"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageProperties</span></code></a>,</p>
<p><a class="reference internal" href="../lens_galaxy_population/index.html#id0" title="ler.lens_galaxy_population.OpticalDepth"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpticalDepth</span></code></a>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Basic usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler.lens_galaxy_population</span> <span class="kn">import</span> <span class="n">LensGalaxyParameterDistribution</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lens</span> <span class="o">=</span> <span class="n">LensGalaxyParameterDistribution</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lensed_params</span> <span class="o">=</span> <span class="n">lens</span><span class="o">.</span><span class="n">sample_lens_parameters</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lensed_params</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
<section id="instance-methods">
<h4>Instance Methods<a class="headerlink" href="#instance-methods" title="Link to this heading"></a></h4>
<p>LensGalaxyParameterDistribution has the following methods:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.LensGalaxyParameterDistribution.sample_lens_parameters" title="ler.rates.LensGalaxyParameterDistribution.sample_lens_parameters"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample_lens_parameters()</span></code></a></p></td>
<td><p>Sample lens and source parameters</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><dl>
<dt><a class="reference internal" href="#ler.rates.LensGalaxyParameterDistribution.sample_all_routine_epl_shear_intrinsic" title="ler.rates.LensGalaxyParameterDistribution.sample_all_routine_epl_shear_intrinsic"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample_all_routine_epl_shear_intrinsic()</span></code></a>    | Sample EPL+shear lens parameters from intrinsic</dt><dd><div class="line-block">
<div class="line">distributions</div>
</div>
</dd>
</dl>
</td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.LensGalaxyParameterDistribution.sample_all_routine_epl_shear_sl" title="ler.rates.LensGalaxyParameterDistribution.sample_all_routine_epl_shear_sl"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample_all_routine_epl_shear_sl()</span></code></a></p></td>
<td><p>Sample EPL+shear lens parameters with strong
lensing condition</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.LensGalaxyParameterDistribution.strongly_lensed_source_redshifts" title="ler.rates.LensGalaxyParameterDistribution.strongly_lensed_source_redshifts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">strongly_lensed_source_redshifts()</span></code></a></p></td>
<td><p>Sample source redshifts with lensing condition</p></td>
</tr>
</tbody>
</table>
</section>
<section id="instance-attributes">
<h4>Instance Attributes<a class="headerlink" href="#instance-attributes" title="Link to this heading"></a></h4>
<p>LensGalaxyParameterDistribution has the following attributes:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">npool</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p></td>
<td></td>
<td><p>Number of processors for parallel computation</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">z_min</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td></td>
<td><p>Minimum redshift</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">z_max</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td></td>
<td><p>Maximum redshift</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">cosmo</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">astropy.cosmology</span></code></p></td>
<td></td>
<td><p>Cosmology object for calculations</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.LensGalaxyParameterDistribution.event_type" title="ler.rates.LensGalaxyParameterDistribution.event_type"><code class="xref py py-attr docutils literal notranslate"><span class="pre">event_type</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p></td>
<td></td>
<td><p>Type of CBC event (BBH, BNS, NSBH)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">directory</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p></td>
<td></td>
<td><p>Path to interpolator storage directory</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.LensGalaxyParameterDistribution.lens_param_samplers" title="ler.rates.LensGalaxyParameterDistribution.lens_param_samplers"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lens_param_samplers</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p></td>
<td></td>
<td><p>Dictionary of lens parameter sampler names</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.LensGalaxyParameterDistribution.lens_param_samplers_params" title="ler.rates.LensGalaxyParameterDistribution.lens_param_samplers_params"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lens_param_samplers_params</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p></td>
<td></td>
<td><p>Parameters for lens parameter samplers</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.LensGalaxyParameterDistribution.lens_functions" title="ler.rates.LensGalaxyParameterDistribution.lens_functions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lens_functions</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p></td>
<td></td>
<td><p>Dictionary of lens function names</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.LensGalaxyParameterDistribution.normalization_pdf_z_lensed" title="ler.rates.LensGalaxyParameterDistribution.normalization_pdf_z_lensed"><code class="xref py py-attr docutils literal notranslate"><span class="pre">normalization_pdf_z_lensed</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td></td>
<td><p>Normalization constant for lensed source z pdf</p></td>
</tr>
</tbody>
</table>
<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.LensGalaxyParameterDistribution.normalization_pdf_z_lensed">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">normalization_pdf_z_lensed</span></span><a class="headerlink" href="#ler.rates.LensGalaxyParameterDistribution.normalization_pdf_z_lensed" title="Link to this definition"></a></dt>
<dd><p>Normalization constant for the lensed source redshift pdf.</p>
<p>This constant is used to normalize the probability distribution</p>
<p>of source redshifts conditioned on strong lensing. It is computed</p>
<p>by integrating the merger rate density times optical depth.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>normalization_pdf_z_lensed</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Normalization constant for lensed redshift distribution.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.LensGalaxyParameterDistribution.lens_param_samplers">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lens_param_samplers</span></span><a class="headerlink" href="#ler.rates.LensGalaxyParameterDistribution.lens_param_samplers" title="Link to this definition"></a></dt>
<dd><p>Dictionary of lens parameter sampler function names.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>lens_param_samplers</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary mapping parameter names to sampler function names.</p>
<p>Keys include: ‘source_redshift_sl’, ‘lens_redshift’,</p>
<p>‘velocity_dispersion’, ‘axis_ratio’, ‘axis_rotation_angle’,</p>
<p>‘external_shear’, ‘density_profile_slope’.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.LensGalaxyParameterDistribution.lens_param_samplers_params">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lens_param_samplers_params</span></span><a class="headerlink" href="#ler.rates.LensGalaxyParameterDistribution.lens_param_samplers_params" title="Link to this definition"></a></dt>
<dd><p>Dictionary of parameters for lens parameter samplers.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>lens_param_samplers_params</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary with sampler parameters.</p>
<p>Each key corresponds to a sampler in lens_param_samplers.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.LensGalaxyParameterDistribution.lens_functions">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lens_functions</span></span><a class="headerlink" href="#ler.rates.LensGalaxyParameterDistribution.lens_functions" title="Link to this definition"></a></dt>
<dd><p>Dictionary of lens-related function names.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>lens_functions</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary mapping function types to function names.</p>
<p>Keys include: ‘param_sampler_type’, ‘cross_section_based_sampler’,</p>
<p>‘optical_depth’, ‘cross_section’.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ler.rates.LensGalaxyParameterDistribution.event_type">
<span class="sig-name descname"><span class="pre">event_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&quot;'BBH'&quot;</span></em><a class="headerlink" href="#ler.rates.LensGalaxyParameterDistribution.event_type" title="Link to this definition"></a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
<p>Type of event to generate.</p>
<p>e.g. ‘BBH’, ‘BNS’, ‘NSBH’</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ler.rates.LensGalaxyParameterDistribution.sample_source_redshift_sl">
<span class="sig-name descname"><span class="pre">sample_source_redshift_sl</span></span><a class="headerlink" href="#ler.rates.LensGalaxyParameterDistribution.sample_source_redshift_sl" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ler.rates.LensGalaxyParameterDistribution.sample_lens_parameters_routine">
<span class="sig-name descname"><span class="pre">sample_lens_parameters_routine</span></span><a class="headerlink" href="#ler.rates.LensGalaxyParameterDistribution.sample_lens_parameters_routine" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ler.rates.LensGalaxyParameterDistribution.cross_section_based_sampler">
<span class="sig-name descname"><span class="pre">cross_section_based_sampler</span></span><a class="headerlink" href="#ler.rates.LensGalaxyParameterDistribution.cross_section_based_sampler" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.LensGalaxyParameterDistribution.sample_lens_parameters">
<span class="sig-name descname"><span class="pre">sample_lens_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/lens_galaxy_population/lens_galaxy_parameter_distribution.html#LensGalaxyParameterDistribution.sample_lens_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.LensGalaxyParameterDistribution.sample_lens_parameters" title="Link to this definition"></a></dt>
<dd><p>Sample lens galaxy and source parameters conditioned on strong lensing.</p>
<p>This method samples both lens galaxy parameters (velocity dispersion, axis
ratio, shear, etc.) and gravitational wave source parameters, with the
source redshift distribution weighted by strong lensing optical depth.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of lens-source parameter sets to sample.</p>
<p>default: 1000</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>lens_parameters</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary containing sampled lens and source parameters.</p>
<p>The included parameters and their units are as follows (for default settings):</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler.lens_galaxy_population</span> <span class="kn">import</span> <span class="n">LensGalaxyParameterDistribution</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lens</span> <span class="o">=</span> <span class="n">LensGalaxyParameterDistribution</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">lens</span><span class="o">.</span><span class="n">sample_lens_parameters</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.LensGalaxyParameterDistribution.sample_all_routine_epl_shear_sl">
<span class="sig-name descname"><span class="pre">sample_all_routine_epl_shear_sl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/lens_galaxy_population/lens_galaxy_parameter_distribution.html#LensGalaxyParameterDistribution.sample_all_routine_epl_shear_sl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.LensGalaxyParameterDistribution.sample_all_routine_epl_shear_sl" title="Link to this definition"></a></dt>
<dd><p>Sample EPL+shear galaxy lens parameters with strong lensing condition.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of lens parameters to sample.</p>
<p>default: 1000</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>lens_parameters</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary of sampled lens parameters.</p>
<p>The included parameters and their units are as follows (for default settings):</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>zl</p></td>
<td></td>
<td><p>redshift of the lens</p></td>
</tr>
<tr class="row-odd"><td><p>zs</p></td>
<td></td>
<td><p>redshift of the source</p></td>
</tr>
<tr class="row-even"><td><p>sigma</p></td>
<td><p>km s^-1</p></td>
<td><p>velocity dispersion</p></td>
</tr>
<tr class="row-odd"><td><p>q</p></td>
<td></td>
<td><p>axis ratio</p></td>
</tr>
<tr class="row-even"><td><p>theta_E</p></td>
<td><p>radian</p></td>
<td><p>Einstein radius</p></td>
</tr>
<tr class="row-odd"><td><p>phi</p></td>
<td><p>rad</p></td>
<td><p>axis rotation angle. counter-clockwise from the
positive x-axis (RA-like axis) to the major axis of
the projected mass distribution.</p></td>
</tr>
<tr class="row-even"><td><p>gamma</p></td>
<td></td>
<td><p>density profile slope of EPL galaxy</p></td>
</tr>
<tr class="row-odd"><td><p>gamma1</p></td>
<td></td>
<td><p>external shear component in the x-direction
(RA-like axis)</p></td>
</tr>
<tr class="row-even"><td><p>gamma2</p></td>
<td></td>
<td><p>external shear component in the y-direction
(Dec-like axis)</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.LensGalaxyParameterDistribution.strongly_lensed_source_redshifts">
<span class="sig-name descname"><span class="pre">strongly_lensed_source_redshifts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/lens_galaxy_population/lens_galaxy_parameter_distribution.html#LensGalaxyParameterDistribution.strongly_lensed_source_redshifts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.LensGalaxyParameterDistribution.strongly_lensed_source_redshifts" title="Link to this definition"></a></dt>
<dd><p>Sample source redshifts conditioned on strong lensing.</p>
<p>Uses rejection sampling to generate source redshifts from the CBC source
population weighted by the optical depth, which increases with redshift.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of redshifts to sample.</p>
<p>default: 1000</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>redshifts</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of source redshifts conditioned on strong lensing.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler.lens_galaxy_population</span> <span class="kn">import</span> <span class="n">LensGalaxyParameterDistribution</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lens</span> <span class="o">=</span> <span class="n">LensGalaxyParameterDistribution</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zs</span> <span class="o">=</span> <span class="n">lens</span><span class="o">.</span><span class="n">strongly_lensed_source_redshifts</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean source redshift: </span><span class="si">{</span><span class="n">zs</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.LensGalaxyParameterDistribution.sample_all_routine_epl_shear_intrinsic">
<span class="sig-name descname"><span class="pre">sample_all_routine_epl_shear_intrinsic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/lens_galaxy_population/lens_galaxy_parameter_distribution.html#LensGalaxyParameterDistribution.sample_all_routine_epl_shear_intrinsic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.LensGalaxyParameterDistribution.sample_all_routine_epl_shear_intrinsic" title="Link to this definition"></a></dt>
<dd><p>Sample EPL+shear galaxy lens parameters from intrinsic distributions.</p>
<p>Samples lens parameters from their intrinsic distributions without
applying strong lensing cross-section weighting.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of lens parameters to sample.</p>
<p>default: 1000</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>lens_parameters</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary of sampled lens parameters.</p>
<p>The included parameters and their units are as follows (for default settings):</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>zl</p></td>
<td></td>
<td><p>redshift of the lens</p></td>
</tr>
<tr class="row-odd"><td><p>zs</p></td>
<td></td>
<td><p>redshift of the source</p></td>
</tr>
<tr class="row-even"><td><p>sigma</p></td>
<td><p>km s^-1</p></td>
<td><p>velocity dispersion</p></td>
</tr>
<tr class="row-odd"><td><p>q</p></td>
<td></td>
<td><p>axis ratio</p></td>
</tr>
<tr class="row-even"><td><p>theta_E</p></td>
<td><p>radian</p></td>
<td><p>Einstein radius</p></td>
</tr>
<tr class="row-odd"><td><p>phi</p></td>
<td><p>rad</p></td>
<td><p>axis rotation angle. counter-clockwise from the
positive x-axis (RA-like axis) to the major axis of
the projected mass distribution.</p></td>
</tr>
<tr class="row-even"><td><p>gamma</p></td>
<td></td>
<td><p>density profile slope of EPL galaxy</p></td>
</tr>
<tr class="row-odd"><td><p>gamma1</p></td>
<td></td>
<td><p>external shear component in the x-direction
(RA-like axis)</p></td>
</tr>
<tr class="row-even"><td><p>gamma2</p></td>
<td></td>
<td><p>external shear component in the y-direction
(Dec-like axis)</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ler.rates.load_json">
<span class="sig-prename descclassname"><span class="pre">ler.rates.</span></span><span class="sig-name descname"><span class="pre">load_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/utils/utils.html#load_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.load_json" title="Link to this definition"></a></dt>
<dd><p>Load a json file.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>file_name</strong><span class="classifier"><cite>str</cite></span></dt><dd><p>json file name for storing the parameters.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>param</strong><span class="classifier"><cite>dict</cite></span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ler.rates.append_json">
<span class="sig-prename descclassname"><span class="pre">ler.rates.</span></span><span class="sig-name descname"><span class="pre">append_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_dictionary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_dictionary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/utils/utils.html#append_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.append_json" title="Link to this definition"></a></dt>
<dd><p>Append (values with corresponding keys) and update a json file with a dictionary. There are four options:</p>
<ol class="arabic simple">
<li><p>If old_dictionary is provided, the values of the new dictionary will be appended to the old dictionary and save in the ‘file_name’ json file.</p></li>
<li><p>If replace is True, replace the json file (with the ‘file_name’) content with the new_dictionary.</p></li>
<li><p>If the file does not exist, create a new one with the new_dictionary.</p></li>
<li><p>If none of the above, append the new dictionary to the content of the json file.</p></li>
</ol>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>file_name</strong><span class="classifier"><cite>str</cite></span></dt><dd><p>json file name for storing the parameters.</p>
</dd>
<dt><strong>new_dictionary</strong><span class="classifier"><cite>dict</cite></span></dt><dd><p>dictionary to be appended to the json file.</p>
</dd>
<dt><strong>old_dictionary</strong><span class="classifier"><cite>dict</cite>, optional</span></dt><dd><p>If provided the values of the new dictionary will be appended to the old dictionary and save in the ‘file_name’ json file.
Default is None.</p>
</dd>
<dt><strong>replace</strong><span class="classifier"><cite>bool</cite>, optional</span></dt><dd><p>If True, replace the json file with the dictionary. Default is False.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ler.rates.get_param_from_json">
<span class="sig-prename descclassname"><span class="pre">ler.rates.</span></span><span class="sig-name descname"><span class="pre">get_param_from_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">json_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/utils/utils.html#get_param_from_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.get_param_from_json" title="Link to this definition"></a></dt>
<dd><p>Function to get the parameters from json file.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>json_file</strong><span class="classifier"><cite>str</cite></span></dt><dd><p>json file name for storing the parameters.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>param</strong><span class="classifier"><cite>dict</cite></span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ler.rates.batch_handler">
<span class="sig-prename descclassname"><span class="pre">ler.rates.</span></span><span class="sig-name descname"><span class="pre">batch_handler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_routine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_jsonfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'parameters'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/utils/utils.html#batch_handler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.batch_handler" title="Link to this definition"></a></dt>
<dd><p>Function to run the sampling in batches.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><cite>int</cite></span></dt><dd><p>number of samples.</p>
</dd>
<dt><strong>batch_size</strong><span class="classifier"><cite>int</cite></span></dt><dd><p>batch size.</p>
</dd>
<dt><strong>sampling_routine</strong><span class="classifier"><cite>function</cite></span></dt><dd><p>sampling function. It should have ‘size’ as input and return a dictionary.</p>
</dd>
<dt><strong>output_jsonfile</strong><span class="classifier"><cite>str</cite></span></dt><dd><p>json file name for storing the parameters.</p>
</dd>
<dt><strong>save_batch</strong><span class="classifier"><cite>bool</cite>, optional</span></dt><dd><p>if True, save sampled parameters in each iteration. Default is True.</p>
</dd>
<dt><strong>resume</strong><span class="classifier"><cite>bool</cite>, optional</span></dt><dd><p>if True, resume sampling from the last batch. Default is False.</p>
</dd>
<dt><strong>param_name</strong><span class="classifier"><cite>str</cite>, optional</span></dt><dd><p>name of the parameter. Default is ‘parameters’.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>dict_buffer</strong><span class="classifier"><cite>dict</cite></span></dt><dd><p>dictionary of parameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ler.rates.remove_file">
<span class="sig-prename descclassname"><span class="pre">ler.rates.</span></span><span class="sig-name descname"><span class="pre">remove_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/utils/utils.html#remove_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.remove_file" title="Link to this definition"></a></dt>
<dd><p>Remove a file.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ler.rates.LeR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ler.rates.</span></span><span class="sig-name descname"><span class="pre">LeR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">npool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">int(4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BBH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lens_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'epl_shear_galaxy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmology</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdet_finder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">json_file_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolator_directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./interpolator_json'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_new_interpolator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ler_directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./ler_data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/rates/ler.html#LeR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.LeR" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../lens_galaxy_population/index.html#ler.lens_galaxy_population.LensGalaxyParameterDistribution" title="ler.lens_galaxy_population.LensGalaxyParameterDistribution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ler.lens_galaxy_population.LensGalaxyParameterDistribution</span></code></a></p>
<p>Class to sample lensed and unlensed GW events and calculate their detection rates.</p>
<p>This class provides functionality for sampling gravitational wave source parameters,
detection probabilities, and computing detection rates for both lensed and unlensed
compact binary coalescence events.
Parameters of simulated events are stored in JSON files (not as class attributes)
to conserve RAM memory.</p>
<p>Key Features:</p>
<ul class="simple">
<li><p>Sampling of unlensed and lensed CBC event parameters</p></li>
<li><p>Detection probability calculation using <code class="docutils literal notranslate"><span class="pre">gwsnr</span></code> package or custom functions</p></li>
<li><p>Rate calculation for detectable events</p></li>
<li><p>Batch processing for memory efficiency</p></li>
<li><p>JSON-based parameter storage for reproducibility</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>npool</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of cores to use for parallel processing.</p>
<p>default: 4</p>
</dd>
<dt><strong>z_min</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Minimum redshift of the source population.</p>
<p>default: 0.0</p>
</dd>
<dt><strong>z_max</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Maximum redshift of the source population.</p>
<p>default: 10.0</p>
</dd>
<dt><strong>event_type</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Type of event to generate. source_priors and source_priors_params will be set accordingly.</p>
<p>Options:</p>
<ul class="simple">
<li><p>‘BBH’: Binary Black Hole</p></li>
<li><p>‘BNS’: Binary Neutron Star</p></li>
<li><p>‘NSBH’: Neutron Star-Black Hole</p></li>
</ul>
<p>default: ‘BBH’</p>
</dd>
<dt><strong>lens_type</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Type of lens model to use. lens_functions, lens_functions_params, lens_param_samplers and lens_param_samplers_params will be set accordingly.</p>
<p>Options:</p>
<ul class="simple">
<li><p>‘epl_shear_galaxy’: Exponential Power Law Shear Galaxy</p></li>
<li><p>‘sie_galaxy’: Singular Isothermal Ellipsoid Galaxy</p></li>
<li><p>‘sis_galaxy’: Singular Isothermal Sphere Galaxy</p></li>
</ul>
<p>default: ‘epl_shear_galaxy’</p>
</dd>
<dt><strong>cosmology</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">astropy.cosmology</span></code></span></dt><dd><p>Cosmology to use for the calculation.</p>
<p>default: LambdaCDM(H0=70, Om0=0.3, Ode0=0.7, Tcmb0=0.0, Neff=3.04, m_nu=None, Ob0=0.0)</p>
</dd>
<dt><strong>pdet_finder</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">function</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Custom detection probability finder function.</p>
<p>If None, uses gwsnr’s pdet calculator.</p>
<p>The function should follow the signature:</p>
<p><code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">pdet_finder(gw_param_dict):</span> <span class="pre">return</span> <span class="pre">pdet_net_dict</span></code></p>
<p>where pdet_net_dict.keys = [‘pdet_net’].</p>
<p>default: None</p>
</dd>
<dt><strong>json_file_names</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Names of the JSON files to store the necessary parameters.</p>
<dl class="simple">
<dt>default: dict(</dt><dd><p>ler_params=”ler_params.json”,
unlensed_param=”unlensed_param.json”,
unlensed_param_detectable=”unlensed_param_detectable.json”,
lensed_param=”lensed_param.json”,
lensed_param_detectable=”lensed_param_detectable.json”</p>
</dd>
</dl>
<p>)</p>
</dd>
<dt><strong>interpolator_directory</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Directory to store the interpolators.</p>
<p>default: ‘./interpolator_json’</p>
</dd>
<dt><strong>create_new_interpolator</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code> or <code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Whether to create new interpolators. Look at <code class="xref py py-meth docutils literal notranslate"><span class="pre">create_new_interpolator()</span></code> for details.</p>
<p>Options:</p>
<ul class="simple">
<li><p>True: Create all interpolators anew</p></li>
<li><p>False: Load existing interpolators if available</p></li>
<li><p>dict: Specify which interpolators to create new</p></li>
</ul>
<p>default: False</p>
</dd>
<dt><strong>ler_directory</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Directory to store the output parameters.</p>
<p>default: ‘./ler_data’</p>
</dd>
<dt><strong>verbose</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, print all chosen parameters during initialization.</p>
<p>default: True</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Additional keyword arguments passed to parent classes:</p>
<p><a class="reference internal" href="../lens_galaxy_population/index.html#ler.lens_galaxy_population.LensGalaxyParameterDistribution" title="ler.lens_galaxy_population.LensGalaxyParameterDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">LensGalaxyParameterDistribution</span></code></a>,</p>
<p><a class="reference internal" href="../gw_source_population/index.html#ler.gw_source_population.CBCSourceParameterDistribution" title="ler.gw_source_population.CBCSourceParameterDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">CBCSourceParameterDistribution</span></code></a>,</p>
<p><a class="reference internal" href="../image_properties/index.html#ler.image_properties.ImageProperties" title="ler.image_properties.ImageProperties"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageProperties</span></code></a>, and</p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">GWSNR</span></code> (if snr_finder=’gwsnr’).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">LeR</span></code> class inherits from <a class="reference internal" href="../lens_galaxy_population/index.html#ler.lens_galaxy_population.LensGalaxyParameterDistribution" title="ler.lens_galaxy_population.LensGalaxyParameterDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">LensGalaxyParameterDistribution</span></code></a>.</p>
<p>Refer to that class for additional inherited attributes and methods.</p>
</li>
<li><p>Parameters are stored in JSON files for memory efficiency and reproducibility.</p></li>
<li><p>For stable rate estimates, use size &gt;= 1e6 samples.</p></li>
</ul>
<p class="rubric">Examples</p>
<p>Basic usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler</span> <span class="kn">import</span> <span class="n">LeR</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ler</span> <span class="o">=</span> <span class="n">LeR</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unlensed_params</span> <span class="o">=</span> <span class="n">ler</span><span class="o">.</span><span class="n">unlensed_cbc_statistics</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ler</span><span class="o">.</span><span class="n">unlensed_rate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lensed_params</span> <span class="o">=</span> <span class="n">ler</span><span class="o">.</span><span class="n">lensed_cbc_statistics</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ler</span><span class="o">.</span><span class="n">lensed_rate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ler</span><span class="o">.</span><span class="n">rate_ratio</span><span class="p">()</span>
</pre></div>
</div>
<section id="id1">
<h4>Instance Methods<a class="headerlink" href="#id1" title="Link to this heading"></a></h4>
<p>LeR class has the following methods:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.LeR.unlensed_cbc_statistics" title="ler.rates.LeR.unlensed_cbc_statistics"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unlensed_cbc_statistics()</span></code></a></p></td>
<td><p>Generate unlensed GW source parameters</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.LeR.unlensed_sampling_routine" title="ler.rates.LeR.unlensed_sampling_routine"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unlensed_sampling_routine()</span></code></a></p></td>
<td><p>Generate unlensed parameters with batching</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.LeR.unlensed_rate" title="ler.rates.LeR.unlensed_rate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unlensed_rate()</span></code></a></p></td>
<td><p>Calculate the unlensed detection rate</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.LeR.lensed_cbc_statistics" title="ler.rates.LeR.lensed_cbc_statistics"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lensed_cbc_statistics()</span></code></a></p></td>
<td><p>Generate lensed GW source parameters</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.LeR.lensed_sampling_routine" title="ler.rates.LeR.lensed_sampling_routine"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lensed_sampling_routine()</span></code></a></p></td>
<td><p>Generate lensed parameters with batching</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.LeR.lensed_rate" title="ler.rates.LeR.lensed_rate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lensed_rate()</span></code></a></p></td>
<td><p>Calculate the lensed detection rate</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.LeR.rate_function" title="ler.rates.LeR.rate_function"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rate_function()</span></code></a></p></td>
<td><p>General helper for rate calculation</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.LeR.rate_ratio" title="ler.rates.LeR.rate_ratio"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rate_ratio()</span></code></a></p></td>
<td><p>Calculate lensed/unlensed rate ratio</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.LeR.rate_comparison_with_rate_calculation" title="ler.rates.LeR.rate_comparison_with_rate_calculation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rate_comparison_with_rate_calculation()</span></code></a></p></td>
<td><p>Calculate and compare lensed/unlensed rates</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.LeR.selecting_n_unlensed_detectable_events" title="ler.rates.LeR.selecting_n_unlensed_detectable_events"><code class="xref py py-meth docutils literal notranslate"><span class="pre">selecting_n_unlensed_detectable_events()</span></code></a></p></td>
<td><p>Select n unlensed detectable events</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.LeR.selecting_n_lensed_detectable_events" title="ler.rates.LeR.selecting_n_lensed_detectable_events"><code class="xref py py-meth docutils literal notranslate"><span class="pre">selecting_n_lensed_detectable_events()</span></code></a></p></td>
<td><p>Select n lensed detectable events</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id2">
<h4>Instance Attributes<a class="headerlink" href="#id2" title="Link to this heading"></a></h4>
<p>LeR class has the following attributes:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.LeR.npool" title="ler.rates.LeR.npool"><code class="xref py py-meth docutils literal notranslate"><span class="pre">npool()</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p></td>
<td></td>
<td><p>Number of parallel processing cores</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.LeR.z_min" title="ler.rates.LeR.z_min"><code class="xref py py-meth docutils literal notranslate"><span class="pre">z_min()</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td></td>
<td><p>Minimum source redshift</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.LeR.z_max" title="ler.rates.LeR.z_max"><code class="xref py py-meth docutils literal notranslate"><span class="pre">z_max()</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td></td>
<td><p>Maximum source redshift</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.LeR.event_type" title="ler.rates.LeR.event_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">event_type()</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p></td>
<td></td>
<td><p>Type of CBC event (BBH, BNS, NSBH)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.LeR.lens_type" title="ler.rates.LeR.lens_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lens_type()</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p></td>
<td></td>
<td><p>Type of lens galaxy model</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.LeR.cosmo" title="ler.rates.LeR.cosmo"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cosmo()</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Cosmology</span></code></p></td>
<td></td>
<td><p>Astropy cosmology object</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.LeR.json_file_names" title="ler.rates.LeR.json_file_names"><code class="xref py py-meth docutils literal notranslate"><span class="pre">json_file_names()</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p></td>
<td></td>
<td><p>JSON file names for parameter storage</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.LeR.interpolator_directory" title="ler.rates.LeR.interpolator_directory"><code class="xref py py-meth docutils literal notranslate"><span class="pre">interpolator_directory()</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p></td>
<td></td>
<td><p>Directory for interpolator files</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.LeR.ler_directory" title="ler.rates.LeR.ler_directory"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ler_directory()</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p></td>
<td></td>
<td><p>Directory for output parameter files</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.LeR.pdet_finder" title="ler.rates.LeR.pdet_finder"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pdet_finder()</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">callable</span></code></p></td>
<td></td>
<td><p>Detection probability finder function</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.LeR.ler_args" title="ler.rates.LeR.ler_args"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ler_args()</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p></td>
<td></td>
<td><p>All LeR initialization arguments</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.LeR.create_new_interpolator" title="ler.rates.LeR.create_new_interpolator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_new_interpolator()</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p></td>
<td></td>
<td><p>Interpolator creation settings</p></td>
</tr>
</tbody>
</table>
<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.LeR.npool">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">npool</span></span><a class="headerlink" href="#ler.rates.LeR.npool" title="Link to this definition"></a></dt>
<dd><p>Number of parallel processing cores.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>npool</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of logical cores to use for multiprocessing.</p>
<p>default: 4</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.LeR.z_min">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">z_min</span></span><a class="headerlink" href="#ler.rates.LeR.z_min" title="Link to this definition"></a></dt>
<dd><p>Minimum redshift of the source population.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>z_min</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Minimum source redshift for sampling.</p>
<p>default: 0.0</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.LeR.z_max">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">z_max</span></span><a class="headerlink" href="#ler.rates.LeR.z_max" title="Link to this definition"></a></dt>
<dd><p>Maximum redshift of the source population.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>z_max</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Maximum source redshift for sampling.</p>
<p>default: 10.0</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.LeR.event_type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">event_type</span></span><a class="headerlink" href="#ler.rates.LeR.event_type" title="Link to this definition"></a></dt>
<dd><p>Type of compact binary coalescence event.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>event_type</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Type of CBC event.</p>
<p>Options:</p>
<ul class="simple">
<li><p>‘BBH’: Binary Black Hole</p></li>
<li><p>‘BNS’: Binary Neutron Star</p></li>
<li><p>‘NSBH’: Neutron Star-Black Hole</p></li>
</ul>
<p>default: ‘BBH’</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.LeR.lens_type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lens_type</span></span><a class="headerlink" href="#ler.rates.LeR.lens_type" title="Link to this definition"></a></dt>
<dd><p>Type of lens galaxy model.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>lens_type</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Type of lens model.</p>
<p>Options:</p>
<ul class="simple">
<li><p>‘epl_shear_galaxy’: Elliptical Power Law with external shear</p></li>
<li><p>‘sie_galaxy’: Singular Isothermal Ellipsoid</p></li>
<li><p>‘sis_galaxy’: Singular Isothermal Sphere</p></li>
</ul>
<p>default: ‘epl_shear_galaxy’</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.LeR.cosmo">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cosmo</span></span><a class="headerlink" href="#ler.rates.LeR.cosmo" title="Link to this definition"></a></dt>
<dd><p>Astropy cosmology object for distance calculations.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>cosmo</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">astropy.cosmology</span></code></span></dt><dd><p>Cosmology used for luminosity distance and comoving volume calculations.</p>
<p>default: LambdaCDM(H0=70, Om0=0.3, Ode0=0.7, Tcmb0=0.0, Neff=3.04, m_nu=None, Ob0=0.0)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.LeR.json_file_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">json_file_names</span></span><a class="headerlink" href="#ler.rates.LeR.json_file_names" title="Link to this definition"></a></dt>
<dd><p>Dictionary of JSON file names for parameter storage.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>json_file_names</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary with keys:</p>
<ul class="simple">
<li><p>‘ler_params’: LeR initialization parameters</p></li>
<li><p>‘unlensed_param’: Unlensed event parameters</p></li>
<li><p>‘unlensed_param_detectable’: Detectable unlensed events</p></li>
<li><p>‘lensed_param’: Lensed event parameters</p></li>
<li><p>‘lensed_param_detectable’: Detectable lensed events</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.LeR.interpolator_directory">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">interpolator_directory</span></span><a class="headerlink" href="#ler.rates.LeR.interpolator_directory" title="Link to this definition"></a></dt>
<dd><p>Directory path for interpolator JSON files.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>interpolator_directory</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Path to directory containing interpolator data files.</p>
<p>default: ‘./interpolator_json’</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.LeR.ler_directory">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ler_directory</span></span><a class="headerlink" href="#ler.rates.LeR.ler_directory" title="Link to this definition"></a></dt>
<dd><p>Directory path for LeR output files.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ler_directory</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Path to directory for storing output parameter files.</p>
<p>default: ‘./ler_data’</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.LeR.create_new_interpolator">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_new_interpolator</span></span><a class="headerlink" href="#ler.rates.LeR.create_new_interpolator" title="Link to this definition"></a></dt>
<dd><p>Configuration dictionary for interpolator creation settings.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>create_new_interpolator</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary specifying which interpolators to create.</p>
<p>Each key is an interpolator name, and values are dicts with:</p>
<ul class="simple">
<li><p>‘create_new’: bool - Whether to create new interpolator</p></li>
<li><p>‘resolution’: int or list - Grid resolution for interpolation</p></li>
</ul>
<p>Special key ‘gwsnr’ is a bool for GWSNR interpolator creation.
Default: dict(</p>
<blockquote>
<div><p>merger_rate_density = {‘create_new’: False, ‘resolution’: 500},
redshift_distribution = {‘create_new’: False, ‘resolution’: 500},
luminosity_distance = {‘create_new’: False, ‘resolution’: 500},
differential_comoving_volume = {‘create_new’: False, ‘resolution’: 500},
source_frame_masses = {‘create_new’: False, ‘resolution’: 500},
geocent_time = {‘create_new’: False, ‘resolution’: 500},
ra = {‘create_new’: False, ‘resolution’: 500},
dec = {‘create_new’: False, ‘resolution’: 500},
phase = {‘create_new’: False, ‘resolution’: 500},
psi = {‘create_new’: False, ‘resolution’: 500},
theta_jn = {‘create_new’: False, ‘resolution’: 500},
a_1 = {‘create_new’: False, ‘resolution’: 500},
a_2 = {‘create_new’: False, ‘resolution’: 500},
tilt_1 = {‘create_new’: False, ‘resolution’: 500},
tilt_2 = {‘create_new’: False, ‘resolution’: 500},
phi_12 = {‘create_new’: False, ‘resolution’: 500},
phi_jl = {‘create_new’: False, ‘resolution’: 500},
velocity_dispersion = {‘create_new’: False, ‘resolution’: 500, ‘zl_resolution’: 48},
axis_ratio = {‘create_new’: False, ‘resolution’: 500, ‘sigma_resolution’: 48},
lens_redshift = {‘create_new’: False, ‘resolution’: 48, ‘zl_resolution’: 48},
lens_redshift_intrinsic = {‘create_new’: False, ‘resolution’: 500},
optical_depth = {‘create_new’: False, ‘resolution’: 48},
comoving_distance = {‘create_new’: False, ‘resolution’: 500},
angular_diameter_distance = {‘create_new’: False, ‘resolution’: 500},
angular_diameter_distance_z1z2 = {‘create_new’: False, ‘resolution’: 500},
density_profile_slope = {‘create_new’: False, ‘resolution’: 100},
lens_parameters_kde_sl = {‘create_new’: False, ‘resolution’: 5000},
cross_section = {‘create_new’: False, ‘resolution’: [25, 25, 45, 15, 15]},
gwsnr = False,</p>
</div></blockquote>
<p>)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.LeR.pdet_finder">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pdet_finder</span></span><a class="headerlink" href="#ler.rates.LeR.pdet_finder" title="Link to this definition"></a></dt>
<dd><p>Detection probability finder function.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>pdet_finder</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">callable</span></code></span></dt><dd><p>Function that calculates detection probability for GW events.</p>
<p>The function signature should be:</p>
<p><code class="docutils literal notranslate"><span class="pre">pdet_finder(gw_param_dict)</span> <span class="pre">-&gt;</span> <span class="pre">dict</span></code> with key ‘pdet_net’.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.LeR.ler_args">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ler_args</span></span><a class="headerlink" href="#ler.rates.LeR.ler_args" title="Link to this definition"></a></dt>
<dd><p>Dictionary of all LeR initialization arguments.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ler_args</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary containing all parameters used to initialize LeR and</p>
<p>its parent classes, useful for reproducibility.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.LeR.unlensed_cbc_statistics">
<span class="sig-name descname"><span class="pre">unlensed_cbc_statistics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_jsonfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/rates/ler.html#LeR.unlensed_cbc_statistics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.LeR.unlensed_cbc_statistics" title="Link to this definition"></a></dt>
<dd><p>Generate unlensed GW source parameters.</p>
<p>This function calls the unlensed_sampling_routine function to generate
the parameters in batches. The generated parameters are stored in a JSON
file; and if save_batch=True, it keeps updating the file in batches.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of samples to generate.</p>
<p>default: 100000</p>
</dd>
<dt><strong>batch_size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Batch size for sampling.</p>
<p>default: 50000</p>
</dd>
<dt><strong>resume</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, the function will resume from the last batch.</p>
<p>default: True</p>
</dd>
<dt><strong>save_batch</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, saves parameters in batches during sampling.</p>
<p>If False, saves all parameters at the end (faster).</p>
<p>default: False</p>
</dd>
<dt><strong>output_jsonfile</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>JSON file name for storing the parameters.</p>
<p>default: None (uses self.json_file_names[“unlensed_param”])</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>unlensed_param</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary of unlensed GW source parameters. The included parameters and their units are as follows (for default settings):</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>zs</p></td>
<td></td>
<td><p>redshift of the source</p></td>
</tr>
<tr class="row-odd"><td><p>geocent_time</p></td>
<td><p>s</p></td>
<td><p>GPS time of coalescence</p></td>
</tr>
<tr class="row-even"><td><p>ra</p></td>
<td><p>rad</p></td>
<td><p>right ascension</p></td>
</tr>
<tr class="row-odd"><td><p>dec</p></td>
<td><p>rad</p></td>
<td><p>declination</p></td>
</tr>
<tr class="row-even"><td><p>phase</p></td>
<td><p>rad</p></td>
<td><p>phase of GW at reference frequency</p></td>
</tr>
<tr class="row-odd"><td><p>psi</p></td>
<td><p>rad</p></td>
<td><p>polarization angle</p></td>
</tr>
<tr class="row-even"><td><p>theta_jn</p></td>
<td><p>rad</p></td>
<td><p>inclination angle</p></td>
</tr>
<tr class="row-odd"><td><p>a_1</p></td>
<td></td>
<td><p>spin_1 of the compact binary</p></td>
</tr>
<tr class="row-even"><td><p>a_2</p></td>
<td></td>
<td><p>spin_2 of the compact binary</p></td>
</tr>
<tr class="row-odd"><td><p>luminosity_distance</p></td>
<td><p>Mpc</p></td>
<td><p>luminosity distance</p></td>
</tr>
<tr class="row-even"><td><p>mass_1_source</p></td>
<td><p>Msun</p></td>
<td><p>mass_1 of the compact binary
(source frame)</p></td>
</tr>
<tr class="row-odd"><td><p>mass_2_source</p></td>
<td><p>Msun</p></td>
<td><p>mass_2 of the compact binary
(source frame)</p></td>
</tr>
<tr class="row-even"><td><p>mass_1</p></td>
<td><p>Msun</p></td>
<td><p>mass_1 of the compact binary
(detector frame)</p></td>
</tr>
<tr class="row-odd"><td><p>mass_2</p></td>
<td><p>Msun</p></td>
<td><p>mass_2 of the compact binary
(detector frame)</p></td>
</tr>
<tr class="row-even"><td><p>pdet_L1</p></td>
<td></td>
<td><p>pdet of L1</p></td>
</tr>
<tr class="row-odd"><td><p>pdet_H1</p></td>
<td></td>
<td><p>pdet of H1</p></td>
</tr>
<tr class="row-even"><td><p>pdet_V1</p></td>
<td></td>
<td><p>pdet of V1</p></td>
</tr>
<tr class="row-odd"><td><p>pdet_net</p></td>
<td></td>
<td><p>pdet of the network</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler</span> <span class="kn">import</span> <span class="n">LeR</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ler</span> <span class="o">=</span> <span class="n">LeR</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unlensed_param</span> <span class="o">=</span> <span class="n">ler</span><span class="o">.</span><span class="n">unlensed_cbc_statistics</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.LeR.unlensed_sampling_routine">
<span class="sig-name descname"><span class="pre">unlensed_sampling_routine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_jsonfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/rates/ler.html#LeR.unlensed_sampling_routine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.LeR.unlensed_sampling_routine" title="Link to this definition"></a></dt>
<dd><p>Generate unlensed GW source parameters for a single batch.</p>
<p>This is the core sampling routine called by unlensed_cbc_statistics.
It samples GW source parameters and calculates detection probabilities.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of samples to generate.</p>
</dd>
<dt><strong>output_jsonfile</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>JSON file name for storing the parameters.</p>
</dd>
<dt><strong>resume</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, appends new samples to existing JSON file.</p>
<p>default: True</p>
</dd>
<dt><strong>save_batch</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, saves parameters in batches during sampling.</p>
<p>default: True</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>unlensed_param</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary of unlensed GW source parameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.LeR.unlensed_rate">
<span class="sig-name descname"><span class="pre">unlensed_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unlensed_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdet_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdet_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'boolean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_jsonfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/rates/ler.html#LeR.unlensed_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.LeR.unlensed_rate" title="Link to this definition"></a></dt>
<dd><p>Function to calculate the unlensed rate.</p>
<p>This function calculates the detection rate for unlensed events and stores
the parameters of the detectable events in a JSON file.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>unlensed_param</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Dictionary of GW source parameters or JSON file name.</p>
<p>default: None (uses self.json_file_names[“unlensed_param”])</p>
</dd>
<dt><strong>pdet_threshold</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Threshold for detection probability.</p>
<p>default: 0.5</p>
</dd>
<dt><strong>pdet_type</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Detectability condition type.</p>
<p>Options:</p>
<ul class="simple">
<li><p>‘boolean’: Binary detection based on pdet_threshold</p></li>
<li><p>‘probability_distribution’: Uses pdet values directly</p></li>
</ul>
<p>default: ‘boolean’</p>
</dd>
<dt><strong>output_jsonfile</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>JSON file name for storing the parameters of the detectable events.</p>
<p>default: None (uses self.json_file_names[“unlensed_param_detectable”])</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>total_rate</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Total unlensed rate (yr^-1).</p>
</dd>
<dt><strong>unlensed_param</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary of unlensed GW source parameters of the detectable events.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler</span> <span class="kn">import</span> <span class="n">LeR</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ler</span> <span class="o">=</span> <span class="n">LeR</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ler</span><span class="o">.</span><span class="n">unlensed_cbc_statistics</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total_rate</span><span class="p">,</span> <span class="n">unlensed_param_detectable</span> <span class="o">=</span> <span class="n">ler</span><span class="o">.</span><span class="n">unlensed_rate</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.LeR.rate_function">
<span class="sig-name descname"><span class="pre">rate_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">detectable_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'unlensed'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/rates/ler.html#LeR.rate_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.LeR.rate_function" title="Link to this definition"></a></dt>
<dd><p>Calculate the detection rate for unlensed or lensed events.</p>
<p>This is a general helper function that computes the rate based on
Monte Carlo integration using the ratio of detectable to total events.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>detectable_size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Number of detectable events (or sum of pdet values).</p>
</dd>
<dt><strong>total_size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Total number of simulated events.</p>
</dd>
<dt><strong>param_type</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Type of parameters.</p>
<p>Options:</p>
<ul class="simple">
<li><p>‘unlensed’: Use unlensed normalization</p></li>
<li><p>‘lensed’: Use lensed normalization</p></li>
</ul>
<p>default: ‘unlensed’</p>
</dd>
<dt><strong>verbose</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, print rate information.</p>
<p>default: True</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>rate</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Event rate (yr^-1).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler</span> <span class="kn">import</span> <span class="n">LeR</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ler</span> <span class="o">=</span> <span class="n">LeR</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rate</span> <span class="o">=</span> <span class="n">ler</span><span class="o">.</span><span class="n">rate_function</span><span class="p">(</span><span class="n">detectable_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">total_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.LeR.lensed_cbc_statistics">
<span class="sig-name descname"><span class="pre">lensed_cbc_statistics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_jsonfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/rates/ler.html#LeR.lensed_cbc_statistics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.LeR.lensed_cbc_statistics" title="Link to this definition"></a></dt>
<dd><p>Generate lensed GW source parameters.</p>
<p>This function calls the lensed_sampling_routine function to generate
the parameters in batches. The generated parameters are stored in a JSON
file; and if save_batch=True, it keeps updating the file in batches.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of samples to generate.</p>
<p>default: 100000</p>
</dd>
<dt><strong>batch_size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Batch size for sampling.</p>
<p>default: 50000</p>
</dd>
<dt><strong>save_batch</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, saves parameters in batches during sampling.</p>
<p>If False, saves all parameters at the end (faster).</p>
<p>default: True</p>
</dd>
<dt><strong>resume</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, the function will resume from the last batch.</p>
<p>default: True</p>
</dd>
<dt><strong>output_jsonfile</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>JSON file name for storing the parameters.</p>
<p>default: None (uses self.json_file_names[“lensed_param”])</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>lensed_param</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary of lensed GW source parameters. The included parameters and their units are as follows (for default settings):</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler</span> <span class="kn">import</span> <span class="n">LeR</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ler</span> <span class="o">=</span> <span class="n">LeR</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lensed_param</span> <span class="o">=</span> <span class="n">ler</span><span class="o">.</span><span class="n">lensed_cbc_statistics</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.LeR.lensed_sampling_routine">
<span class="sig-name descname"><span class="pre">lensed_sampling_routine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_jsonfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/rates/ler.html#LeR.lensed_sampling_routine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.LeR.lensed_sampling_routine" title="Link to this definition"></a></dt>
<dd><p>Generate lensed GW source parameters for a single batch.</p>
<p>This is the core sampling routine called by lensed_cbc_statistics.
It samples lens parameters, calculates image properties, and computes
detection probabilities for the images of lensed events.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of samples to generate.</p>
</dd>
<dt><strong>output_jsonfile</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>JSON file name for storing the parameters.</p>
</dd>
<dt><strong>save_batch</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, saves parameters in batches during sampling.</p>
<p>default: True</p>
</dd>
<dt><strong>resume</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, appends new samples to existing JSON file.</p>
<p>default: True</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>lensed_param</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary of lensed GW source parameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.LeR.lensed_rate">
<span class="sig-name descname"><span class="pre">lensed_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lensed_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdet_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.5,</span> <span class="pre">0.5]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_img</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_jsonfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nan_to_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdet_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'boolean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/rates/ler.html#LeR.lensed_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.LeR.lensed_rate" title="Link to this definition"></a></dt>
<dd><p>Function to calculate the lensed rate.</p>
<p>This function calculates the detection rate for lensed events and stores
the parameters of the detectable events in a JSON file.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>lensed_param</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Dictionary of lensed GW source parameters or JSON file name.</p>
<p>default: None (uses self.json_file_names[“lensed_param”])</p>
</dd>
<dt><strong>pdet_threshold</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code></span></dt><dd><p>Threshold for detection probability.</p>
<p>default: [0.5, 0.5]</p>
</dd>
<dt><strong>num_img</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code></span></dt><dd><p>Number of images corresponding to the pdet_threshold.</p>
<p>Together with pdet_threshold = [0.5, 0.5], it means that two images with pdet &gt; 0.5.</p>
<p>Same condition can also be represented by pdet_threshold = 0.5 and num_img = 2.</p>
<p>default: [1, 1]</p>
</dd>
<dt><strong>output_jsonfile</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>JSON file name for storing the parameters of the detectable events.</p>
<p>default: None (uses self.json_file_names[“lensed_param_detectable”])</p>
</dd>
<dt><strong>nan_to_num</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, NaN values will be converted to 0.</p>
<p>default: True</p>
</dd>
<dt><strong>pdet_type</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Detectability condition type.</p>
<p>Options:</p>
<ul class="simple">
<li><p>‘boolean’: Binary detection based on pdet_threshold</p></li>
<li><p>‘probability_distribution’: Uses pdet values directly</p></li>
</ul>
<p>default: ‘boolean’</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>total_rate</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Total lensed rate (yr^-1).</p>
</dd>
<dt><strong>lensed_param</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary of lensed GW source parameters of the detectable events. The included parameters and their units are as follows (for default settings):</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler</span> <span class="kn">import</span> <span class="n">LeR</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ler</span> <span class="o">=</span> <span class="n">LeR</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ler</span><span class="o">.</span><span class="n">lensed_cbc_statistics</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total_rate</span><span class="p">,</span> <span class="n">lensed_param_detectable</span> <span class="o">=</span> <span class="n">ler</span><span class="o">.</span><span class="n">lensed_rate</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.LeR.rate_comparison_with_rate_calculation">
<span class="sig-name descname"><span class="pre">rate_comparison_with_rate_calculation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unlensed_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdet_threshold_unlensed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_jsonfile_unlensed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lensed_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdet_threshold_lensed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.5,</span> <span class="pre">0.5]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_img_lensed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_jsonfile_lensed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nan_to_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdet_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'boolean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/rates/ler.html#LeR.rate_comparison_with_rate_calculation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.LeR.rate_comparison_with_rate_calculation" title="Link to this definition"></a></dt>
<dd><p>Calculate and compare unlensed and lensed detection rates.</p>
<p>This function calculates both unlensed and lensed rates and computes
their ratio. It stores the parameters of the detectable events in JSON
files. Using this function eliminates the need to call unlensed_rate
and lensed_rate separately.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>unlensed_param</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Dictionary of GW source parameters or JSON file name.</p>
<p>default: None (uses self.json_file_names[“unlensed_param”])</p>
</dd>
<dt><strong>pdet_threshold_unlensed</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Detection probability threshold for unlensed events.</p>
<p>default: 0.5</p>
</dd>
<dt><strong>output_jsonfile_unlensed</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>JSON file name for storing detectable unlensed parameters.</p>
<p>default: None</p>
</dd>
<dt><strong>lensed_param</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Dictionary of lensed GW source parameters or JSON file name.</p>
<p>default: None (uses self.json_file_names[“lensed_param”])</p>
</dd>
<dt><strong>pdet_threshold_lensed</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code></span></dt><dd><p>Detection probability threshold for lensed events.</p>
<p>default: [0.5, 0.5]</p>
</dd>
<dt><strong>num_img_lensed</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">list</span></code></span></dt><dd><p>Number of images for lensed events.</p>
<p>default: [1, 1]</p>
</dd>
<dt><strong>output_jsonfile_lensed</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>JSON file name for storing detectable lensed parameters.</p>
<p>default: None</p>
</dd>
<dt><strong>nan_to_num</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, NaN values will be converted to 0.</p>
<p>default: True</p>
</dd>
<dt><strong>pdet_type</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Detectability condition type.</p>
<p>Options:</p>
<ul class="simple">
<li><p>‘boolean’: Binary detection based on pdet_threshold</p></li>
<li><p>‘probability_distribution’: Uses pdet values directly</p></li>
</ul>
<p>default: ‘boolean’</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>rate_ratio</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Ratio of unlensed rate to lensed rate.</p>
</dd>
<dt><strong>unlensed_param_detectable</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary of detectable unlensed GW source parameters.</p>
</dd>
<dt><strong>lensed_param_detectable</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary of detectable lensed GW source parameters.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler</span> <span class="kn">import</span> <span class="n">LeR</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ler</span> <span class="o">=</span> <span class="n">LeR</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ler</span><span class="o">.</span><span class="n">unlensed_cbc_statistics</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ler</span><span class="o">.</span><span class="n">lensed_cbc_statistics</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rate_ratio</span><span class="p">,</span> <span class="n">unlensed_param</span><span class="p">,</span> <span class="n">lensed_param</span> <span class="o">=</span> <span class="n">ler</span><span class="o">.</span><span class="n">rate_comparison_with_rate_calculation</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.LeR.rate_ratio">
<span class="sig-name descname"><span class="pre">rate_ratio</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/rates/ler.html#LeR.rate_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.LeR.rate_ratio" title="Link to this definition"></a></dt>
<dd><p>Calculate and display the unlensed to lensed merger rate ratio.</p>
<p>This function retrieves the unlensed_rate and lensed_rate from the
JSON file specified in self.json_file_names[“ler_params”] and computes
their ratio.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>rate_ratio</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Ratio of unlensed rate to lensed rate.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler</span> <span class="kn">import</span> <span class="n">LeR</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ler</span> <span class="o">=</span> <span class="n">LeR</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ler</span><span class="o">.</span><span class="n">unlensed_cbc_statistics</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ler</span><span class="o">.</span><span class="n">lensed_cbc_statistics</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ler</span><span class="o">.</span><span class="n">unlensed_rate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ler</span><span class="o">.</span><span class="n">lensed_rate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ler</span><span class="o">.</span><span class="n">rate_ratio</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.LeR.selecting_n_unlensed_detectable_events">
<span class="sig-name descname"><span class="pre">selecting_n_unlensed_detectable_events</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopping_criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">dict(relative_diff_percentage=0.5,</span> <span class="pre">number_of_last_batches_to_check=4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdet_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_jsonfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'n_unlensed_param_detectable.json'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_data_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'meta_unlensed.json'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdet_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'boolean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trim_to_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/rates/ler.html#LeR.selecting_n_unlensed_detectable_events"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.LeR.selecting_n_unlensed_detectable_events" title="Link to this definition"></a></dt>
<dd><p>Generate a target number of detectable unlensed events by sampling in batches, with the option to stop once the cumulative rate has stabilized.</p>
<p>This function samples unlensed parameters and saves only the detectable
events in a JSON file. It also records metadata including the total
number of events and the cumulative rate.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Target number of detectable samples to collect.</p>
<p>default: 100</p>
</dd>
<dt><strong>batch_size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Batch size for sampling.</p>
<p>default: 50000</p>
</dd>
<dt><strong>stopping_criteria</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Criteria for stopping sample collection (but will not stop until n&gt;size).</p>
<p>Keys:</p>
<ul class="simple">
<li><p>‘relative_diff_percentage’: Maximum relative difference in rate (float)</p></li>
<li><p>‘number_of_last_batches_to_check’: Number of batches for comparison (int)</p></li>
</ul>
<p>If None, stops when detectable events exceed size.</p>
<p>default: dict(relative_diff_percentage=0.5, number_of_last_batches_to_check=4)</p>
</dd>
<dt><strong>pdet_threshold</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Detection probability threshold.</p>
<p>default: 0.5</p>
</dd>
<dt><strong>resume</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, resumes from last saved batch.</p>
<p>default: True</p>
</dd>
<dt><strong>output_jsonfile</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>JSON file name for storing detectable parameters.</p>
<p>default: ‘n_unlensed_param_detectable.json’</p>
</dd>
<dt><strong>meta_data_file</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>JSON file name for storing metadata.</p>
<p>default: ‘meta_unlensed.json’</p>
</dd>
<dt><strong>pdet_type</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Detectability condition type.</p>
<p>Options:</p>
<ul class="simple">
<li><p>‘boolean’: Binary detection based on pdet_threshold</p></li>
<li><p>‘probability_distribution’: Uses pdet values directly</p></li>
</ul>
<p>default: ‘boolean’</p>
</dd>
<dt><strong>trim_to_size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, trims final result to exactly size events.</p>
<p>default: False</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>param_final</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary of unlensed GW source parameters of detectable events.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler</span> <span class="kn">import</span> <span class="n">LeR</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ler</span> <span class="o">=</span> <span class="n">LeR</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unlensed_param</span> <span class="o">=</span> <span class="n">ler</span><span class="o">.</span><span class="n">selecting_n_unlensed_detectable_events</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.LeR.selecting_n_lensed_detectable_events">
<span class="sig-name descname"><span class="pre">selecting_n_lensed_detectable_events</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopping_criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">dict(relative_diff_percentage=2,</span> <span class="pre">number_of_last_batches_to_check=4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdet_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.5,</span> <span class="pre">0.5]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_img</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdet_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'boolean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_jsonfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'n_lensed_params_detectable.json'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_data_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'meta_lensed.json'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trim_to_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nan_to_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/rates/ler.html#LeR.selecting_n_lensed_detectable_events"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.LeR.selecting_n_lensed_detectable_events" title="Link to this definition"></a></dt>
<dd><p>Generate a target number of detectable lensed events by sampling in batches, with the option to stop once the cumulative rate has stabilized.</p>
<p>This function samples lensed parameters and saves only the detectable
events in a JSON file. It also records metadata including the total
number of events and the cumulative rate.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Target number of detectable samples to collect.</p>
<p>default: 100</p>
</dd>
<dt><strong>stopping_criteria</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Criteria for stopping sample collection (but will not stop until n&gt;size).</p>
<p>Keys:</p>
<ul class="simple">
<li><p>‘relative_diff_percentage’: Maximum relative difference in rate (float)</p></li>
<li><p>‘number_of_last_batches_to_check’: Number of batches for comparison (int)</p></li>
</ul>
<p>If None, stops when detectable events exceed size.</p>
<p>default: dict(relative_diff_percentage=2, number_of_last_batches_to_check=4)</p>
</dd>
<dt><strong>batch_size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Batch size for sampling.</p>
<p>default: 50000</p>
</dd>
<dt><strong>pdet_threshold</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code> or <code class="docutils literal notranslate"><span class="pre">list</span></code></span></dt><dd><p>Detection probability threshold.</p>
<p>default: [0.5, 0.5]</p>
</dd>
<dt><strong>num_img</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">list</span></code></span></dt><dd><p>Number of images corresponding to each pdet_threshold.</p>
<p>default: [1, 1]</p>
</dd>
<dt><strong>resume</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, resumes from last saved batch.</p>
<p>default: True</p>
</dd>
<dt><strong>pdet_type</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Detectability condition type.</p>
<p>Options:</p>
<ul class="simple">
<li><p>‘boolean’: Binary detection based on pdet_threshold</p></li>
<li><p>‘probability_distribution’: Uses pdet values directly</p></li>
</ul>
<p>default: ‘boolean’</p>
</dd>
<dt><strong>output_jsonfile</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>JSON file name for storing detectable parameters.</p>
<p>default: ‘n_lensed_params_detectable.json’</p>
</dd>
<dt><strong>meta_data_file</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>JSON file name for storing metadata.</p>
<p>default: ‘meta_lensed.json’</p>
</dd>
<dt><strong>trim_to_size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, trims final result to exactly size events.</p>
<p>default: False</p>
</dd>
<dt><strong>nan_to_num</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, NaN values will be converted to 0.</p>
<p>default: False</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>param_final</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary of lensed GW source parameters of detectable events.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler</span> <span class="kn">import</span> <span class="n">LeR</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ler</span> <span class="o">=</span> <span class="n">LeR</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lensed_param</span> <span class="o">=</span> <span class="n">ler</span><span class="o">.</span><span class="n">selecting_n_lensed_detectable_events</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ler.rates.</span></span><span class="sig-name descname"><span class="pre">CBCSourceParameterDistribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BBH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_priors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_priors_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmology</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_precession</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./interpolator_json'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_new_interpolator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/gw_source_population/cbc_source_parameter_distribution.html#CBCSourceParameterDistribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../gw_source_population/cbc_source_redshift_distribution/index.html#ler.gw_source_population.cbc_source_redshift_distribution.CBCSourceRedshiftDistribution" title="ler.gw_source_population.cbc_source_redshift_distribution.CBCSourceRedshiftDistribution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ler.gw_source_population.cbc_source_redshift_distribution.CBCSourceRedshiftDistribution</span></code></a></p>
<p>Class for sampling compact binary coalescence source parameters.</p>
<p>This class generates complete sets of intrinsic and extrinsic gravitational
wave parameters for compact binary sources including masses, spins, sky
positions, and orbital parameters. It supports BBH, BNS, NSBH, and primordial
black hole populations with configurable prior distributions.</p>
<p>Key Features:</p>
<ul class="simple">
<li><p>Multiple mass distribution models (PowerLaw+Gaussian, lognormal, bimodal)</p></li>
<li><p>Configurable spin priors (zero, aligned, precessing)</p></li>
<li><p>Isotropic sky position and orientation sampling</p></li>
<li><p>Built-in support for population III and primordial black holes</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>z_min</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Minimum redshift of the source population.</p>
<p>default: 0.0</p>
</dd>
<dt><strong>z_max</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Maximum redshift of the source population.</p>
<p>default: 10.0</p>
</dd>
<dt><strong>event_type</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Type of compact binary event to generate.</p>
<p>Options:</p>
<ul class="simple">
<li><p>‘BBH’: Binary black hole (Population I/II)</p></li>
<li><p>‘BNS’: Binary neutron star</p></li>
<li><p>‘NSBH’: Neutron star-black hole</p></li>
<li><p>‘BBH_popIII’: Population III binary black hole</p></li>
<li><p>‘BBH_primordial’: Primordial binary black hole</p></li>
</ul>
<p>default: ‘BBH’</p>
</dd>
<dt><strong>source_priors</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Dictionary of prior sampler functions for each parameter.</p>
<p>If None, uses default priors based on event_type.</p>
<p>default: None</p>
</dd>
<dt><strong>source_priors_params</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Dictionary of parameters for each prior sampler function.</p>
<p>If None, uses default parameters based on event_type.</p>
<p>default: None</p>
</dd>
<dt><strong>cosmology</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">astropy.cosmology</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Cosmology to use for distance calculations.</p>
<p>default: LambdaCDM(H0=70, Om0=0.3, Ode0=0.7, Tcmb0=0.0, Neff=3.04, m_nu=None, Ob0=0.0)</p>
</dd>
<dt><strong>spin_zero</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, spin parameters are set to zero (no spin sampling).</p>
<p>default: False</p>
</dd>
<dt><strong>spin_precession</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True (and spin_zero=False), sample precessing spin parameters.</p>
<p>If False (and spin_zero=False), sample aligned/anti-aligned spins.</p>
<p>default: False</p>
</dd>
<dt><strong>directory</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Directory to store interpolator JSON files.</p>
<p>default: ‘./interpolator_json’</p>
</dd>
<dt><strong>create_new_interpolator</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code> or <code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>Configuration for creating new interpolators.</p>
<p>If bool, applies to all interpolators.</p>
<p>default: False</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler.gw_source_population</span> <span class="kn">import</span> <span class="n">CBCSourceParameterDistribution</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cbc</span> <span class="o">=</span> <span class="n">CBCSourceParameterDistribution</span><span class="p">(</span><span class="n">event_type</span><span class="o">=</span><span class="s1">&#39;BBH&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">cbc</span><span class="o">.</span><span class="n">sample_gw_parameters</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</pre></div>
</div>
<section id="id3">
<h4>Instance Methods<a class="headerlink" href="#id3" title="Link to this heading"></a></h4>
<p>CBCSourceParameterDistribution has the following methods:</p>
</section>
<section id="id4">
<h4>Instance Attributes<a class="headerlink" href="#id4" title="Link to this heading"></a></h4>
<p>CBCSourceParameterDistribution has the following attributes:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.CBCSourceParameterDistribution.z_min" title="ler.rates.CBCSourceParameterDistribution.z_min"><code class="xref py py-attr docutils literal notranslate"><span class="pre">z_min</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td></td>
<td><p>Minimum redshift of source population</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.CBCSourceParameterDistribution.z_max" title="ler.rates.CBCSourceParameterDistribution.z_max"><code class="xref py py-attr docutils literal notranslate"><span class="pre">z_max</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td></td>
<td><p>Maximum redshift of source population</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.CBCSourceParameterDistribution.cosmo" title="ler.rates.CBCSourceParameterDistribution.cosmo"><code class="xref py py-attr docutils literal notranslate"><span class="pre">cosmo</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">astropy.cosmology</span></code></p></td>
<td></td>
<td><p>Cosmology for distance calculations</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.CBCSourceParameterDistribution.spin_zero" title="ler.rates.CBCSourceParameterDistribution.spin_zero"><code class="xref py py-attr docutils literal notranslate"><span class="pre">spin_zero</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bool</span></code></p></td>
<td></td>
<td><p>Whether to ignore spin parameters</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.CBCSourceParameterDistribution.spin_precession" title="ler.rates.CBCSourceParameterDistribution.spin_precession"><code class="xref py py-attr docutils literal notranslate"><span class="pre">spin_precession</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bool</span></code></p></td>
<td></td>
<td><p>Whether to use precessing spins</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.CBCSourceParameterDistribution.directory" title="ler.rates.CBCSourceParameterDistribution.directory"><code class="xref py py-attr docutils literal notranslate"><span class="pre">directory</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p></td>
<td></td>
<td><p>Directory for interpolator files</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">gw_param_samplers</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p></td>
<td></td>
<td><p>Dictionary of parameter sampler functions</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">gw_param_samplers_params</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p></td>
<td></td>
<td><p>Dictionary of sampler function parameters</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.CBCSourceParameterDistribution.available_gw_prior" title="ler.rates.CBCSourceParameterDistribution.available_gw_prior"><code class="xref py py-attr docutils literal notranslate"><span class="pre">available_gw_prior</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p></td>
<td></td>
<td><p>Available prior distributions</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.CBCSourceParameterDistribution.source_frame_masses" title="ler.rates.CBCSourceParameterDistribution.source_frame_masses"><code class="xref py py-attr docutils literal notranslate"><span class="pre">source_frame_masses</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">callable</span></code></p></td>
<td></td>
<td><p>Sampler for source frame masses</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.CBCSourceParameterDistribution.zs" title="ler.rates.CBCSourceParameterDistribution.zs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">zs</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">callable</span></code></p></td>
<td></td>
<td><p>Sampler for source redshift</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.CBCSourceParameterDistribution.geocent_time" title="ler.rates.CBCSourceParameterDistribution.geocent_time"><code class="xref py py-attr docutils literal notranslate"><span class="pre">geocent_time</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">callable</span></code></p></td>
<td></td>
<td><p>Sampler for geocentric time</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.CBCSourceParameterDistribution.ra" title="ler.rates.CBCSourceParameterDistribution.ra"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ra</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">callable</span></code></p></td>
<td></td>
<td><p>Sampler for right ascension</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.CBCSourceParameterDistribution.dec" title="ler.rates.CBCSourceParameterDistribution.dec"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dec</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">callable</span></code></p></td>
<td></td>
<td><p>Sampler for declination</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.CBCSourceParameterDistribution.phase" title="ler.rates.CBCSourceParameterDistribution.phase"><code class="xref py py-attr docutils literal notranslate"><span class="pre">phase</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">callable</span></code></p></td>
<td></td>
<td><p>Sampler for coalescence phase</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.CBCSourceParameterDistribution.psi" title="ler.rates.CBCSourceParameterDistribution.psi"><code class="xref py py-attr docutils literal notranslate"><span class="pre">psi</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">callable</span></code></p></td>
<td></td>
<td><p>Sampler for polarization angle</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.CBCSourceParameterDistribution.theta_jn" title="ler.rates.CBCSourceParameterDistribution.theta_jn"><code class="xref py py-attr docutils literal notranslate"><span class="pre">theta_jn</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">callable</span></code></p></td>
<td></td>
<td><p>Sampler for inclination angle</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.CBCSourceParameterDistribution.a_1" title="ler.rates.CBCSourceParameterDistribution.a_1"><code class="xref py py-attr docutils literal notranslate"><span class="pre">a_1</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">callable</span></code></p></td>
<td></td>
<td><p>Sampler for spin1 magnitude</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.CBCSourceParameterDistribution.a_2" title="ler.rates.CBCSourceParameterDistribution.a_2"><code class="xref py py-attr docutils literal notranslate"><span class="pre">a_2</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">callable</span></code></p></td>
<td></td>
<td><p>Sampler for spin2 magnitude</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.CBCSourceParameterDistribution.tilt_1" title="ler.rates.CBCSourceParameterDistribution.tilt_1"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tilt_1</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">callable</span></code></p></td>
<td></td>
<td><p>Sampler for tilt1 angle</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.CBCSourceParameterDistribution.tilt_2" title="ler.rates.CBCSourceParameterDistribution.tilt_2"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tilt_2</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">callable</span></code></p></td>
<td></td>
<td><p>Sampler for tilt2 angle</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.CBCSourceParameterDistribution.phi_12" title="ler.rates.CBCSourceParameterDistribution.phi_12"><code class="xref py py-attr docutils literal notranslate"><span class="pre">phi_12</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">callable</span></code></p></td>
<td></td>
<td><p>Sampler for phi_12 angle</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.CBCSourceParameterDistribution.phi_jl" title="ler.rates.CBCSourceParameterDistribution.phi_jl"><code class="xref py py-attr docutils literal notranslate"><span class="pre">phi_jl</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">callable</span></code></p></td>
<td></td>
<td><p>Sampler for phi_jl angle</p></td>
</tr>
</tbody>
</table>
<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.zs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">zs</span></span><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.zs" title="Link to this definition"></a></dt>
<dd><p>Class object (of FunctionConditioning) for source redshift, with rvs/sampler as callback. Can also be a user defined callable sampler.</p>
<p>The class object contains the following attribute methods:</p>
<ul class="simple">
<li><p><cite>rvs</cite>: returns random samples from the redshift distribution</p></li>
<li><p><cite>pdf</cite>: returns the probability density function of the redshift distribution</p></li>
<li><p><cite>function</cite>: returns the redshift distribution function.</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>zs</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of redshift values.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.source_frame_masses">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">source_frame_masses</span></span><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.source_frame_masses" title="Link to this definition"></a></dt>
<dd><p>Class object (of FunctionConditioning) for source frame masses, with rvs/sampler as callback. Can also be a user defined callable sampler.</p>
<p>The class object contains the following attribute methods:</p>
<ul class="simple">
<li><p><cite>rvs</cite>: returns random samples from the density profile slope distribution</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>mass_1_source</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of mass_1_source values in solar masses.</p>
</dd>
<dt><strong>mass_2_source</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of mass_2_source values in solar masses.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler.gw_source_population</span> <span class="kn">import</span> <span class="n">CBCSourceParameterDistribution</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cbc_source_param_dist</span> <span class="o">=</span> <span class="n">CBCSourceParameterDistribution</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cbc_source_param_dist</span><span class="o">.</span><span class="n">source_frame_masses</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.geocent_time">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">geocent_time</span></span><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.geocent_time" title="Link to this definition"></a></dt>
<dd><p>Class object (of FunctionConditioning) for geocentric time, with rvs/sampler as callback. Can also be a user defined callable sampler.</p>
<p>The class object contains the following attribute methods:</p>
<ul class="simple">
<li><p><cite>rvs</cite>: returns random samples from the geocentric time distribution</p></li>
<li><p><cite>pdf</cite>: returns the probability density function of the geocentric time distribution</p></li>
<li><p><cite>function</cite>: returns the geocentric time distribution function.</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>geocent_time</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of geocentric time values.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.ra">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ra</span></span><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.ra" title="Link to this definition"></a></dt>
<dd><p>Class object (of FunctionConditioning) for right ascension, with rvs/sampler as callback. Can also be a user defined callable sampler.</p>
<p>The class object contains the following attribute methods:</p>
<ul class="simple">
<li><p><cite>rvs</cite>: returns random samples from the right ascension distribution</p></li>
<li><p><cite>pdf</cite>: returns the probability density function of the right ascension distribution</p></li>
<li><p><cite>function</cite>: returns the right ascension distribution function.</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ra</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of right ascension values.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.dec">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dec</span></span><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.dec" title="Link to this definition"></a></dt>
<dd><p>Class object (of FunctionConditioning) for declination, with rvs/sampler as callback. Can also be a user defined callable sampler.</p>
<p>The class object contains the following attribute methods:</p>
<ul class="simple">
<li><p><cite>rvs</cite>: returns random samples from the declination distribution</p></li>
<li><p><cite>pdf</cite>: returns the probability density function of the declination distribution</p></li>
<li><p><cite>function</cite>: returns the declination distribution function.</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>dec</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of declination values.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.phase">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">phase</span></span><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.phase" title="Link to this definition"></a></dt>
<dd><p>Class object (of FunctionConditioning) for coalescence phase, with rvs/sampler as callback. Can also be a user defined callable sampler.</p>
<p>The class object contains the following attribute methods:</p>
<ul class="simple">
<li><p><cite>rvs</cite>: returns random samples from the coalescence phase distribution</p></li>
<li><p><cite>pdf</cite>: returns the probability density function of the coalescence phase distribution</p></li>
<li><p><cite>function</cite>: returns the coalescence phase distribution function.</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>phase</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of coalescence phase values.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.psi">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">psi</span></span><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.psi" title="Link to this definition"></a></dt>
<dd><p>Class object (of FunctionConditioning) for polarization angle, with rvs/sampler as callback. Can also be a user defined callable sampler.</p>
<p>The class object contains the following attribute methods:</p>
<ul class="simple">
<li><p><cite>rvs</cite>: returns random samples from the polarization angle distribution</p></li>
<li><p><cite>pdf</cite>: returns the probability density function of the polarization angle distribution</p></li>
<li><p><cite>function</cite>: returns the polarization angle distribution function.</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>geocent_time</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of polarization angle values.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.theta_jn">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">theta_jn</span></span><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.theta_jn" title="Link to this definition"></a></dt>
<dd><p>Class object (of FunctionConditioning) for inclination angle, with rvs/sampler as callback. Can also be a user defined callable sampler.</p>
<p>The class object contains the following attribute methods:</p>
<ul class="simple">
<li><p><cite>rvs</cite>: returns random samples from the inclination angle distribution</p></li>
<li><p><cite>pdf</cite>: returns the probability density function of the inclination angle distribution</p></li>
<li><p><cite>function</cite>: returns the inclination angle distribution function.</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>theta_jn</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of inclination angle values, i.e. the angle between the line of sight and the orbital angular momentum (rad).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.a_1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">a_1</span></span><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.a_1" title="Link to this definition"></a></dt>
<dd><p>Class object (of FunctionConditioning) for spin1 magnitude, with rvs/sampler as callback. Can also be a user defined callable sampler.</p>
<p>The class object contains the following attribute methods:</p>
<ul class="simple">
<li><p><cite>rvs</cite>: returns random samples from the spin1 magnitude distribution</p></li>
<li><p><cite>pdf</cite>: returns the probability density function of the spin1 magnitude distribution</p></li>
<li><p><cite>function</cite>: returns the spin1 magnitude distribution function.</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>a_1</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of spin magnitude values for the primary body.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.a_2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">a_2</span></span><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.a_2" title="Link to this definition"></a></dt>
<dd><p>Class object (of FunctionConditioning) for spin2 magnitude, with rvs/sampler as callback. Can also be a user defined callable sampler.</p>
<p>The class object contains the following attribute methods:</p>
<ul class="simple">
<li><p><cite>rvs</cite>: returns random samples from the spin2 magnitude distribution</p></li>
<li><p><cite>pdf</cite>: returns the probability density function of the spin2 magnitude distribution</p></li>
<li><p><cite>function</cite>: returns the spin2 magnitude distribution function.</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>a_2</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of spin magnitude values for the secondary body.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.tilt_1">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tilt_1</span></span><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.tilt_1" title="Link to this definition"></a></dt>
<dd><p>Class object (of FunctionConditioning) for tilt1 angle, with rvs/sampler as callback. Can also be a user defined callable sampler.</p>
<p>The class object contains the following attribute methods:</p>
<ul class="simple">
<li><p><cite>rvs</cite>: returns random samples from the tilt1 angle distribution</p></li>
<li><p><cite>pdf</cite>: returns the probability density function of the tilt1 angle distribution</p></li>
<li><p><cite>function</cite>: returns the tilt1 angle distribution function.</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>tilt_1</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of the spin tilt angle of the primary body, i.e. the angle between the spin vector and the orbital angular momentum for the primary body (rad).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.tilt_2">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tilt_2</span></span><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.tilt_2" title="Link to this definition"></a></dt>
<dd><p>Class object (of FunctionConditioning) for tilt2 angle, with rvs/sampler as callback. Can also be a user defined callable sampler.</p>
<p>The class object contains the following attribute methods:</p>
<ul class="simple">
<li><p><cite>rvs</cite>: returns random samples from the tilt2 angle distribution</p></li>
<li><p><cite>pdf</cite>: returns the probability density function of the tilt2 angle distribution</p></li>
<li><p><cite>function</cite>: returns the tilt2 angle distribution function.</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>tilt_2</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of the spin tilt angle of the secondary body, i.e. the angle between the spin vector and the orbital angular momentum for the secondary body (rad).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.phi_12">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">phi_12</span></span><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.phi_12" title="Link to this definition"></a></dt>
<dd><p>Class object (of FunctionConditioning) for phi_12 angle, with rvs/sampler as callback. Can also be a user defined callable sampler.</p>
<p>The class object contains the following attribute methods:</p>
<ul class="simple">
<li><p><cite>rvs</cite>: returns random samples from the phi_12 angle distribution</p></li>
<li><p><cite>pdf</cite>: returns the probability density function of the phi_12 angle distribution</p></li>
<li><p><cite>function</cite>: returns the phi_12 angle distribution function.</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>phi_12</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of the spin tilt angle between the two spins, i.e., angle between the projections of the two spins onto the orbital plane (rad).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.phi_jl">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">phi_jl</span></span><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.phi_jl" title="Link to this definition"></a></dt>
<dd><p>Class object (of FunctionConditioning) for phi_jl angle, with rvs/sampler as callback. Can also be a user defined callable sampler.</p>
<p>The class object contains the following attribute methods:</p>
<ul class="simple">
<li><p><cite>rvs</cite>: returns random samples from the phi_jl angle distribution</p></li>
<li><p><cite>pdf</cite>: returns the probability density function of the phi_jl angle distribution</p></li>
<li><p><cite>function</cite>: returns the phi_jl angle distribution function.</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>phi_jl</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of the angle values between the orientation of the total angular momentum around the orbital angular momentum (rad).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.available_gw_prior">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">available_gw_prior</span></span><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.available_gw_prior" title="Link to this definition"></a></dt>
<dd><p>Dictionary of all available prior distributions and their parameters.</p>
<p>This is a dynamically generated dictionary containing available samplers
for each GW parameter type and their default parameter values.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>available_gw_prior</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Nested dictionary organized by parameter type (e.g., ‘source_frame_masses’,</p>
<p>‘geocent_time’, etc.) with sampler names and default parameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.z_min">
<span class="sig-name descname"><span class="pre">z_min</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'None'</span></em><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.z_min" title="Link to this definition"></a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p>
<p>Minimum redshift of the source population</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.z_max">
<span class="sig-name descname"><span class="pre">z_max</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'None'</span></em><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.z_max" title="Link to this definition"></a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p>
<p>Maximum redshift of the source population</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.event_type">
<span class="sig-name descname"><span class="pre">event_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'None'</span></em><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.event_type" title="Link to this definition"></a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p>
<p>Type of event to generate.</p>
<p>e.g. ‘BBH’, ‘BNS’, ‘NSBH’</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.source_priors">
<span class="sig-name descname"><span class="pre">source_priors</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'None'</span></em><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.source_priors" title="Link to this definition"></a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p>
<p>Dictionary of prior sampler functions.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.source_priors_params">
<span class="sig-name descname"><span class="pre">source_priors_params</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'None'</span></em><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.source_priors_params" title="Link to this definition"></a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p>
<p>Dictionary of prior sampler functions’ input parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.cosmo">
<span class="sig-name descname"><span class="pre">cosmo</span></span><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.cosmo" title="Link to this definition"></a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">astropy.cosmology</span></code></p>
<p>Cosmology to use.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.spin_zero">
<span class="sig-name descname"><span class="pre">spin_zero</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'None'</span></em><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.spin_zero" title="Link to this definition"></a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">bool</span></code></p>
<p>If True, spin prior is set to zero.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.spin_precession">
<span class="sig-name descname"><span class="pre">spin_precession</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'False'</span></em><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.spin_precession" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.directory">
<span class="sig-name descname"><span class="pre">directory</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&quot;'./interpolator_json'&quot;</span></em><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.directory" title="Link to this definition"></a></dt>
<dd><p>Directory path for storing interpolator JSON files.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>directory</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Path to the interpolator storage directory.</p>
<p>default: ‘./interpolator_json’</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.sample_gw_parameters">
<span class="sig-name descname"><span class="pre">sample_gw_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/gw_source_population/cbc_source_parameter_distribution.html#CBCSourceParameterDistribution.sample_gw_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.sample_gw_parameters" title="Link to this definition"></a></dt>
<dd><p>Sample all gravitational wave parameters for compact binaries.</p>
<p>Generates a complete set of intrinsic and extrinsic parameters including
masses, redshift, luminosity distance, sky position, orientation, and
optionally spin parameters.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of samples to draw.</p>
<p>default: 1000</p>
</dd>
<dt><strong>param</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Dictionary of fixed parameter values.</p>
<p>Parameters in this dict will not be sampled.</p>
<p>default: None</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>gw_parameters</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary of sampled GW parameters. The included parameters and their units are as follows (for default settings):</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>zs</p></td>
<td></td>
<td><p>redshift of the source</p></td>
</tr>
<tr class="row-odd"><td><p>geocent_time</p></td>
<td><p>s</p></td>
<td><p>GPS time of coalescence</p></td>
</tr>
<tr class="row-even"><td><p>ra</p></td>
<td><p>rad</p></td>
<td><p>right ascension</p></td>
</tr>
<tr class="row-odd"><td><p>dec</p></td>
<td><p>rad</p></td>
<td><p>declination</p></td>
</tr>
<tr class="row-even"><td><p>phase</p></td>
<td><p>rad</p></td>
<td><p>phase of GW at reference frequency</p></td>
</tr>
<tr class="row-odd"><td><p>psi</p></td>
<td><p>rad</p></td>
<td><p>polarization angle</p></td>
</tr>
<tr class="row-even"><td><p>theta_jn</p></td>
<td><p>rad</p></td>
<td><p>inclination angle</p></td>
</tr>
<tr class="row-odd"><td><p>a_1</p></td>
<td></td>
<td><p>spin_1 of the compact binary</p></td>
</tr>
<tr class="row-even"><td><p>a_2</p></td>
<td></td>
<td><p>spin_2 of the compact binary</p></td>
</tr>
<tr class="row-odd"><td><p>luminosity_distance</p></td>
<td><p>Mpc</p></td>
<td><p>luminosity distance</p></td>
</tr>
<tr class="row-even"><td><p>mass_1_source</p></td>
<td><p>Msun</p></td>
<td><p>mass_1 of the compact binary
(source frame)</p></td>
</tr>
<tr class="row-odd"><td><p>mass_2_source</p></td>
<td><p>Msun</p></td>
<td><p>mass_2 of the compact binary
(source frame)</p></td>
</tr>
<tr class="row-even"><td><p>mass_1</p></td>
<td><p>Msun</p></td>
<td><p>mass_1 of the compact binary
(detector frame)</p></td>
</tr>
<tr class="row-odd"><td><p>mass_2</p></td>
<td><p>Msun</p></td>
<td><p>mass_2 of the compact binary
(detector frame)</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler.gw_source_population</span> <span class="kn">import</span> <span class="n">CBCSourceParameterDistribution</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cbc</span> <span class="o">=</span> <span class="n">CBCSourceParameterDistribution</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">cbc</span><span class="o">.</span><span class="n">sample_gw_parameters</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.binary_masses_BBH_powerlaw_gaussian">
<span class="sig-name descname"><span class="pre">binary_masses_BBH_powerlaw_gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/gw_source_population/cbc_source_parameter_distribution.html#CBCSourceParameterDistribution.binary_masses_BBH_powerlaw_gaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.binary_masses_BBH_powerlaw_gaussian" title="Link to this definition"></a></dt>
<dd><p>Sample source masses with PowerLaw+PEAK model for Population I/II BBH.</p>
<p>Implements the mass distribution model from LIGO-Virgo population analyses
combining a power-law with a Gaussian peak component.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of samples to draw.</p>
</dd>
<dt><strong>get_attribute</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, return the sampler object instead of samples.</p>
<p>default: False</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Model parameters:</p>
<ul class="simple">
<li><p>mminbh: Minimum BH mass (Msun), default: 4.98</p></li>
<li><p>mmaxbh: Maximum BH mass (Msun), default: 112.5</p></li>
<li><p>alpha: Power-law spectral index, default: 3.78</p></li>
<li><p>mu_g: Gaussian peak mean (Msun), default: 32.27</p></li>
<li><p>sigma_g: Gaussian peak width (Msun), default: 3.88</p></li>
<li><p>lambda_peak: Fraction in Gaussian component, default: 0.03</p></li>
<li><p>delta_m: Low-mass tapering range (Msun), default: 4.8</p></li>
<li><p>beta: Mass ratio power-law index, default: 0.81</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>mass_1_source</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of primary masses in source frame (Msun).</p>
</dd>
<dt><strong>mass_2_source</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of secondary masses in source frame (Msun).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler.gw_source_population</span> <span class="kn">import</span> <span class="n">CBCSourceParameterDistribution</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cbc</span> <span class="o">=</span> <span class="n">CBCSourceParameterDistribution</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m1_src</span><span class="p">,</span> <span class="n">m2_src</span> <span class="o">=</span> <span class="n">cbc</span><span class="o">.</span><span class="n">binary_masses_BBH_powerlaw_gaussian</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.binary_masses_BBH_popIII_lognormal">
<span class="sig-name descname"><span class="pre">binary_masses_BBH_popIII_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/gw_source_population/cbc_source_parameter_distribution.html#CBCSourceParameterDistribution.binary_masses_BBH_popIII_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.binary_masses_BBH_popIII_lognormal" title="Link to this definition"></a></dt>
<dd><p>Sample source masses for Population III BBH from lognormal distribution.</p>
<p>Based on Eqn. 1 and 4 of Ng et al. 2022 for Population III black holes.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of samples to draw.</p>
</dd>
<dt><strong>get_attribute</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, return the sampler object instead of samples.</p>
<p>default: False</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Model parameters:</p>
<ul class="simple">
<li><p>m_min: Minimum BH mass (Msun), default: 5.0</p></li>
<li><p>m_max: Maximum BH mass (Msun), default: 150.0</p></li>
<li><p>Mc: Central mass scale (Msun), default: 30.0</p></li>
<li><p>sigma: Distribution width, default: 0.3</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>mass_1_source</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of primary masses in source frame (Msun).</p>
</dd>
<dt><strong>mass_2_source</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of secondary masses in source frame (Msun).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler.gw_source_population</span> <span class="kn">import</span> <span class="n">CBCSourceParameterDistribution</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cbc</span> <span class="o">=</span> <span class="n">CBCSourceParameterDistribution</span><span class="p">(</span><span class="n">event_type</span><span class="o">=</span><span class="s1">&#39;BBH_popIII&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m1_src</span><span class="p">,</span> <span class="n">m2_src</span> <span class="o">=</span> <span class="n">cbc</span><span class="o">.</span><span class="n">binary_masses_BBH_popIII_lognormal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.binary_masses_BBH_primordial_lognormal">
<span class="sig-name descname"><span class="pre">binary_masses_BBH_primordial_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/gw_source_population/cbc_source_parameter_distribution.html#CBCSourceParameterDistribution.binary_masses_BBH_primordial_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.binary_masses_BBH_primordial_lognormal" title="Link to this definition"></a></dt>
<dd><p>Sample source masses for primordial BBH from lognormal distribution.</p>
<p>Based on Eqn. 1 and 4 of Ng et al. 2022 for primordial black holes.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of samples to draw.</p>
</dd>
<dt><strong>get_attribute</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, return the sampler object instead of samples.</p>
<p>default: False</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Model parameters:</p>
<ul class="simple">
<li><p>m_min: Minimum BH mass (Msun), default: 1.0</p></li>
<li><p>m_max: Maximum BH mass (Msun), default: 100.0</p></li>
<li><p>Mc: Central mass scale (Msun), default: 20.0</p></li>
<li><p>sigma: Distribution width, default: 0.3</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>mass_1_source</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of primary masses in source frame (Msun).</p>
</dd>
<dt><strong>mass_2_source</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of secondary masses in source frame (Msun).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.binary_masses_NSBH_broken_powerlaw">
<span class="sig-name descname"><span class="pre">binary_masses_NSBH_broken_powerlaw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/gw_source_population/cbc_source_parameter_distribution.html#CBCSourceParameterDistribution.binary_masses_NSBH_broken_powerlaw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.binary_masses_NSBH_broken_powerlaw" title="Link to this definition"></a></dt>
<dd><p>Sample source masses for NSBH from broken power-law distribution.</p>
<p>Uses gwcosmo-style broken power-law for black hole mass and power-law
for neutron star mass.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of samples to draw.</p>
</dd>
<dt><strong>get_attribute</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, return the sampler object instead of samples.</p>
<p>default: False</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Model parameters:</p>
<ul class="simple">
<li><p>mminbh: Minimum BH mass (Msun), default: 26</p></li>
<li><p>mmaxbh: Maximum BH mass (Msun), default: 125</p></li>
<li><p>alpha_1: Primary power-law index, default: 6.75</p></li>
<li><p>alpha_2: Secondary power-law index, default: 6.75</p></li>
<li><p>b: Break point, default: 0.5</p></li>
<li><p>delta_m: Tapering range (Msun), default: 5</p></li>
<li><p>mminns: Minimum NS mass (Msun), default: 1.0</p></li>
<li><p>mmaxns: Maximum NS mass (Msun), default: 3.0</p></li>
<li><p>alphans: NS mass power-law index, default: 0.0</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>mass_1_source</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of BH masses in source frame (Msun).</p>
</dd>
<dt><strong>mass_2_source</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of NS masses in source frame (Msun).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler.gw_source_population</span> <span class="kn">import</span> <span class="n">CBCSourceParameterDistribution</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cbc</span> <span class="o">=</span> <span class="n">CBCSourceParameterDistribution</span><span class="p">(</span><span class="n">event_type</span><span class="o">=</span><span class="s1">&#39;NSBH&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m1_src</span><span class="p">,</span> <span class="n">m2_src</span> <span class="o">=</span> <span class="n">cbc</span><span class="o">.</span><span class="n">binary_masses_NSBH_broken_powerlaw</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.binary_masses_uniform">
<span class="sig-name descname"><span class="pre">binary_masses_uniform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/gw_source_population/cbc_source_parameter_distribution.html#CBCSourceParameterDistribution.binary_masses_uniform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.binary_masses_uniform" title="Link to this definition"></a></dt>
<dd><p>Sample source masses from uniform distribution.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of samples to draw.</p>
</dd>
<dt><strong>get_attribute</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, return the sampler object instead of samples.</p>
<p>default: False</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Model parameters:</p>
<ul class="simple">
<li><p>m_min: Minimum mass (Msun), default: 1.0</p></li>
<li><p>m_max: Maximum mass (Msun), default: 3.0</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>mass_1_source</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of primary masses in source frame (Msun).</p>
</dd>
<dt><strong>mass_2_source</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of secondary masses in source frame (Msun).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler.gw_source_population</span> <span class="kn">import</span> <span class="n">CBCSourceParameterDistribution</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cbc</span> <span class="o">=</span> <span class="n">CBCSourceParameterDistribution</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m1_src</span><span class="p">,</span> <span class="n">m2_src</span> <span class="o">=</span> <span class="n">cbc</span><span class="o">.</span><span class="n">binary_masses_uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.binary_masses_BNS_bimodal">
<span class="sig-name descname"><span class="pre">binary_masses_BNS_bimodal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/gw_source_population/cbc_source_parameter_distribution.html#CBCSourceParameterDistribution.binary_masses_BNS_bimodal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.binary_masses_BNS_bimodal" title="Link to this definition"></a></dt>
<dd><p>Sample BNS masses from bimodal Gaussian distribution.</p>
<p>Based on Will M. Farr et al. 2020 Eqn. 6 for neutron star mass
distribution combining two Gaussian peaks.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of samples to draw.</p>
</dd>
<dt><strong>get_attribute</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, return the sampler object instead of samples.</p>
<p>default: False</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Model parameters:</p>
<ul class="simple">
<li><p>w: Weight of left peak, default: 0.643</p></li>
<li><p>muL: Mean of left peak (Msun), default: 1.352</p></li>
<li><p>sigmaL: Width of left peak (Msun), default: 0.08</p></li>
<li><p>muR: Mean of right peak (Msun), default: 1.88</p></li>
<li><p>sigmaR: Width of right peak (Msun), default: 0.3</p></li>
<li><p>mmin: Minimum mass (Msun), default: 1.0</p></li>
<li><p>mmax: Maximum mass (Msun), default: 2.3</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>mass_1_source</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of primary masses in source frame (Msun).</p>
</dd>
<dt><strong>mass_2_source</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of secondary masses in source frame (Msun).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler.gw_source_population</span> <span class="kn">import</span> <span class="n">CBCSourceParameterDistribution</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cbc</span> <span class="o">=</span> <span class="n">CBCSourceParameterDistribution</span><span class="p">(</span><span class="n">event_type</span><span class="o">=</span><span class="s1">&#39;BNS&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m1_src</span><span class="p">,</span> <span class="n">m2_src</span> <span class="o">=</span> <span class="n">cbc</span><span class="o">.</span><span class="n">binary_masses_BNS_bimodal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.constant_values_n_size">
<span class="sig-name descname"><span class="pre">constant_values_n_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/gw_source_population/cbc_source_parameter_distribution.html#CBCSourceParameterDistribution.constant_values_n_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.constant_values_n_size" title="Link to this definition"></a></dt>
<dd><p>Return array of constant values.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of values to return.</p>
<p>default: 100</p>
</dd>
<dt><strong>get_attribute</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, return the sampler object instead of samples.</p>
<p>default: False</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Model parameters:</p>
<ul class="simple">
<li><p>value: Constant value to return, default: 0.0</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>values</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of constant values.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.sampler_uniform">
<span class="sig-name descname"><span class="pre">sampler_uniform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/gw_source_population/cbc_source_parameter_distribution.html#CBCSourceParameterDistribution.sampler_uniform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.sampler_uniform" title="Link to this definition"></a></dt>
<dd><p>Sample values from uniform distribution.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of samples to draw.</p>
</dd>
<dt><strong>get_attribute</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, return the sampler object instead of samples.</p>
<p>default: False</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Model parameters:</p>
<ul class="simple">
<li><p>xmin: Minimum value, default: 0.0</p></li>
<li><p>xmax: Maximum value, default: 1.0</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>values</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of uniformly distributed values in range [xmin, xmax].</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.sampler_cosine">
<span class="sig-name descname"><span class="pre">sampler_cosine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/gw_source_population/cbc_source_parameter_distribution.html#CBCSourceParameterDistribution.sampler_cosine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.sampler_cosine" title="Link to this definition"></a></dt>
<dd><p>Sample from cosine distribution for declination.</p>
<p>Samples values in range [-pi/2, pi/2] following a cosine distribution,
appropriate for isotropic sky position declination.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of samples to draw.</p>
</dd>
<dt><strong>get_attribute</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, return the sampler object instead of samples.</p>
<p>default: False</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>values</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of values in range [-pi/2, pi/2] (rad).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.CBCSourceParameterDistribution.sampler_sine">
<span class="sig-name descname"><span class="pre">sampler_sine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_attribute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/gw_source_population/cbc_source_parameter_distribution.html#CBCSourceParameterDistribution.sampler_sine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.CBCSourceParameterDistribution.sampler_sine" title="Link to this definition"></a></dt>
<dd><p>Sample from sine distribution for inclination angles.</p>
<p>Samples values in range [0, pi] following a sine distribution,
appropriate for isotropic orientation angles.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of samples to draw.</p>
</dd>
<dt><strong>get_attribute</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, return the sampler object instead of samples.</p>
<p>default: False</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>values</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></span></dt><dd><p>Array of values in range [0, pi] (rad).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id0">
<span class="sig-prename descclassname"><span class="pre">ler.rates.</span></span><span class="sig-name descname"><span class="pre">load_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/utils/utils.html#load_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Load a json file.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>file_name</strong><span class="classifier"><cite>str</cite></span></dt><dd><p>json file name for storing the parameters.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>param</strong><span class="classifier"><cite>dict</cite></span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id5">
<span class="sig-prename descclassname"><span class="pre">ler.rates.</span></span><span class="sig-name descname"><span class="pre">append_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_dictionary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_dictionary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/utils/utils.html#append_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd><p>Append (values with corresponding keys) and update a json file with a dictionary. There are four options:</p>
<ol class="arabic simple">
<li><p>If old_dictionary is provided, the values of the new dictionary will be appended to the old dictionary and save in the ‘file_name’ json file.</p></li>
<li><p>If replace is True, replace the json file (with the ‘file_name’) content with the new_dictionary.</p></li>
<li><p>If the file does not exist, create a new one with the new_dictionary.</p></li>
<li><p>If none of the above, append the new dictionary to the content of the json file.</p></li>
</ol>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>file_name</strong><span class="classifier"><cite>str</cite></span></dt><dd><p>json file name for storing the parameters.</p>
</dd>
<dt><strong>new_dictionary</strong><span class="classifier"><cite>dict</cite></span></dt><dd><p>dictionary to be appended to the json file.</p>
</dd>
<dt><strong>old_dictionary</strong><span class="classifier"><cite>dict</cite>, optional</span></dt><dd><p>If provided the values of the new dictionary will be appended to the old dictionary and save in the ‘file_name’ json file.
Default is None.</p>
</dd>
<dt><strong>replace</strong><span class="classifier"><cite>bool</cite>, optional</span></dt><dd><p>If True, replace the json file with the dictionary. Default is False.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id6">
<span class="sig-prename descclassname"><span class="pre">ler.rates.</span></span><span class="sig-name descname"><span class="pre">get_param_from_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">json_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/utils/utils.html#get_param_from_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id6" title="Link to this definition"></a></dt>
<dd><p>Function to get the parameters from json file.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>json_file</strong><span class="classifier"><cite>str</cite></span></dt><dd><p>json file name for storing the parameters.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>param</strong><span class="classifier"><cite>dict</cite></span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id7">
<span class="sig-prename descclassname"><span class="pre">ler.rates.</span></span><span class="sig-name descname"><span class="pre">batch_handler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_routine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_jsonfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'parameters'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/utils/utils.html#batch_handler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id7" title="Link to this definition"></a></dt>
<dd><p>Function to run the sampling in batches.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><cite>int</cite></span></dt><dd><p>number of samples.</p>
</dd>
<dt><strong>batch_size</strong><span class="classifier"><cite>int</cite></span></dt><dd><p>batch size.</p>
</dd>
<dt><strong>sampling_routine</strong><span class="classifier"><cite>function</cite></span></dt><dd><p>sampling function. It should have ‘size’ as input and return a dictionary.</p>
</dd>
<dt><strong>output_jsonfile</strong><span class="classifier"><cite>str</cite></span></dt><dd><p>json file name for storing the parameters.</p>
</dd>
<dt><strong>save_batch</strong><span class="classifier"><cite>bool</cite>, optional</span></dt><dd><p>if True, save sampled parameters in each iteration. Default is True.</p>
</dd>
<dt><strong>resume</strong><span class="classifier"><cite>bool</cite>, optional</span></dt><dd><p>if True, resume sampling from the last batch. Default is False.</p>
</dd>
<dt><strong>param_name</strong><span class="classifier"><cite>str</cite>, optional</span></dt><dd><p>name of the parameter. Default is ‘parameters’.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>dict_buffer</strong><span class="classifier"><cite>dict</cite></span></dt><dd><p>dictionary of parameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id8">
<span class="sig-prename descclassname"><span class="pre">ler.rates.</span></span><span class="sig-name descname"><span class="pre">remove_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/utils/utils.html#remove_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id8" title="Link to this definition"></a></dt>
<dd><p>Remove a file.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="ler.rates.GWRATES">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ler.rates.</span></span><span class="sig-name descname"><span class="pre">GWRATES</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">npool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">int(4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BBH'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmology</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdet_finder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">json_file_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolator_directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./interpolator_json'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_new_interpolator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ler_directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./ler_data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/rates/gwrates.html#GWRATES"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.GWRATES" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../gw_source_population/index.html#ler.gw_source_population.CBCSourceParameterDistribution" title="ler.gw_source_population.CBCSourceParameterDistribution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ler.gw_source_population.CBCSourceParameterDistribution</span></code></a></p>
<p>Class to sample GW events and calculate their detection rates.</p>
<p>This class provides functionality for sampling gravitational wave source
parameters, detection probabilities, and computing detection rates for
compact binary coalescence events. Parameters of simulated events are
stored in JSON files (not as class attributes) to conserve RAM memory.</p>
<p>Key Features:</p>
<ul class="simple">
<li><p>Sampling of GW event parameters</p></li>
<li><p>Detection probability calculation using <code class="docutils literal notranslate"><span class="pre">gwsnr</span></code> package or custom functions</p></li>
<li><p>Rate calculation for detectable events</p></li>
<li><p>Batch processing for memory efficiency</p></li>
<li><p>JSON-based parameter storage for reproducibility</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>npool</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of cores to use for parallel processing.</p>
<p>default: 4</p>
</dd>
<dt><strong>z_min</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Minimum redshift of the source population.</p>
<p>default: 0.0</p>
</dd>
<dt><strong>z_max</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Maximum redshift of the source population.</p>
<p>default: 10.0</p>
</dd>
<dt><strong>event_type</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Type of event to generate.</p>
<p>Options:</p>
<ul class="simple">
<li><p>‘BBH’: Binary Black Hole</p></li>
<li><p>‘BNS’: Binary Neutron Star</p></li>
<li><p>‘NSBH’: Neutron Star-Black Hole</p></li>
</ul>
<p>default: ‘BBH’</p>
</dd>
<dt><strong>cosmology</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">astropy.cosmology</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Cosmology to use for the calculation.</p>
<p>default: LambdaCDM(H0=70, Om0=0.3, Ode0=0.7, Tcmb0=0.0, Neff=3.04, m_nu=None, Ob0=0.0)</p>
</dd>
<dt><strong>pdet_finder</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">callable</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Custom detection probability finder function.</p>
<p>If None, uses gwsnr’s pdet calculator.</p>
<p>The function should follow the signature:</p>
<p><code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">pdet_finder(gw_param_dict):</span> <span class="pre">return</span> <span class="pre">pdet_net_dict</span></code></p>
<p>where pdet_net_dict.keys = [‘pdet_net’].</p>
<p>default: None</p>
</dd>
<dt><strong>json_file_names</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Names of the JSON files to store the necessary parameters.</p>
<p>default: dict(gwrates_params=”gwrates_params.json”, gw_param=”gw_param.json”, gw_param_detectable=”gw_param_detectable.json”)</p>
</dd>
<dt><strong>interpolator_directory</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Directory to store the interpolators.</p>
<p>default: ‘./interpolator_json’</p>
</dd>
<dt><strong>create_new_interpolator</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code> or <code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Whether to create new interpolators.</p>
<p>default: False</p>
</dd>
<dt><strong>ler_directory</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Directory to store the output parameters.</p>
<p>default: ‘./ler_data’</p>
</dd>
<dt><strong>verbose</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, print all chosen parameters during initialization.</p>
<p>default: True</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Additional keyword arguments passed to parent classes:</p>
<p><a class="reference internal" href="../gw_source_population/index.html#ler.gw_source_population.CBCSourceParameterDistribution" title="ler.gw_source_population.CBCSourceParameterDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">CBCSourceParameterDistribution</span></code></a> and</p>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">GWSNR</span></code> (if pdet_finder is not provided).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">GWRATES</span></code> class inherits from <a class="reference internal" href="../gw_source_population/index.html#ler.gw_source_population.CBCSourceParameterDistribution" title="ler.gw_source_population.CBCSourceParameterDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">CBCSourceParameterDistribution</span></code></a>.</p>
<p>Refer to that class for additional inherited attributes and methods.</p>
</li>
<li><p>Parameters are stored in JSON files for memory efficiency and reproducibility.</p></li>
<li><p>For stable rate estimates, use size &gt;= 1e6 samples.</p></li>
</ul>
<p class="rubric">Examples</p>
<p>Basic usage:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler.rates</span> <span class="kn">import</span> <span class="n">GWRATES</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gwrates</span> <span class="o">=</span> <span class="n">GWRATES</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gw_params</span> <span class="o">=</span> <span class="n">gwrates</span><span class="o">.</span><span class="n">gw_cbc_statistics</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gwrates</span><span class="o">.</span><span class="n">gw_rate</span><span class="p">()</span>
</pre></div>
</div>
<section id="id9">
<h4>Instance Methods<a class="headerlink" href="#id9" title="Link to this heading"></a></h4>
<p>GWRATES class has the following methods:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.GWRATES.gw_cbc_statistics" title="ler.rates.GWRATES.gw_cbc_statistics"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gw_cbc_statistics()</span></code></a></p></td>
<td><p>Generate GW source parameters</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.GWRATES.gw_rate" title="ler.rates.GWRATES.gw_rate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gw_rate()</span></code></a></p></td>
<td><p>Calculate the GW detection rate</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.GWRATES.selecting_n_gw_detectable_events" title="ler.rates.GWRATES.selecting_n_gw_detectable_events"><code class="xref py py-meth docutils literal notranslate"><span class="pre">selecting_n_gw_detectable_events()</span></code></a></p></td>
<td><p>Select n GW detectable events</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id10">
<h4>Instance Attributes<a class="headerlink" href="#id10" title="Link to this heading"></a></h4>
<p>GWRATES class has the following attributes:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.GWRATES.npool" title="ler.rates.GWRATES.npool"><code class="xref py py-meth docutils literal notranslate"><span class="pre">npool()</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p></td>
<td></td>
<td><p>Number of parallel processing cores</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.GWRATES.z_min" title="ler.rates.GWRATES.z_min"><code class="xref py py-meth docutils literal notranslate"><span class="pre">z_min()</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td></td>
<td><p>Minimum source redshift</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.GWRATES.z_max" title="ler.rates.GWRATES.z_max"><code class="xref py py-meth docutils literal notranslate"><span class="pre">z_max()</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td></td>
<td><p>Maximum source redshift</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.GWRATES.event_type" title="ler.rates.GWRATES.event_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">event_type()</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p></td>
<td></td>
<td><p>Type of CBC event</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.GWRATES.cosmo" title="ler.rates.GWRATES.cosmo"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cosmo()</span></code></a></p></td>
<td colspan="2"><p><code class="docutils literal notranslate"><span class="pre">astropy.cosmology</span></code> |</p></td>
<td><p>Cosmology for calculations</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.GWRATES.json_file_names" title="ler.rates.GWRATES.json_file_names"><code class="xref py py-meth docutils literal notranslate"><span class="pre">json_file_names()</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p></td>
<td></td>
<td><p>JSON file names for parameter storage</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.GWRATES.interpolator_directory" title="ler.rates.GWRATES.interpolator_directory"><code class="xref py py-meth docutils literal notranslate"><span class="pre">interpolator_directory()</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p></td>
<td></td>
<td><p>Directory for interpolator files</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.GWRATES.ler_directory" title="ler.rates.GWRATES.ler_directory"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ler_directory()</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p></td>
<td></td>
<td><p>Directory for output parameter files</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.GWRATES.list_of_detectors" title="ler.rates.GWRATES.list_of_detectors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">list_of_detectors()</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">list</span></code></p></td>
<td></td>
<td><p>List of detector names</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ler.rates.GWRATES.pdet_finder" title="ler.rates.GWRATES.pdet_finder"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pdet_finder()</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">callable</span></code></p></td>
<td></td>
<td><p>Detection probability finder function</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ler.rates.GWRATES.gwrates_args" title="ler.rates.GWRATES.gwrates_args"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gwrates_args()</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p></td>
<td></td>
<td><p>All GWRATES initialization arguments</p></td>
</tr>
</tbody>
</table>
<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.GWRATES.npool">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">npool</span></span><a class="headerlink" href="#ler.rates.GWRATES.npool" title="Link to this definition"></a></dt>
<dd><p>Number of parallel processing cores.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>npool</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of logical cores to use for multiprocessing.</p>
<p>default: 4</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.GWRATES.z_min">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">z_min</span></span><a class="headerlink" href="#ler.rates.GWRATES.z_min" title="Link to this definition"></a></dt>
<dd><p>Minimum redshift of the source population.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>z_min</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Minimum source redshift for sampling.</p>
<p>default: 0.0</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.GWRATES.z_max">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">z_max</span></span><a class="headerlink" href="#ler.rates.GWRATES.z_max" title="Link to this definition"></a></dt>
<dd><p>Maximum redshift of the source population.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>z_max</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Maximum source redshift for sampling.</p>
<p>default: 10.0</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.GWRATES.event_type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">event_type</span></span><a class="headerlink" href="#ler.rates.GWRATES.event_type" title="Link to this definition"></a></dt>
<dd><p>Type of compact binary coalescence event.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>event_type</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Type of CBC event.</p>
<p>Options:</p>
<ul class="simple">
<li><p>‘BBH’: Binary Black Hole</p></li>
<li><p>‘BNS’: Binary Neutron Star</p></li>
<li><p>‘NSBH’: Neutron Star-Black Hole</p></li>
</ul>
<p>default: ‘BBH’</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.GWRATES.cosmo">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cosmo</span></span><a class="headerlink" href="#ler.rates.GWRATES.cosmo" title="Link to this definition"></a></dt>
<dd><p>Astropy cosmology object for distance calculations.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>cosmo</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">astropy.cosmology</span></code></span></dt><dd><p>Cosmology used for luminosity distance and comoving volume calculations.</p>
<p>default: LambdaCDM(H0=70, Om0=0.3, Ode0=0.7, Tcmb0=0.0, Neff=3.04, m_nu=None, Ob0=0.0)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.GWRATES.json_file_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">json_file_names</span></span><a class="headerlink" href="#ler.rates.GWRATES.json_file_names" title="Link to this definition"></a></dt>
<dd><p>Dictionary of JSON file names for parameter storage.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>json_file_names</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary with keys:</p>
<ul class="simple">
<li><p>‘gwrates_params’: GWRATES initialization parameters</p></li>
<li><p>‘gw_param’: GW event parameters</p></li>
<li><p>‘gw_param_detectable’: Detectable GW events</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.GWRATES.interpolator_directory">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">interpolator_directory</span></span><a class="headerlink" href="#ler.rates.GWRATES.interpolator_directory" title="Link to this definition"></a></dt>
<dd><p>Directory path for interpolator JSON files.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>interpolator_directory</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Path to directory containing interpolator data files.</p>
<p>default: ‘./interpolator_json’</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.GWRATES.ler_directory">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ler_directory</span></span><a class="headerlink" href="#ler.rates.GWRATES.ler_directory" title="Link to this definition"></a></dt>
<dd><p>Directory path for LeR output files.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ler_directory</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Path to directory for storing output parameter files.</p>
<p>default: ‘./ler_data’</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.GWRATES.create_new_interpolator">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_new_interpolator</span></span><a class="headerlink" href="#ler.rates.GWRATES.create_new_interpolator" title="Link to this definition"></a></dt>
<dd><p>Configuration dictionary for interpolator creation settings.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>create_new_interpolator</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary specifying which interpolators to create.</p>
<p>Each key is an interpolator name, and values are dicts with:</p>
<ul class="simple">
<li><p>‘create_new’: bool - Whether to create new interpolator</p></li>
<li><p>‘resolution’: int or list - Grid resolution for interpolation</p></li>
</ul>
<p>Special key ‘gwsnr’ is a bool for GWSNR interpolator creation.
Default: dict(</p>
<blockquote>
<div><p>merger_rate_density = {‘create_new’: False, ‘resolution’: 500},
redshift_distribution = {‘create_new’: False, ‘resolution’: 500},
luminosity_distance = {‘create_new’: False, ‘resolution’: 500},
differential_comoving_volume = {‘create_new’: False, ‘resolution’: 500},
source_frame_masses = {‘create_new’: False, ‘resolution’: 500},
geocent_time = {‘create_new’: False, ‘resolution’: 500},
ra = {‘create_new’: False, ‘resolution’: 500},
dec = {‘create_new’: False, ‘resolution’: 500},
phase = {‘create_new’: False, ‘resolution’: 500},
psi = {‘create_new’: False, ‘resolution’: 500},
theta_jn = {‘create_new’: False, ‘resolution’: 500},
a_1 = {‘create_new’: False, ‘resolution’: 500},
a_2 = {‘create_new’: False, ‘resolution’: 500},
tilt_1 = {‘create_new’: False, ‘resolution’: 500},
tilt_2 = {‘create_new’: False, ‘resolution’: 500},
phi_12 = {‘create_new’: False, ‘resolution’: 500},
phi_jl = {‘create_new’: False, ‘resolution’: 500},</p>
</div></blockquote>
<p>)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.GWRATES.list_of_detectors">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">list_of_detectors</span></span><a class="headerlink" href="#ler.rates.GWRATES.list_of_detectors" title="Link to this definition"></a></dt>
<dd><p>List of gravitational wave detector names.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>list_of_detectors</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">list</span></code></span></dt><dd><p>List of detector identifiers used for pdet calculations.</p>
<p>Typically set from gwsnr.detector_list during initialization.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.GWRATES.pdet_finder">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pdet_finder</span></span><a class="headerlink" href="#ler.rates.GWRATES.pdet_finder" title="Link to this definition"></a></dt>
<dd><p>Detection probability finder function.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>pdet_finder</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">callable</span></code></span></dt><dd><p>Function that calculates detection probability for GW events.</p>
<p>The function signature should be:</p>
<p><code class="docutils literal notranslate"><span class="pre">pdet_finder(gw_param_dict)</span> <span class="pre">-&gt;</span> <span class="pre">dict</span></code> with key ‘pdet_net’.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="ler.rates.GWRATES.gwrates_args">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gwrates_args</span></span><a class="headerlink" href="#ler.rates.GWRATES.gwrates_args" title="Link to this definition"></a></dt>
<dd><p>Dictionary of all GWRATES initialization arguments.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>gwrates_args</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>Dictionary containing all parameters used to initialize GWRATES and</p>
<p>its parent classes, useful for reproducibility.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.GWRATES.gw_cbc_statistics">
<span class="sig-name descname"><span class="pre">gw_cbc_statistics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_jsonfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/rates/gwrates.html#GWRATES.gw_cbc_statistics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.GWRATES.gw_cbc_statistics" title="Link to this definition"></a></dt>
<dd><p>Generate GW source parameters with detection probabilities.</p>
<p>This function calls the _gw_sampling_routine function to generate
the parameters in batches. The generated parameters are stored in
a JSON file; if save_batch=True, it updates the file after each batch.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Number of samples to generate.</p>
<p>default: 100000</p>
</dd>
<dt><strong>batch_size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Batch size for sampling.</p>
<p>default: 50000</p>
</dd>
<dt><strong>resume</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, resume from the last batch.</p>
<p>default: True</p>
</dd>
<dt><strong>save_batch</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, save parameters after each batch.</p>
<p>If False, save all parameters at the end (faster).</p>
<p>default: False</p>
</dd>
<dt><strong>output_jsonfile</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>JSON file name for storing the parameters.</p>
<p>default: ‘gw_param.json’ (stored in ler_directory)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>gw_param</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>dictionary of GW source parameters. The included parameters and their units are as follows (for default settings):</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler.rates</span> <span class="kn">import</span> <span class="n">GWRATES</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gwrates</span> <span class="o">=</span> <span class="n">GWRATES</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param</span> <span class="o">=</span> <span class="n">gwrates</span><span class="o">.</span><span class="n">gw_cbc_statistics</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.GWRATES.gw_rate">
<span class="sig-name descname"><span class="pre">gw_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gw_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdet_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdet_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'boolean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_jsonfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/rates/gwrates.html#GWRATES.gw_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.GWRATES.gw_rate" title="Link to this definition"></a></dt>
<dd><p>Calculate the GW detection rate.</p>
<p>This function calculates the detection rate and stores the parameters
of detectable events in a JSON file.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>gw_param</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code> or <code class="docutils literal notranslate"><span class="pre">str</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Dictionary of GW source parameters or JSON file name.</p>
<p>default: None (uses self.json_file_names[“gw_param”])</p>
</dd>
<dt><strong>pdet_threshold</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Threshold for detection probability.</p>
<p>default: 0.5</p>
</dd>
<dt><strong>pdet_type</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Detectability condition type.</p>
<p>Options:</p>
<ul class="simple">
<li><p>‘boolean’: Binary detection based on pdet_threshold</p></li>
<li><p>‘probability_distribution’: Uses pdet values directly</p></li>
</ul>
<p>default: ‘boolean’</p>
</dd>
<dt><strong>output_jsonfile</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>JSON file name for storing detectable event parameters.</p>
<p>default: ‘gw_param_detectable.json’</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>total_rate</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Total GW detection rate (yr^-1).</p>
</dd>
<dt><strong>gw_param</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>dictionary of GW source parameters of the detectable events. The included parameters and their units are as follows (for default settings):</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler.rates</span> <span class="kn">import</span> <span class="n">GWRATES</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gwrates</span> <span class="o">=</span> <span class="n">GWRATES</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gwrates</span><span class="o">.</span><span class="n">gw_cbc_statistics</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">total_rate</span><span class="p">,</span> <span class="n">gw_param</span> <span class="o">=</span> <span class="n">gwrates</span><span class="o">.</span><span class="n">gw_rate</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.GWRATES.rate_function">
<span class="sig-name descname"><span class="pre">rate_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">detectable_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/rates/gwrates.html#GWRATES.rate_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.GWRATES.rate_function" title="Link to this definition"></a></dt>
<dd><p>Helper function to calculate the detection rate via Monte Carlo integration.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>detectable_size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code> or <code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Number of detectable events.</p>
</dd>
<dt><strong>total_size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Total number of simulated events.</p>
</dd>
<dt><strong>verbose</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, print rate information.</p>
<p>default: True</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>rate</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Detection rate (yr^-1).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ler.rates.GWRATES.selecting_n_gw_detectable_events">
<span class="sig-name descname"><span class="pre">selecting_n_gw_detectable_events</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stopping_criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">dict(relative_diff_percentage=0.5,</span> <span class="pre">number_of_last_batches_to_check=4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdet_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_jsonfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gw_params_n_detectable.json'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_data_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'meta_gw.json'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdet_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'boolean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trim_to_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/ler/rates/gwrates.html#GWRATES.selecting_n_gw_detectable_events"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ler.rates.GWRATES.selecting_n_gw_detectable_events" title="Link to this definition"></a></dt>
<dd><p>Generate a target number of detectable GW events by iterative batch sampling.</p>
<p>This function samples GW parameters in batches and saves only the
detectable events to a JSON file. It optionally stops when the
cumulative rate has stabilized based on the stopping criteria.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Target number of detectable samples to collect.</p>
<p>default: 100</p>
</dd>
<dt><strong>batch_size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code></span></dt><dd><p>Batch size for sampling.</p>
<p>default: 50000</p>
</dd>
<dt><strong>stopping_criteria</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code></span></dt><dd><p>Criteria for stopping sample collection (but will not stop until n&gt;size).</p>
<p>Keys:</p>
<ul class="simple">
<li><p>‘relative_diff_percentage’: Maximum relative difference in rate (float)</p></li>
<li><p>‘number_of_last_batches_to_check’: Number of batches for comparison (int)</p></li>
</ul>
<p>If None, stops when detectable events exceed size.</p>
<p>default: dict(relative_diff_percentage=0.5, number_of_last_batches_to_check=4)</p>
</dd>
<dt><strong>pdet_threshold</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">float</span></code></span></dt><dd><p>Threshold for detection probability.</p>
<p>default: 0.5</p>
</dd>
<dt><strong>resume</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, resume from the last batch.</p>
<p>default: True</p>
</dd>
<dt><strong>output_jsonfile</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>JSON file name for storing detectable event parameters.</p>
<p>default: ‘gw_params_n_detectable.json’</p>
</dd>
<dt><strong>meta_data_file</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>JSON file name for storing metadata.</p>
<p>default: ‘meta_gw.json’</p>
</dd>
<dt><strong>pdet_type</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code></span></dt><dd><p>Detectability condition type.</p>
<p>Options:</p>
<ul class="simple">
<li><p>‘boolean’: Binary detection based on pdet_threshold</p></li>
<li><p>‘probability_distribution’: Uses pdet values directly</p></li>
</ul>
<p>default: ‘boolean’</p>
</dd>
<dt><strong>trim_to_size</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code></span></dt><dd><p>If True, trim final result to exactly the specified size.</p>
<p>default: False</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>param_final</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict</span></code></span></dt><dd><p>dictionary of GW source parameters of the detectable events. The included parameters and their units are as follows (for default settings):</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>zs</p></td>
<td></td>
<td><p>redshift of the source</p></td>
</tr>
<tr class="row-odd"><td><p>geocent_time</p></td>
<td><p>s</p></td>
<td><p>GPS time of coalescence</p></td>
</tr>
<tr class="row-even"><td><p>ra</p></td>
<td><p>rad</p></td>
<td><p>right ascension</p></td>
</tr>
<tr class="row-odd"><td><p>dec</p></td>
<td><p>rad</p></td>
<td><p>declination</p></td>
</tr>
<tr class="row-even"><td><p>phase</p></td>
<td><p>rad</p></td>
<td><p>phase of GW at reference frequency</p></td>
</tr>
<tr class="row-odd"><td><p>psi</p></td>
<td><p>rad</p></td>
<td><p>polarization angle</p></td>
</tr>
<tr class="row-even"><td><p>theta_jn</p></td>
<td><p>rad</p></td>
<td><p>inclination angle</p></td>
</tr>
<tr class="row-odd"><td><p>a_1</p></td>
<td></td>
<td><p>spin of the primary compact binary</p></td>
</tr>
<tr class="row-even"><td><p>a_2</p></td>
<td></td>
<td><p>spin of the secondary compact binary</p></td>
</tr>
<tr class="row-odd"><td><p>luminosity_distance</p></td>
<td><p>Mpc</p></td>
<td><p>luminosity distance</p></td>
</tr>
<tr class="row-even"><td><p>mass_1_source</p></td>
<td><p>Msun</p></td>
<td><p>mass of the primary compact binary
(source frame)</p></td>
</tr>
<tr class="row-odd"><td><p>mass_2_source</p></td>
<td><p>Msun</p></td>
<td><p>mass of the secondary compact binary
(source frame)</p></td>
</tr>
<tr class="row-even"><td><p>mass_1</p></td>
<td><p>Msun</p></td>
<td><p>mass_1 of the compact binary
(detector frame)</p></td>
</tr>
<tr class="row-odd"><td><p>mass_2</p></td>
<td><p>Msun</p></td>
<td><p>mass_2 of the compact binary
(detector frame)</p></td>
</tr>
<tr class="row-even"><td><p>pdet_L1</p></td>
<td></td>
<td><p>pdet of L1</p></td>
</tr>
<tr class="row-odd"><td><p>pdet_H1</p></td>
<td></td>
<td><p>pdet of H1</p></td>
</tr>
<tr class="row-even"><td><p>pdet_V1</p></td>
<td></td>
<td><p>pdet of V1</p></td>
</tr>
<tr class="row-odd"><td><p>pdet_net</p></td>
<td></td>
<td><p>pdet of the network</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ler.rates</span> <span class="kn">import</span> <span class="n">GWRATES</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gwrates</span> <span class="o">=</span> <span class="n">GWRATES</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gw_param</span> <span class="o">=</span> <span class="n">gwrates</span><span class="o">.</span><span class="n">selecting_n_gw_detectable_events</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../../Lensed_equations.html" class="btn btn-neutral float-left" title="Lensed event sampling (Analytical formulation)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="gwrates/index.html" class="btn btn-neutral float-right" title="ler.rates.gwrates" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Phurailatpam Hemantakumar.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>