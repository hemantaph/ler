<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Merger rate density evolution with redshift &mdash; ler 0.3.1 documentation</title>
  <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
  <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
  <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=fd3f3429" />
  <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
  <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=a5c4661c" />
  <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
  <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=776609e1" />


  <script src="../../_static/jquery.js?v=5d32c60e"></script>
  <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
  <script src="../../_static/documentation_options.js?v=4621528c"></script>
  <script src="../../_static/doctools.js?v=9a2dae69"></script>
  <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
  <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
  <script src="../../_static/copybutton.js?v=f281be69"></script>
  <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA="
    src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
  <script>window.MathJax = { "tex": { "inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true }, "options": { "ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area" } }</script>
  <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script src="../../_static/js/theme.js"></script>
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
  <link rel="next" title="Merger rate density model comparision"
    href="merger%20rate%20density%20model%20comparision.html" />
  <link rel="prev" title="Event Rates with 3G detectors" href="../rates/rates_with_3G_detectors.html" />
</head>

<body class="wy-body-for-nav">
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">



          <a href="../../index.html" class="icon icon-home">
            ler
          </a>
          <div role="search">
            <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
              <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
          <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
          <ul>
            <li class="toctree-l1"><a class="reference internal" href="../../Installation2.html">Installation</a></li>
            <li class="toctree-l1"><a class="reference internal" href="../../Summary.html">Summary</a></li>
            <li class="toctree-l1"><a class="reference internal" href="../../code_overview.html">Code overview</a></li>
            <li class="toctree-l1"><a class="reference internal" href="../../GW_events.html">Gravitational wave event
                rates</a></li>
            <li class="toctree-l1"><a class="reference internal" href="../../GW_equations.html">Gravitational wave
                events sampling (Analytical formulation)</a></li>
            <li class="toctree-l1"><a class="reference internal" href="../../Lensed_events.html">Lensed event rates</a>
            </li>
            <li class="toctree-l1"><a class="reference internal" href="../../Lensed_equations.html">Lensed event
                sampling (Analytical formulation)</a></li>
          </ul>
          <p class="caption" role="heading"><span class="caption-text">API:</span></p>
          <ul>
            <li class="toctree-l1"><a class="reference internal" href="../../autoapi/ler/rates/index.html"><code
                  class="xref py py-mod docutils literal notranslate"><span class="pre">ler.rates</span></code></a></li>
            <li class="toctree-l1"><a class="reference internal"
                href="../../autoapi/ler/gw_source_population/index.html"><code
                  class="xref py py-mod docutils literal notranslate"><span class="pre">ler.gw_source_population</span></code></a>
            </li>
            <li class="toctree-l1"><a class="reference internal"
                href="../../autoapi/ler/lens_galaxy_population/index.html"><code
                  class="xref py py-mod docutils literal notranslate"><span class="pre">ler.lens_galaxy_population</span></code></a>
            </li>
            <li class="toctree-l1"><a class="reference internal"
                href="../../autoapi/ler/image_properties/index.html"><code
                  class="xref py py-mod docutils literal notranslate"><span class="pre">ler.image_properties</span></code></a>
            </li>
            <li class="toctree-l1"><a class="reference internal" href="../../autoapi/ler/utils/index.html"><code
                  class="xref py py-mod docutils literal notranslate"><span class="pre">ler.utils</span></code></a></li>
          </ul>
          <p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
          <ul class="current">
            <li class="toctree-l1"><a class="reference internal" href="../rates/LeR%20complete%20examples.html">LeR
                complete examples</a></li>
            <li class="toctree-l1"><a class="reference internal"
                href="../rates/GWRATES%20complete%20exmaples.html">GWRATES complete exmaples</a></li>
            <li class="toctree-l1"><a class="reference internal" href="../rates/grb%20detection%20rate.html">Calculation
                of detectable Gamma ray burst (GRB) event rate associated with Binary Neutron Star (BNS) mergers.</a>
            </li>
            <li class="toctree-l1"><a class="reference internal" href="../rates/ler%20bns%20example.html">LeR complete
                examples of BNS events (O4 design sensitivity)</a></li>
            <li class="toctree-l1"><a class="reference internal" href="../rates/rates_with_3G_detectors.html">Event
                Rates with 3G detectors</a></li>
            <li class="toctree-l1 current"><a class="current reference internal" href="#">Merger rate density evolution
                with redshift</a>
              <ul>
                <li class="toctree-l2"><a class="reference internal"
                    href="#Plotting-differential-comoving-volume">Plotting differential comoving volume</a></li>
                <li class="toctree-l2"><a class="reference internal"
                    href="#Merger-rate-evolution-with-redshift-(detector-frame)">Merger rate evolution with redshift
                    (detector frame)</a>
                  <ul>
                    <li class="toctree-l3"><a class="reference internal"
                        href="#Plots-with-uncertainties-in-local-merger-rate-density">Plots with uncertainties in local
                        merger rate density</a></li>
                  </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#BBH">BBH</a></li>
                <li class="toctree-l2"><a class="reference internal" href="#BNS">BNS</a></li>
                <li class="toctree-l2"><a class="reference internal" href="#Redshift-distribution-(BBH)">Redshift
                    distribution (BBH)</a></li>
              </ul>
            </li>
            <li class="toctree-l1"><a class="reference internal"
                href="merger%20rate%20density%20model%20comparision.html">Merger rate density model comparision</a></li>
            <li class="toctree-l1"><a class="reference internal"
                href="merger%20rate%20density%20model%20comparision.html#Primordial-BBH-model,-Ng-et-al.-2022">Primordial
                BBH model, Ng et al. 2022</a></li>
            <li class="toctree-l1"><a class="reference internal"
                href="sample%20compact%20binary%20parameters.html">Sampling parameters for a compact binary</a></li>
            <li class="toctree-l1"><a class="reference internal"
                href="statistical%20study%20of%20changing%20mass%20model%20params.html">Statistical study of changing
                Mass model paramter(s)</a></li>
            <li class="toctree-l1"><a class="reference internal"
                href="statistical%20study%20of%20cosmological%20friction.html">Statistical study of cosmological
                friction and its effect on the redshift vs inferred chirp-mass relation of gravitational waves</a></li>
            <li class="toctree-l1"><a class="reference internal"
                href="../lens_parameters/sample%20lens%20parameters.html">Lens parameter distributions</a></li>
            <li class="toctree-l1"><a class="reference internal" href="../optical_depth/validation_SIE.html">Optical
                depth SIE model validation</a></li>
            <li class="toctree-l1"><a class="reference internal" href="../optical_depth/validation_SIS.html">Validation
                of SIS model (Numerical vs Analytical)</a></li>
            <li class="toctree-l1"><a class="reference internal" href="../image_properties/dt_vs_dmu.html">Study of Time
                delays and magnification of lensed gravitational waves.</a></li>
          </ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" aria-label="Mobile navigation menu">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ler</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
            <ul class="wy-breadcrumbs">
              <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
              <li class="breadcrumb-item active">Merger rate density evolution with redshift</li>
              <li class="wy-breadcrumbs-aside">
                <a href="../../_sources/examples/source population/merger rate density evolution with redshift.ipynb.txt"
                  rel="nofollow"> View page source</a>
              </li>
            </ul>
            <hr />
          </div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div itemprop="articleBody">

              <section id="Merger-rate-density-evolution-with-redshift">
                <h1>Merger rate density evolution with redshift<a class="headerlink"
                    href="#Merger-rate-density-evolution-with-redshift" title="Link to this heading"></a></h1>
                <ul class="simple">
                  <li>
                    <p>Number of compact binary mergers per unit time per unit volume</p>
                  </li>
                </ul>
                <div class="nbinput nblast docutils container">
                  <div class="prompt highlight-none notranslate">
                    <div class="highlight">
                      <pre><span></span>[1]:
</pre>
                    </div>
                  </div>
                  <div class="input_area highlight-ipython3 notranslate">
                    <div class="highlight">
                      <pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
<span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="kn">import</span> <span class="n">LambdaCDM</span>
<span class="n">cosmo</span> <span class="o">=</span> <span class="n">LambdaCDM</span><span class="p">(</span><span class="n">H0</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">Om0</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">Ode0</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="c1"># calling necessary class from ler package</span>
<span class="kn">from</span> <span class="nn">ler.gw_source_population</span> <span class="kn">import</span> <span class="n">CBCSourceRedshiftDistribution</span>
</pre>
                    </div>
                  </div>
                </div>
                <div class="nbinput nblast docutils container">
                  <div class="prompt highlight-none notranslate">
                    <div class="highlight">
                      <pre><span></span>[2]:
</pre>
                    </div>
                  </div>
                  <div class="input_area highlight-ipython3 notranslate">
                    <div class="highlight">
                      <pre><span></span><span class="c1"># uncomment the following line to see the docstring</span>
<span class="c1"># SourceGalaxyPopulationModel?</span>
</pre>
                    </div>
                  </div>
                </div>
                <div class="nbinput docutils container">
                  <div class="prompt highlight-none notranslate">
                    <div class="highlight">
                      <pre><span></span>[3]:
</pre>
                    </div>
                  </div>
                  <div class="input_area highlight-ipython3 notranslate">
                    <div class="highlight">
                      <pre><span></span><span class="c1"># class initialization</span>
<span class="c1"># default model &quot;BBH popI/II Oguri2018&quot;</span>
<span class="n">cbc</span> <span class="o">=</span> <span class="n">CBCSourceRedshiftDistribution</span><span class="p">()</span>

<span class="c1"># list out the models for the merger rate density wrt redshift</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> available model list with it input parameters: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cbc</span><span class="o">.</span><span class="n">merger_rate_density_model_list</span><span class="p">)</span>
</pre>
                    </div>
                  </div>
                </div>
                <div class="nboutput nblast docutils container">
                  <div class="prompt empty docutils container">
                  </div>
                  <div class="output_area docutils container">
                    <div class="highlight">
                      <pre>
z_to_luminosity_distance interpolator will be loaded from ./interpolator_json/z_to_luminosity_distance/z_to_luminosity_distance_1.pickle
differential_comoving_volume interpolator will be loaded from ./interpolator_json/differential_comoving_volume/differential_comoving_volume_1.pickle
merger_rate_density_bbh_popI_II_oguri2018 interpolator will be loaded from ./interpolator_json/merger_rate_density_bbh_popI_II_oguri2018/merger_rate_density_bbh_popI_II_oguri2018_2.pickle

 available model list with it input parameters:
 {&#39;merger_rate_density_bbh_popI_II_oguri2018&#39;: {&#39;R0&#39;: 2.39e-08, &#39;b2&#39;: 1.6, &#39;b3&#39;: 2.0, &#39;b4&#39;: 30}, &#39;star_formation_rate_madau_dickinson2014&#39;: {&#39;af&#39;: 2.7, &#39;bf&#39;: 5.6, &#39;cf&#39;: 2.9}, &#39;merger_rate_density_bbh_popIII_ken2022&#39;: {&#39;n0&#39;: 1.92e-08, &#39;aIII&#39;: 0.66, &#39;bIII&#39;: 0.3, &#39;zIII&#39;: 11.6}, &#39;merger_rate_density_bbh_primordial_ken2022&#39;: {&#39;n0&#39;: 4.4e-11, &#39;t0&#39;: 13.786885302009708}}
</pre>
                    </div>
                  </div>
                </div>
                <section id="Plotting-differential-comoving-volume">
                  <h2>Plotting differential comoving volume<a class="headerlink"
                      href="#Plotting-differential-comoving-volume" title="Link to this heading"></a></h2>
                  <ul class="simple">
                    <li>
                      <p>This important to understand why the source frame merger rate decreases with redshift</p>
                    </li>
                    <li>
                      <p>This is with planck18 cosmology. <code
                          class="docutils literal notranslate"><span class="pre">ler</span></code> allows you to change
                        the cosmology.</p>
                    </li>
                    <li>
                      <p><span class="math notranslate nohighlight">\(1/E (z)\)</span>: derivative of comoving distance
                        with redshift, <span class="math notranslate nohighlight">\(D_c(z)\)</span>: comoving distance,
                        <span class="math notranslate nohighlight">\(H_0\)</span>: Hubble constant, <span
                          class="math notranslate nohighlight">\(c\)</span>: speed of light</p>
                    </li>
                  </ul>
                  <p><span class="math">\begin{equation}
                      \frac{dV_c}{dz} = 4\pi \frac{c}{H_0} \frac{(1+z)^2 D_c^2(z)}{E(z)}
                      \end{equation}</span></p>
                  <div class="nbinput docutils container">
                    <div class="prompt highlight-none notranslate">
                      <div class="highlight">
                        <pre><span></span>[5]:
</pre>
                      </div>
                    </div>
                    <div class="input_area highlight-ipython3 notranslate">
                      <div class="highlight">
                        <pre><span></span><span class="c1"># age of the universe (from present day) in years wrt to redshift</span>
<span class="c1"># consider z=0 corresponds to present day t=0</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="mf">13.786885302009708</span><span class="o">-</span><span class="n">cbc</span><span class="o">.</span><span class="n">cosmo</span><span class="o">.</span><span class="n">age</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>

<span class="c1"># differential comoving volume wrt to redshift</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">dVc_dz</span> <span class="o">=</span> <span class="n">cbc</span><span class="o">.</span><span class="n">differential_comoving_volume</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

<span class="c1"># plot the differential comoving volume and age of the universe</span>
<span class="c1"># show differential comoving volume scale on the right y-axis</span>
<span class="c1"># show age of the universe scale on the left y-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Age of the universe&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;time (Myr)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">dVc_dz</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Differential comoving volume&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\frac</span><span class="si">{dV_c}{dz}</span><span class="s2"> (Mpc^3)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Age of the universe &amp; </span><span class="se">\n</span><span class="s2"> Differential comoving volume&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
                      </div>
                    </div>
                  </div>
                  <div class="nboutput nblast docutils container">
                    <div class="prompt empty docutils container">
                    </div>
                    <div class="output_area docutils container">
                      <img
                        alt="../../_images/examples_source_population_merger_rate_density_evolution_with_redshift_6_0.png"
                        src="../../_images/examples_source_population_merger_rate_density_evolution_with_redshift_6_0.png" />
                    </div>
                  </div>
                </section>
                <section id="Merger-rate-evolution-with-redshift-(detector-frame)">
                  <h2>Merger rate evolution with redshift (detector frame)<a class="headerlink"
                      href="#Merger-rate-evolution-with-redshift-(detector-frame)" title="Link to this heading"></a>
                  </h2>
                  <ul class="simple">
                    <li>
                      <p>LeR default Merger rate follows <a class="reference external"
                          href="https://arxiv.org/pdf/2106.06303.pdf">WIERDA et al. 2021</a>.</p>
                    </li>
                    <li>
                      <p>It is a functional fit to the population I/II star merger-rate density normalized to the local
                        merger- rate density following Oguri (2018).</p>
                    </li>
                    <li>
                      <p>This model follows from the M10 model to the Belczynski et al. (2017), which is arrived from
                        Madau &amp; Dickinson (2014) with the inclusion of the metallicity dependence of the star
                        formation rate, which is bassically the effect related to pair-instability supernova (PSN) and
                        pair-instability pulsation supernova (PPSN).</p>
                    </li>
                  </ul>
                  <p><span class="math">\begin{equation}
                      \mathcal{R}_m(z_s) = \frac{\mathcal{R}_O(b_4+1)e^{b_2 z_s}}{b_4+e^{b_3 z_s}}
                      \text{Gpc}^{-3}\text{yr}^{-1} \tag{1}
                      \end{equation}</span> * <span class="math notranslate nohighlight">\(z_s\)</span>: redshift of
                    source * <span class="math notranslate nohighlight">\(\mathcal{R}\)</span>: local mergerrate. <span
                      class="math notranslate nohighlight">\(\mathcal{R}=23.9^{+14.3}_{-8.6}\text{Gpc}^{-3}\text{yr}^{-1}=23.9^{+14.3}_{-8.6}
                      \times 10^{-9}\text{Mpc}^{-3}\text{yr}^{-1}\)</span> * fitting parameters: <span
                      class="math notranslate nohighlight">\(b_2=1.6\)</span>, <span
                      class="math notranslate nohighlight">\(b_3=2.1\)</span>, <span
                      class="math notranslate nohighlight">\(b_4=30\)</span></p>
                  <div class="nbinput docutils container">
                    <div class="prompt highlight-none notranslate">
                      <div class="highlight">
                        <pre><span></span>[6]:
</pre>
                      </div>
                    </div>
                    <div class="input_area highlight-ipython3 notranslate">
                      <div class="highlight">
                        <pre><span></span><span class="n">z_min</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">z_max</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="c1"># class initialisation</span>
<span class="n">cbc</span> <span class="o">=</span> <span class="n">CBCSourceRedshiftDistribution</span><span class="p">(</span><span class="n">z_min</span><span class="o">=</span><span class="n">z_min</span><span class="p">,</span>
                                  <span class="n">z_max</span><span class="o">=</span><span class="n">z_max</span><span class="p">,</span>
                                  <span class="n">merger_rate_density</span><span class="o">=</span><span class="s2">&quot;merger_rate_density_bbh_popI_II_oguri2018&quot;</span><span class="p">,</span>
                                  <span class="n">cosmology</span><span class="o">=</span><span class="n">cosmo</span><span class="p">,</span>
                                  <span class="p">)</span>
</pre>
                      </div>
                    </div>
                  </div>
                  <div class="nboutput nblast docutils container">
                    <div class="prompt empty docutils container">
                    </div>
                    <div class="output_area docutils container">
                      <div class="highlight">
                        <pre>
z_to_luminosity_distance interpolator will be loaded from ./interpolator_json/z_to_luminosity_distance/z_to_luminosity_distance_0.pickle
differential_comoving_volume interpolator will be loaded from ./interpolator_json/differential_comoving_volume/differential_comoving_volume_0.pickle
merger_rate_density_bbh_popI_II_oguri2018 interpolator will be generated at ./interpolator_json/merger_rate_density_bbh_popI_II_oguri2018/merger_rate_density_bbh_popI_II_oguri2018_5.pickle
</pre>
                      </div>
                    </div>
                  </div>
                  <div class="nbinput docutils container">
                    <div class="prompt highlight-none notranslate">
                      <div class="highlight">
                        <pre><span></span>[7]:
</pre>
                      </div>
                    </div>
                    <div class="input_area highlight-ipython3 notranslate">
                      <div class="highlight">
                        <pre><span></span><span class="c1"># looking for local merger rate density (R0)</span>
<span class="c1"># by default, it uses results from Renske et al 2021</span>
<span class="n">cbc</span><span class="o">.</span><span class="n">merger_rate_density</span><span class="p">(</span><span class="n">zs</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>  <span class="c1"># in units of Mpc^-3 yr^-1</span>
</pre>
                      </div>
                    </div>
                  </div>
                  <div class="nboutput nblast docutils container">
                    <div class="prompt highlight-none notranslate">
                      <div class="highlight">
                        <pre><span></span>[7]:
</pre>
                      </div>
                    </div>
                    <div class="output_area docutils container">
                      <div class="highlight">
                        <pre>
2.39e-08
</pre>
                      </div>
                    </div>
                  </div>
                  <section id="Plots-with-uncertainties-in-local-merger-rate-density">
                    <h3>Plots with uncertainties in local merger rate density<a class="headerlink"
                        href="#Plots-with-uncertainties-in-local-merger-rate-density" title="Link to this heading"></a>
                    </h3>
                    <ul class="simple">
                      <li>
                        <p><a class="reference external" href="https://arxiv.org/pdf/2106.06303.pdf">WIERDA et al.
                            2022</a> , <span class="math notranslate nohighlight">\(\text{R0} = 23.9^{+14.3}_{-8.6}
                            \times 10^{-9} Mpc^{-3} yr^{-1}\)</span></p>
                      </li>
                      <li>
                        <p><code class="docutils literal notranslate"><span class="pre">ler</span></code> allows you to
                          change input parameters for the merger rate density model</p>
                      </li>
                      <li>
                        <p>with results from <a class="reference external"
                            href="https://arxiv.org/pdf/2111.03634.pdf">GWTC-3, PDB (pair) model</a>:</p>
                      </li>
                    </ul>
                    <table class="docutils align-default">
                      <thead>
                        <tr class="row-odd">
                          <th class="head">
                            <p>Model</p>
                          </th>
                          <th class="head">
                            <p><span class="math notranslate nohighlight">\(\mathcal{R}_O\)</span></p>
                          </th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr class="row-even">
                          <td>
                            <p>BNS</p>
                          </td>
                          <td>
                            <p><span class="math notranslate nohighlight">\(170^{+270}_{-120}\)</span></p>
                          </td>
                        </tr>
                        <tr class="row-odd">
                          <td>
                            <p>BBH</p>
                          </td>
                          <td>
                            <p><span class="math notranslate nohighlight">\(25^{+10}_{-7}\)</span></p>
                          </td>
                        </tr>
                        <tr class="row-even">
                          <td>
                            <p>NSBH</p>
                          </td>
                          <td>
                            <p><span class="math notranslate nohighlight">\(27^{+31}_{-17}\)</span></p>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                    <ul class="simple">
                      <li>
                        <p>Note: uncertainties in local merger rate density of BNS is much larger than BBH and NSBH</p>
                      </li>
                    </ul>
                  </section>
                </section>
                <section id="BBH">
                  <h2>BBH<a class="headerlink" href="#BBH" title="Link to this heading"></a></h2>
                  <div class="nbinput nblast docutils container">
                    <div class="prompt highlight-none notranslate">
                      <div class="highlight">
                        <pre><span></span>[8]:
</pre>
                      </div>
                    </div>
                    <div class="input_area highlight-ipython3 notranslate">
                      <div class="highlight">
                        <pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># getting the median values of zs distribution (source frame)</span>
<span class="c1"># det: detector frame, src: source frame</span>
<span class="n">param</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">R0</span><span class="o">=</span><span class="mi">25</span> <span class="o">*</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">b2</span><span class="o">=</span><span class="mf">1.6</span><span class="p">,</span> <span class="n">b3</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">b4</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">bbh_density_median_det</span> <span class="o">=</span> <span class="n">cbc</span><span class="o">.</span><span class="n">merger_rate_density</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">param</span><span class="p">)</span>

<span class="c1"># getting the lower bound values of zs distribution (source frame)</span>
<span class="n">param</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">R0</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">b2</span><span class="o">=</span><span class="mf">1.6</span><span class="p">,</span> <span class="n">b3</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">b4</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">bbh_density_low_det</span> <span class="o">=</span> <span class="n">cbc</span><span class="o">.</span><span class="n">merger_rate_density</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">param</span><span class="p">)</span>

<span class="c1"># getting the upper bound values of zs distribution (source frame)</span>
<span class="n">param</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">R0</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="o">+</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">b2</span><span class="o">=</span><span class="mf">1.6</span><span class="p">,</span> <span class="n">b3</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">b4</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">bbh_density_up_det</span> <span class="o">=</span> <span class="n">cbc</span><span class="o">.</span><span class="n">merger_rate_density</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">param</span><span class="p">)</span>
</pre>
                      </div>
                    </div>
                  </div>
                  <div class="nbinput docutils container">
                    <div class="prompt highlight-none notranslate">
                      <div class="highlight">
                        <pre><span></span>[9]:
</pre>
                      </div>
                    </div>
                    <div class="input_area highlight-ipython3 notranslate">
                      <div class="highlight">
                        <pre><span></span><span class="c1"># fill between zs_low and zs_up</span>

<span class="c1"># bbh</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">bbh_density_median_det</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">bbh_density_low_det</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;low_lim&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">bbh_density_up_det</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;up_lim&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">bbh_density_low_det</span><span class="p">,</span> <span class="n">bbh_density_up_det</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\frac</span><span class="si">{dR}{dz}</span><span class="s2"> (Mpc^{-3} yr^{-1})$&quot;</span><span class="p">)</span>
<span class="c1">#plt.yscale(&quot;log&quot;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Merger rate density (detector frame)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
                      </div>
                    </div>
                  </div>
                  <div class="nboutput nblast docutils container">
                    <div class="prompt empty docutils container">
                    </div>
                    <div class="output_area docutils container">
                      <img
                        alt="../../_images/examples_source_population_merger_rate_density_evolution_with_redshift_13_0.png"
                        src="../../_images/examples_source_population_merger_rate_density_evolution_with_redshift_13_0.png" />
                    </div>
                  </div>
                </section>
                <section id="BNS">
                  <h2>BNS<a class="headerlink" href="#BNS" title="Link to this heading"></a></h2>
                  <div class="nbinput nblast docutils container">
                    <div class="prompt highlight-none notranslate">
                      <div class="highlight">
                        <pre><span></span>[12]:
</pre>
                      </div>
                    </div>
                    <div class="input_area highlight-ipython3 notranslate">
                      <div class="highlight">
                        <pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># getting the median values of zs distribution (source frame)</span>
<span class="c1"># det: detector frame, src: source frame</span>
<span class="n">param</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">R0</span><span class="o">=</span><span class="mi">170</span> <span class="o">*</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">b2</span><span class="o">=</span><span class="mf">1.6</span><span class="p">,</span> <span class="n">b3</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">b4</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">bns_density_median_det</span> <span class="o">=</span> <span class="n">cbc</span><span class="o">.</span><span class="n">merger_rate_density</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">param</span><span class="p">)</span>

<span class="c1"># getting the lower bound values of zs distribution (source frame)</span>
<span class="n">param</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">R0</span><span class="o">=</span><span class="p">(</span><span class="mi">170</span><span class="o">-</span><span class="mi">120</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">b2</span><span class="o">=</span><span class="mf">1.6</span><span class="p">,</span> <span class="n">b3</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">b4</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">bns_density_low_det</span> <span class="o">=</span> <span class="n">cbc</span><span class="o">.</span><span class="n">merger_rate_density</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">param</span><span class="p">)</span>

<span class="c1"># getting the upper bound values of zs distribution (source frame)</span>
<span class="n">param</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">R0</span><span class="o">=</span><span class="p">(</span><span class="mi">170</span><span class="o">+</span><span class="mi">270</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">b2</span><span class="o">=</span><span class="mf">1.6</span><span class="p">,</span> <span class="n">b3</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">b4</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">bns_density_up_det</span> <span class="o">=</span> <span class="n">cbc</span><span class="o">.</span><span class="n">merger_rate_density</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="n">param</span><span class="p">)</span>
</pre>
                      </div>
                    </div>
                  </div>
                  <div class="nbinput docutils container">
                    <div class="prompt highlight-none notranslate">
                      <div class="highlight">
                        <pre><span></span>[13]:
</pre>
                      </div>
                    </div>
                    <div class="input_area highlight-ipython3 notranslate">
                      <div class="highlight">
                        <pre><span></span><span class="c1"># fill between zs_low and zs_up</span>

<span class="c1"># bns</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">bns_density_median_det</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">bns_density_low_det</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;low_lim&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">bns_density_up_det</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;up_lim&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">bns_density_low_det</span><span class="p">,</span> <span class="n">bns_density_up_det</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\frac</span><span class="si">{dR}{dz}</span><span class="s2"> (Mpc^{-3} yr^{-1})$&quot;</span><span class="p">)</span>
<span class="c1">#plt.yscale(&quot;log&quot;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Merger rate density (detector frame)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
                      </div>
                    </div>
                  </div>
                  <div class="nboutput nblast docutils container">
                    <div class="prompt empty docutils container">
                    </div>
                    <div class="output_area docutils container">
                      <img
                        alt="../../_images/examples_source_population_merger_rate_density_evolution_with_redshift_16_0.png"
                        src="../../_images/examples_source_population_merger_rate_density_evolution_with_redshift_16_0.png" />
                    </div>
                  </div>
                </section>
                <section id="Redshift-distribution-(BBH)">
                  <h2>Redshift distribution (BBH)<a class="headerlink" href="#Redshift-distribution-(BBH)"
                      title="Link to this heading"></a></h2>
                  <ul class="simple">
                    <li>
                      <p>The redshift distribution of the BBH merger should follow the merger rate density distribution.
                      </p>
                    </li>
                    <li>
                      <p>The redshift distribution (source frame) of the BBH merger is given by the merger rate density
                        distribution multiplied by the differential comoving volume and the time dilation factor.</p>
                    </li>
                    <li>
                      <p>It is then normalized to unity in the redshift range <span
                          class="math notranslate nohighlight">\(z_{min}&lt;z&lt;z_{max}\)</span>.</p>
                    </li>
                  </ul>
                  <div class="nbinput docutils container">
                    <div class="prompt highlight-none notranslate">
                      <div class="highlight">
                        <pre><span></span>[14]:
</pre>
                      </div>
                    </div>
                    <div class="input_area highlight-ipython3 notranslate">
                      <div class="highlight">
                        <pre><span></span><span class="n">z_min</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">z_max</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="c1"># class initialisation</span>
<span class="n">cbc</span> <span class="o">=</span> <span class="n">CBCSourceRedshiftDistribution</span><span class="p">(</span><span class="n">z_min</span><span class="o">=</span><span class="n">z_min</span><span class="p">,</span>
                                  <span class="n">z_max</span><span class="o">=</span><span class="n">z_max</span><span class="p">,</span>
                                  <span class="n">merger_rate_density</span><span class="o">=</span><span class="s2">&quot;merger_rate_density_bbh_popI_II_oguri2018&quot;</span><span class="p">)</span>
<span class="c1"># detector frame</span>
<span class="n">rate1_det</span> <span class="o">=</span> <span class="n">cbc</span><span class="o">.</span><span class="n">merger_rate_density</span>
<span class="c1"># normalised to 1</span>
<span class="n">norm1</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">rate1_det</span><span class="p">,</span> <span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">rate1_det</span> <span class="o">=</span> <span class="n">rate1_det</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">/</span> <span class="n">norm1</span>

<span class="c1"># source frame</span>
<span class="n">rate1_src</span> <span class="o">=</span> <span class="n">cbc</span><span class="o">.</span><span class="n">merger_rate_density_src_frame</span>
<span class="c1"># normalised to 1</span>
<span class="n">rate1_src</span> <span class="o">=</span> <span class="n">rate1_src</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">/</span> <span class="n">cbc</span><span class="o">.</span><span class="n">normalization_pdf_z</span>
</pre>
                      </div>
                    </div>
                  </div>
                  <div class="nboutput nblast docutils container">
                    <div class="prompt empty docutils container">
                    </div>
                    <div class="output_area docutils container">
                      <div class="highlight">
                        <pre>
z_to_luminosity_distance interpolator will be generated at ./interpolator_json/z_to_luminosity_distance/z_to_luminosity_distance_3.pickle
differential_comoving_volume interpolator will be generated at ./interpolator_json/differential_comoving_volume/differential_comoving_volume_3.pickle
merger_rate_density_bbh_popI_II_oguri2018 interpolator will be generated at ./interpolator_json/merger_rate_density_bbh_popI_II_oguri2018/merger_rate_density_bbh_popI_II_oguri2018_6.pickle
</pre>
                      </div>
                    </div>
                  </div>
                  <div class="nbinput docutils container">
                    <div class="prompt highlight-none notranslate">
                      <div class="highlight">
                        <pre><span></span>[15]:
</pre>
                      </div>
                    </div>
                    <div class="input_area highlight-ipython3 notranslate">
                      <div class="highlight">
                        <pre><span></span><span class="c1"># plot the merger rate density</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">rate1_det</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;detector frame&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">rate1_src</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;source frame&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="c1"># labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;z&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;pdf&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Source redshift distribution </span><span class="se">\n</span><span class="s2">(Source Frame)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre>
                      </div>
                    </div>
                  </div>
                  <div class="nboutput nblast docutils container">
                    <div class="prompt empty docutils container">
                    </div>
                    <div class="output_area docutils container">
                      <img
                        alt="../../_images/examples_source_population_merger_rate_density_evolution_with_redshift_19_0.png"
                        src="../../_images/examples_source_population_merger_rate_density_evolution_with_redshift_19_0.png" />
                    </div>
                  </div>
                  <div class="nbinput nblast docutils container">
                    <div class="prompt highlight-none notranslate">
                      <div class="highlight">
                        <pre><span></span>[ ]:
</pre>
                      </div>
                    </div>
                    <div class="input_area highlight-ipython3 notranslate">
                      <div class="highlight">
                        <pre><span></span>
</pre>
                      </div>
                    </div>
                  </div>
                </section>
              </section>


            </div>
          </div>
          <footer>
            <div class="rst-footer-buttons" role="navigation" aria-label="Footer">
              <a href="../rates/rates_with_3G_detectors.html" class="btn btn-neutral float-left"
                title="Event Rates with 3G detectors" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"
                  aria-hidden="true"></span> Previous</a>
              <a href="merger%20rate%20density%20model%20comparision.html" class="btn btn-neutral float-right"
                title="Merger rate density model comparision" accesskey="n" rel="next">Next <span
                  class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
            </div>

            <hr />

            <div role="contentinfo">
              <p>&#169; Copyright 2023, Phurailatpam Hemantakumar.</p>
            </div>

            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
            <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
            provided by <a href="https://readthedocs.org">Read the Docs</a>.


          </footer>
        </div>
      </div>
    </section>
  </div>
  <script>
    jQuery(function () {
      SphinxRtdTheme.Navigation.enable(true);
    });
  </script>

</body>

</html>